\documentclass[a4paper, 11pt]{report}
\usepackage[czech]{babel}
\usepackage[utf8]{inputenc}
\usepackage{multirow}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{enumerate}
\usepackage{verbatim}
\usepackage{tikz-qtree}
\usepackage{tikz}
\usetikzlibrary{automata,positioning,fit}
\usepackage{mathtools}

\usepackage{amsthm}
\newtheorem{mydef}{Definice}[chapter]
\newtheorem{veta}{Věta}[chapter]
\newtheorem{lemma}{Lemma}[chapter]
\newtheorem{alg}{Algoritmus}[chapter]

\usepackage{geometry}
\usepackage{layout}

\geometry{
  includeheadfoot,
  hmargin=2.0cm,
  vmargin={0cm, 1.0cm}
}

\usepackage{color}
\usepackage[unicode,colorlinks,hyperindex,plainpages=false,pdftex]{hyperref}

\usepackage{listings}  
\definecolor{mygreen}{rgb}{0,0.6,0}
\lstset{language=VHDL,commentstyle=\color{mygreen},tabsize=4}

\usepackage{fancyhdr}
\pagestyle{fancyplain}
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}

\cfoot{\hfill © Jakuje \hfill \thepage }


\begin{document}

\ref{cha:1}
\ref{cha:2}
\ref{cha:3}
\ref{cha:4}
\ref{cha:5}
\ref{cha:6}
\ref{cha:7}
\ref{cha:8}
\ref{cha:9}
\ref{cha:10}
\ref{cha:11}
\ref{cha:12}
\ref{cha:13}
\ref{cha:14}
\ref{cha:15}
\ref{cha:16}
\ref{cha:17}
\ref{cha:18}
\ref{cha:19}
\ref{cha:20}

\ref{cha:21}
\ref{cha:22}
\ref{cha:23}
\ref{cha:24}
\ref{cha:25}
\ref{cha:26}
\ref{cha:27}
\ref{cha:28}
\ref{cha:29}
\ref{cha:30}
\ref{cha:31}
\ref{cha:32}
\ref{cha:33}
\ref{cha:34}
\ref{cha:35}
\ref{cha:36}
\ref{cha:37}
\ref{cha:38}
\ref{cha:39}
\ref{cha:40}

\ref{cha:41}
\ref{cha:42}
\ref{cha:43}
\ref{cha:44}
\ref{cha:45}
\ref{cha:46}
\ref{cha:47}
\ref{cha:48}
\ref{cha:49}
\ref{cha:50}
\ref{cha:51}
\ref{cha:52}
\ref{cha:53}
\ref{cha:54}
\ref{cha:55}
\ref{cha:56}
\ref{cha:57}
\ref{cha:58}
\ref{cha:59}
\ref{cha:60}

\ref{cha:61}
\ref{cha:62}
\ref{cha:63}
\newpage

\tableofcontents

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Metodika návrhu HW/SW codesign, platformy, programovatelné obvody.} \label{cha:1}
1. semestr, HSC, \texttt{uvod\_20150922.pdf}, \texttt{technologie\_20130923.pdf}

Řešení problematiky efektivního (cena) návrhu složitých výpočetních systémů v rámci daném jak fyzikálními omezeními, tak často protichůdnými požadavky na jejich vlastnosti.

Tradičně návrh HW předcházel návrh SW a integrace následovala. Souběžná práce umožňuje zkrácení doby návrhu.

\paragraph{Hardware x Software}: Požadavky na výkonnost: Hardware (rychlé, drahé); Požadavky na flexibility, složitost a rychlost time-to-market: Software (levný, pomalé).

\begin{tabular}{l | l | l |}
					& HW						& SW \\ \hline
	Návrhový vzor	& Dekompozice v prostoru	& Dekompozice v čase \\ \hline
	Cena zdrojů		& Plocha (počet hradel)		& Čas (počet instrukcí) \\ \hline
	Flexibilita		& Musí být součástí návrhu	& Implicitní \\ \hline
	Paralelismus	& Implicitní				& Musí být součástí návrhu \\ \hline
	Modelování		& Model $\not=$ implementace& Model $\sim$ implementace \\ \hline
	Znovupoužití	& Omezené					& Běžné \\ \hline
\end{tabular}

Modelování -- specifikuje co systém dělá (získávání hlubší znalosti o systému jeho imitací).

Návrh (design) -- specifikuje jak systém pracuje (strukturovaná tvorba výrobku).

Analýza -- specifikuje, proč systém dělá to, co dělá (získávání hlubší znalosti o systému jeho podrobným zkoumáním).

\section{Metodika}
\subsection{Návrh shora-dolů (top-down)}
Optimální syntéza může být pokud zatím žádná část neexistuje.

Popis chování lze modelovat s použitím vhodné abstrakce

Obtížná automatizace -- v praxi ne moc používané

\subsection{Návrh zdola-nahoru (bottom-up)}
Systém bývá složen z již existujících komponent (ekonomické důvody, složitost)

Nemusíme navrhovat od počátku, komponenty jsou již ověřené.

Komponenty mohou přinést nějakou režii (nejsou plně využity, rozhraní, propojení) a systém nemusí být optimální.

\subsection{Kombinace optimalizace shora-dolů a zdola-nahoru}
Využití ověřených komponent a zohlednění možnosti technologie, kterou máme k dispozici.

\subsection{Adaptivní (inkrementální, evoluční) metody návrhu}
Reakce na waterfall, v softwarovém inženýrství jako agilní návrhové metody. Jednotlivé iterace jsou prováděny v krátkých časových intervalech. Mezi iteracemi zpětná vazba (ovlivnění návrhu na základě validace po každé iteraci), v každé iteraci návrh malých částí, které lze plně validovat.

\subsection{Přehled problematiky}
\paragraph{Specifikace}
Předchází návrhu komplexních systémů. Snaha o zavedení hierarchie (omezení složitosti na každé úrovni), snaha o znovupoužití.

\paragraph{Architektura}
Výpočet (propustnost, latence), Data (typ, objem), Komunikace (zasílání zpráv, sdílená paměť), rozhraní (sběrnice), protokoly (TCP/IP), řízení, Synchronizace, Fyzikální vlastnosti.

\paragraph{Modelování}
Nezbytná na co nejvyšší úrovni abstrakce (velká složitost a heterogennost dnešních výpočetních platforem a systémů). Výpočetní a komunikační modely.

\paragraph{Syntéza -- rozdělení/mapování}
Alokace (výběr výpočetních prostředků), Přidělování (přidělení výpočetních prostředků výpočtům), Plánování (sdílení prostředků mezi výpočty), Optimalizace (simulované žíhání, genetické algoritmy).

\paragraph{Odhady a optimalizace}
Pro co nejlepší rozdělení systému na části v SW a HW. Analýza jak vlastností jednotlivých částí a jejich interakce, tak chování výsledného systému. Optimalizace příkonu, výkonnosti, ceny. Odhady složitosti, rychlost, kapacity paměti, příkonu.

\paragraph{Transformace}
Syntéza HW (ze schématu či jazyka pro popis HW do netlistu). Kompilace SW z vyššího programovacího jazyka do assembleru. V současné době nejvíce propracované kroky návrhu.

\paragraph{Integrace, Rozhraní}
Volba rozhraní, komunikace. Hlavní pro zavedení abstrakce, izoluje různé technologie a umožňuje evoluci systému (RS232, Intel '86).

\paragraph{Validace}
Zjištění, ze produkt, či krok při návrhu odpovídá účelu, splňuje veškerá omezení a bude pracovat jak je vyžadováno. Součástí je verifikace, simulace, testování, emulace, prototypování a certifikace.

\paragraph{Výpočetní platformy}
Tradiční (osobní počítač), Systémy na čipu SoC, Programovatelný HW (FPGA), nasazení v praxi.

\section{Technologie}

Flexibilita x Efektivita:\\
RISC -- FPGA -- DSP -- ASIP -- ASIC

Souběžnost (Concurrency) -- schopnost vykonávat operace simultánně, protože tyto operace jsou na sobě úplně nezávislé (souvisí s úlohou)\\
Paralelismus (Parallelism) -- schopnost vykonávat operace simultánně, protože tyto operace mohou být zpracovány na nezávislých výpočetních prostředcích (souvisí s výpočetní platformou)

Paralelismus na úrovni Bitů (širší datové cesty), Slov (vektorové jednotky, 64 bitové registry), Instrukcí (zřetězení, VLIW), vlákno (vícevláknové procesory), Proces/Vlákno (vícejádrové procesory).

Paměť: Potřeba velké kapacity a krátké přístupové doby -- hierarchie (cache, aplikačně nezávislé, složité), distribuovaná organizace, Scratchpad (plnění se plánuje v době návrhu aplikace, Cray, DSP, PS2, levnější, rychlejší).

Procesory: CISC, RISC, VLIW, Superskalární (nadtřída RISC, CISC). Jedno-instrukční CPU.
Instrukční sady: Zásobníková, Akumulátorová, Registrová, Load/Store; Adresovací režimy.

\paragraph{Paralelismus} (zřetězení)
In-order nebo řešení konfliktů přeskládáním instrukcí

Hazardy: Strukturní (přístup k HW z více stupňů pipeline -- není podporován), Datový (čeká se na výsledek předchozí operace), Řídicí (výjimky, skoky).

Více instrukcí současně -- VLIW plánováno v době překladu, superskalární plánují během výpočtu.

General-purpouse CPU: Nízká energetická účinnost, složitý HW, převážná část čipu nevyužita pro výpočty.

DSP: Orientovaná na tok dat, vysoká propustnost, Harwardská architektura, HW čítač smyček, speciální instrukce.

ASIP: Application Specific Instruction Set processors -- konfigurovatelná architektura procesoru,, instrukční sada, specializované funkční jednotky, paměť podle aplikace. Automatické generování IP cores, simulátoru, překladače atd.

\paragraph{Programovatelné logické obvody}:

Nevolatilní -- konfigurace uchována i po odpojení (destrukce propojek, nebo ji lze měnit -- Flash). Pokud je potřeba, aby obvod fungoval ihned po připojení napájení.
\begin{description}
	\item[PAL] Programmable Array Logic -- Programovatelné AND pole, destrukce propojek. Nebo pevná OR pole
	\item[GAL] Generic Array Logic -- podobné PAL, propojky ale elektricky programovatelné (např. EEPROM paměť).
	\item[CPLD] Complex Programmable Logic Devices -- AND-OR pole a registry s elektricky programovatelnými křížovými přepínači.
\end{description}

Volatilní -- Field Programmable Gate Array (FPGA) -- možnost neomezeného programován HW. Konfigurace v SRAM, po každém připojení napájení potřeba konfiguraci zkopírovat z externí paměti. Výhodou je flexibilita a výkonnost.
\begin{itemize}
	\item Pole konfigurovatelných logických elementů:
	\begin{itemize}
		\item Configurable Logic Block (CLB) -- libovolná logická funkce N proměnných (vstupů)
		\item Rychlé násobičky
		\item DSP bloky
		\item Hard a Soft procesorová jádra PowerPC, Nios.
	\end{itemize}
	\item Paměťi -- různé kapacity, rychlosti, tvorba hierarchie
	\begin{itemize}
		\item Registry v CLB
		\item Pamět SRAM z LUT v CLB
		\item BlockRAM (konfigurovatelná paměť SRAM -- FIFO, posuvný registr atd)
		\item Externí paměť (DRAM, SRAM, a pod.)
	\end{itemize}
	Distribuovaná paměť: Problémem je konzistence dat.
	\item I/O bloky
	\item programovatelná propojovací síť -- co možno největší propojitelnost jednotlivých elementů. Hlavní zdroj zpoždění, většina plochy a dynamického příkonu
	\item konfigurační paměť -- definuje funkci logických elementů -- Look-Up Table (LUT), Topologie propojovací sítě, velká kapacita (MB)
\end{itemize}

Nejpokročilejší technologie, dobrá testovatelnost výrobního procesu, omezení využitelnosti propojením (60 -- 80\%). Miliardy tranzistorů, miliony vlastní logiky (ekvivalentních hradel NAND).

IPC -- Intellectual Property Core -- předem navržené a otestované komponenty, usnadňuje integraci, platba za licenci. Hard (PowerPC procesor), Netlist (seznam komponent a spojů cílové technologie či VHDL, možnost modifikovat a přizpůsobit, ale potřeba rozmístit), Soft (HDL, nutno znovu syntetizovat, P\&R, verifikovat).

Výhody: Rozmístěné a propojené na čipu, optimální využití a výkonnost.\\
Nevýhody: Předem definované vývody -- komplikace propojení, omezená škála funkcí (pro většinu uživatelů)

Rekonfigurace -- změna obsahu konfigurační paměti (za běhu), Parciální rekonfigurace (část obvodu pracuje), Diagnostika nebo ošetření chybových stavů, různé režimy činnosti systémů, Dynamická rekonfigurace -- zavádění konfigurace na základě probíhajícího výpočtu.

Rekonfigurovatelné počítání -- úspora zdrojů, efektivní implementace výpočetních struktur, velmi obtížné programování












%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Výpočetní modely} \label{cha:2}
1. semestr, HSC, \texttt{controlflow\_20141123.pdf}, \texttt{dataflow\_20151215.pdf}

(StateCharts, Kahnova síť procesů, synchronní dataflow)

Modelování: Na co nejvyšší úrovni (velká složitost na nižších). Vhodné výpočetní a komunikační modely: Zohledňují charakter dané úlohy a usnadňují tak její efektivní implementaci: KA, Petriho sítě, Dataflow, Diskrétní události.
\begin{itemize}
	\item Řídicí struktury -- Controlflow
	\begin{itemize}
		\item FSM
		\item rozšíření FSM: s datovou, rozšířené, StatCharts, SpecCharts
	\end{itemize}
	\item Datové toky -- Dataflow
	\begin{itemize}
		\item Kahnova síť procesů (KNP)
		\item Synchronní dataflow (SDF)
	\end{itemize}
	\item Souběžnost
	\begin{itemize}
		\item Communicating Sequential Processes (CSP)
		\item Petriho sídě.
	\end{itemize}
\end{itemize}

FSM -- Moore, Mealy

FSM s datovou cestou (FSMD): Mikroprogramovatelný automat -- flexibilita na úkor efektivity.

EFSM -- rozšířené konečné automaty. Pro FSM s velkým množsvím opakujících se stavů -- rozšíření o proměnné: Vstupní podmínky, Výstupní akce a Přiřazení proměnné (Set action). Nedeterministický popisuje pouze podstatné vlastnosti systému (skryje detaily o okolním prostředí).

Exploze stavů FSM: Při spojování dvou FSM do jednoho (N $\times$ M stavů), ošetření výjimek. Složitější chování se těžko modeluje

\section{StateCharts}
Rozšíření FSM pro snazší modelování -- přehlednější zápis a snadnější použití.

\emph{Objekt}: Stavy jsou všechny kombinace podstavů. StateCharts zapisuje hierarchicky (OR-super-stav). Souběžnost: Dva a více FSM současně aktivní (AND-super-stavy). Přechody podmíněny nebo asociovány s akcemi. Výpočet od listů ke kořenům. Synchronní komunikační mechanismus.

Stromová reprezentace stavů:
\begin{itemize}
	\item Základní stavy: Nemají potomka, odpovídají stavům FSM
	\item AND-super-stav: Aktivní stavy v obou (kartézský součin potomků) -- Souběžnost
	\item OR-super-stav: Jeden ze základních stavů je aktivní (Sjednocení potomků)
	\item Defaultní stav: Vstupní bod sub-stavu
	\item Historie: V OR-super-stavu pokračujeme tam, odkud jsme super-stav opustili
	\item Časovač: Speciální výstupní hrana: timeout -- pokud je stav po dobu N ve stavu, bude vygenerována výstupní událost timeout.
	\item Podmíněné přechody: n[c]/a, kde n je událost, c je podmínka a a je akce.
\end{itemize}

Hierarchie AND/OR-super-stavů, existují překladače do C či VHDL, nevhodné pro distribuované aplikace, nepopisují datové toky

SpecCharts -- rozšíření FSM -- možnost psát jazykové konstrukce v souběžných FSM

\section{Kahnova síť procesů}
Sekvenční procesy komunikující zasíláním zpráv.

Komunikace: kanály -- fronty FIFO s potenciálně nekonečnou kapacitou. Neblokující zápis, blokující a destruktivní čtení. Deterministické chování -- čtení z fronty na základě přítomnosti dat.

Paralelní programování, Grafická reprezentace: Orientovaný graf: Uzly jsou procesy (v jakémkoliv čase počítají, nebo čekají na vstupy -- sekvenční program), hrany jsou jednosměrné kanály (FIFO, nedefinovaný ale končený čas).

Uváznutí -- reálná implementace mám omezenou frontu, nebo se data ztrácejí.

\paragraph{Monotónnost}: Monotónní proces generuje z uspořádané množiny vstupních sekvencí $X \subseteq{X'}$ uspořádanou množinu výstupních sekvencí: $X \subseteq X' \Rightarrow F(X) \subseteq F(X')$.
Množina výstupních sekvencí $X_i \subseteq X_i'$ je uspořádaná, pokud pro každou sekvenci $i$ platí
$[x_1] \subseteq [x_1, x_2] \subseteq [x_1, x_2, x_3, \dots]$

\paragraph{Determinismus}: Pokud historie všech kanálů závisí pouze na historii všech vstupních kanálů (historie kanálu -- sekvence tokenů, které byly jak zapsány, tak čteny) a pokud se skládá z monotónních procesů.
V deterministické KPN je funkční chování nezávislé na časování.

Nedeterministické mohou používat neblokující čtení, číst/zapisovat z/do stejného kanálu, nebo umožnit procesům sdílet proměnné.

Příklad použití: DSP aplikace s datovými proudy, MPEG-2 dekodér.

\section{Synchronní dataflow (SDF)}

Model je statický, velikosti front mohou být stanoveny dopředu, každý proces čte a zapisuje pevný počet tokenů, řeší problém s nedeterminismem při přetečení front, spuštění procesu při určitém množství dat ve vstupní frontě, pevně dán objem dat, který je při vykonání procesu produkován.

Nelze modelovat datově závislé chování -- přítomnost tokenu spouští proces, ne jeho hodnota.

\begin{description}
	\item[Aktory] A, B, C
	\item[Tokeny] 1, 2, 3
	\item[Kanály] (FIFO fronty) $\alpha, \beta$ -- každý má unikátního producenta/konzumenta
	\item[Inicializační tokeny] kosočtverce
	\item[Stav] Vektor popisující, kolik tokenů je v každém kanálu
	\item[Počáteční stav] je určen inicializačními tokeny: $(\alpha:2, \beta: 1)$
	\item[Přechody]: $(k_1, \dots, k_i, \dots, k_j, \dots, k_n) \xrightarrow{A}(k_1, \dots, k_i - c_A, \dots, k_j+p_A, \dots, k_n)$, pokud A konzumuje $c_A$ tokenů z $\alpha_i$ a produkuje $p_A$ tokenů do $\alpha_j$.
\end{description}

Aktor bez vstupu se může spouštět kdykoliv a produkuje počet tokenů na výstupu. Aktor se vstupem a výstupem potřebuje ke spuštění N tokenů na vstupu a generuje M tokenů na výstupu. Token bez výstupu s každým spuštěním spotřebuje počet tokenů na vstupu.

Topologie je pevně dána, objem komunikovaných dat je fixní $\Rightarrow$ Případné uváznutí lze odhalit, velikost front lze stanovit předem, deterministické chování, modelovací možnosti omezeny na úroveň FSM, přirozeně paralelizovatelné.

Aplikace: DSP, Obecně kontinuální datové toky.

\paragraph{Monotónnost} -- FIFO, predikovatelné chování, model není časovaný: spuštění okamžité, po implementaci trvá nějakou dobu.

Vykonání úlohy -- posloupnost stavů systému.

Aktor nemůže využívat vnitřní stavovou proměnnou k ovlivnění výpočtu. Může mít obecně různou četnost produkce/konzumace tokenů (2 na vstupu, 1 na výstupu -- např. operace součtu).

\paragraph{Determinismus} -- výsledky vždy stejné bez ohledu na pořadí spuštění aktorů, velikost bufferů konstantní (lze naplánovat), každý aktor může být na jiném výpočetním prostředku (jiná rychlost). 

\begin{itemize}
	\item Konzistentní systém -- deterministický
	\item Nekonzistentní systém -- nedeterministické chování -- některá FIFO musí mít neomezenou hloubku.
	\item Uváznutí (Deadlock) -- konzistentní graf se může dostat do stavu ve kterém nelze spustit žádný aktor.
\end{itemize}

Rovnice ekvivalence: Řešením je vektor opakování. Pro každý kanál platí: počet produkovaných  = počet konzumovaných tokenů (počáteční vektor se neuplatňuje): $q_A \cdot N = q_B \cdot M$ (počet spuštění na iteraci x počet tokenů konzumovaných/produkovaných).

Rozhodnutelné vlastnosti: Konzistence, Uváznutí, Velikost bufferů.

Graf, Rovnice ekvivalence, Matice ekvivalence (lze řešit např. Gaussovou eliminační metodou).

\paragraph{Matice topologie $M$}: Hodnost matice pro konzistentní systémy: $h(M) = n-1$ (při určitém spouštěcím vektoru může dojít k uváznutí). Rozpojené systémy $h(M) < n-1$, Nekonzistentní systémy: $h(M) = n$ (buffery s potenciálně nekonečnou kapacitou). Hodnost matice je dána počtu lineárně nezávislých řádků matice (nenulových řádků).

\paragraph{Kontrola uváznutí SDF}: Kontrola, zda je graf konzistentní, nalezni nenulový vektor opakování $q$. Simuluj vykonání na základě vektoru opakování -- pokud lze iterace vykonat, pak systém neuvázne.

\paragraph{Ošetření uváznutí} vložením inicializačního tokenu do zpožďovacího elementu.

Vykonávání: Konzistentní plán (spouštěcí vektor, při kterém bude vykonávání konzistentní = rovnice ekvivalence = 0). Konzistentní minimální plán -- minimum tokenů ve spouštěcím vektoru.

Implementace:
\begin{itemize}
	\item Plánování výpočtu
	\begin{itemize}
		\item Stanovení četnosti výpočtu (řešení soustavy lineárních rovnic)
		\item Stanovení plánu: simulace jednoho běhu systému
	\end{itemize}
	\item Cíl: Sekvence spouštění procesů, která:
	\begin{itemize}
		\item Běží pro každý proces aspoň jednou (proporčně k četnosti jeho spouštění)
		\item Zamezení podtečení bufferů (proces není spuštěn, dokud všechny jeho vyprodukované tokeny nejsou zkonzumovány)
		\item Výsledek: Počet tokenů, které budou v každém bufferu při inicializaci
	\end{itemize}
	\item Výpočet bude proveden bez nebezpečí akumulace tokenů bufferech.
\end{itemize}

Modelování řízení: Controlflow modelování (Dataflow jsou datově řízené) -- rozšíření o podmínky: Boolean Dafa FLow (BDF), Dynamic Data Flow (DDF). Další rozšíření:
\begin{itemize}
	\item Latence: Aktory jsou ohodnoceny dobou vykonání (ns, takty)
	\item Delay: FIFO fronty jsou nahrazeny komunikačními kanály s pevným počtem zpožděním (D, registr). Aktor čeká na přítomnost tokenu v D (pipeline?).
\end{itemize}

Analýza výkonnosti: Propustnost a latence: Stanovení hranic (bound)
\begin{itemize}
	\item Loop Bound (LB): Součet latencí aktorů/počet zpoždění D v cestě smyčkou v SDF
	\item Iteration Bound (IB): Největší LB v SDF -- horní limit propustnosti
\end{itemize}


Transformace -- zlepšení výkonnosti: Zkrácení latence nebo zvýšení propustnosti: Multi-rate $\to$ Single-rate (duplikace aktorů podle četnosti jejich spouštění), Retiming (rozložení zpoždění ve smyčkách pro zvýšení propustnosti), Pipelining (zřetězení -- další zpoždění), Unfolding (rozbalení smyček -- zvyšuje paralelismus duplikování aktorů, zvýšení propustnosti).

C-slow -- prokládaný návrh nahrazením každého registru sekvencí C-registrů -- zvýšení latence a zachování propustnosti (zmenšení periody hodin v kombinaci s retimingem)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Specifikace (chování, struktura), syntéza (alokace, přidělení, plánování) a integrace systémů (rozhraní, synchronizace, komunikace).} \label{cha:3}
1. semestr, HSC, \texttt{02synteza\_20140918.pdf}

\section{Specifikace systémů}

\section{Syntéza systému}
Klasický přístup nízkoúrovňový (obvody, RTL, snadno odhadnutelné parametry). Požadavek na pohled z vyšší úrovně (systém), porovnání alternativ (parametry nejsou známé, nutno odhadnout).

Syntéza -- Rozdělení + Plánování -- Alokace + Přidělení + Plánování

\begin{itemize}
	\item \emph{Alokace}: Výběr výpočetních prostředků (z množin dostupných)\\
	\item \emph{Přidělení}: Přiřazení alokovaných prostředků jednotlivým výpočetním úlohám
	\item \emph{Plánování}: Vícenásobné využití prostředků pro dané úlohy (nemusí být potřeba, pokud počet úloh = počet prostředků).\\
	\item \emph{Rozdělení}: Alokace + Přidělení: Hierarchická dekompozice na menší celky, snaha o minimalizaci počtu komunikačních kanálů mezi subsystémy.\\
	\item \emph{Mapování}: Přidělen + Plánování využití prostředků v čase.
\end{itemize}

Máme algoritmus, omezení (cena, latence), množinu výpočetních prostředků (platforma).

Rozdělení -- počet všech možností pro větší obvody roste nad únosnou mez -- použití heuristik. Specifikace: Graf úlohy se závislostmi mezi výpočetními úlohami + Omezeni (doba výpočtu, plocha čipu).

Alokace -- vychází z použité architektury (platforma, ověřené komponenty)

Přidělení -- mapování úloh na dostupné prostředky

Plánování -- Plán sdílení prostředků mezi jednotlivými úlohami v čase.

Modely:
\begin{itemize}
	\item Control/Data Flow Graph a jejich kombinace DCFG: Uzly (úlohy, operace, vlákna), Hrany (závislosti -- datové, řídící, využití zdrojů).
	\item Graf problému: Výpočetní a komunikační uzly a jejich závislosti
	\item Graf architektury: Výpočetní a komunikační zdroje + orientované komunikační linky
	\item Graf specifikace: graf problému + graf architektury + možné mapování
\end{itemize}

Strategie: Hledání kompromisu výkonnost/cena/příkon\\
Výkonnost primární: Nejprve vše v HW a iterativní přesuny časově nekritických částí do SW (Vulcan, HardwareC, CPU + ASIC koprocesor + sdílená globální paměť)\\
Cena primární: Nejprve vše v SW a přesun časově kritických částí do HW (jazyk $C^x$, definice omezení, elementární blok je sekvence bez skoků, ASIC + CPU \\
Příkon je primární: Nejčastěji optimalizace cenově dostupného řešení s požadovanou výkonností.

Metody optimalizace
\begin{itemize}
	\item Exaktní
	\begin{itemize}
		\item Enumerace
		\item Celočíselné programování (ILP)
	\end{itemize}
	\item Heuristické
	\begin{itemize}
		\item Konstruktivní (náhodné, hierarchický klastering)
		\item Iterativní (Migrace -- rychlé, nekvalitní, Simulování jevů -- pomalé)
	\end{itemize}
\end{itemize}






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Syntéza HW z vyšších programovacích jazyků (reprezentace, alokace, plánování, přiřazení) a jazyk Catapult C.} \label{cha:4}
1. semestr, HSC, \texttt{03synteza\_obvodu\_20160118.pdf}, \texttt{04catapultc\_20151110.pdf}

Zvýšení produktivity návrhu: IP-cores (max. 5x), použití HLS (10x a více). Možnost vytvořit několik architektur a prozkoumat jejich vlastnosti podle potřeby.

Jednodušší specifikace úlohy, Snazší realizace/integrace systému, efektivnější verifikace, ladění obvodu a průzkum prostoru možných architektur.

HLS:\\
\emph{Vstup}: Popis algoritmu ve vyšším programovacím jazyce\\
\emph{Výstup}: Maska obvodu ASIC nebo konfigurace obvodu FPGA\\
\emph{Základní schéma}:
\begin{enumerate}
	\item Kompilace vstupního kódu a převodu do vhodné formální reprezentace (Control-Data Flow Graph)
	\item Plánování, alokace a přiřazení prostředků
	\item Generování RTL schématu
	\item Logický syntéza pomocí konvenčních nástrojů
\end{enumerate}

\section{Reprezentace obvodu}

Interní reprezentace: \emph{Data Flow Graf (DFG)} -- hrany označují datové závislosti, výška určuje počet kroků k dokončení výpočtu, paralelizace.

Řídící konstrukce udržujeme v Control Flow Grafu (CFG).

Spojení: Control Data Flow Graf. Mohou být
\begin{itemize}
	\item oddělené (CFG obsahuje odkazy na DFG)
	\item DeJong's graf (kontrolní informace uvnitř DFG)
	\item SSIM graf (CFG je kopií DFG a ukazuje pořadí provádění operací)
\end{itemize}

Optimalizace -- na úrovni kompilátoru, redukce výšky grafu

Transformace CF do DF (flattening) -- promítnutí podmínek do Data Flow grafu.
Všechny sekce se provádějí paralelně a výsledek se vybere pomocí multiplexoru, podmínka pro výběr se může počítat paralelně, ale zdroje nelze sdílet.

\section{Plánování}

Rozděluje vstupní CDFG do pod-grafů, které jsou vykonávaný v jednom kroku (taktu).\\
Funkční jednotky lze sdílet mezi více kontrolními kroky.\\
Ovlivňuje jak celkové množství potřebných funkčních jednotek, tak dobu výpočtu

\subsection{Základní plánovací algoritmy}
\begin{description}
	\item[ASAP] (As Soon As Possible) -- při plánování operátoru vybere nejbližší možný kontrolní krok.
	\begin{itemize}
		\item Uzly, které nemají předka jsou naplánovány do prvního kroku.
		\item Další uzly jsou plánovány, pokud uzel má všechny předky již naplánovány
		\item dokud nejsou naplánovány všechny uzly.
	\end{itemize}
	\item[ALAP] (As Late As Possible) -- při plánování operátoru se vybere nejvzdálenější možný kontrolní krok.
	\begin{itemize}
		\item Do kroku $T$ jsou naplánovány všechny uzly, které nemají potomka
		\item Postupně plánovány další uzly, které mají naplánovány všechny potomky
		\item dokud nejsou naplánovány všechny uzly.
	\end{itemize}
\end{description}
ALAP a ASAP se většinou používají jako pomocné algoritmy pro složitější výpočty -- určují horní a spodní hranici, kde mohou být jednotlivé operace naplánovány (mobilita operátoru).

\subsection{Časově omezené plánování}
Maximální počet kontrolních kroků, do kterých musí být DFG naplánován a musíme nalézt takový plán, který spotřebuje co nejméně výpočetních zdrojů.
DSP (omezení vzorkovací frekvencí)
NP-těžký problém -- exaktní řešení pomocí ILP, nebo přibližný výpočet (heuristiky).

\subsubsection{Force-Directed Heuristic}
Cílem je rovnoměrně rozprostřít operátory stejného typu do různých kontrolních kroků.
\begin{itemize}
	\item Výpočet mobility všech vrcholů
	\item čím větší mobilita, tím menší pravděpodobnost umístění vrcholu do daného kroku.
	\item Výpočet očekávané ceny realizace operace ve stavu s $EOC$.
	\item Snahou je vyvážit $EOC$ přes všechny kontrolní kroky
	\item Algoritmus se pokouší přesouvat doposud nenaplánovaný vrchol do všech možných pozic
	\item Poté vybere takový posun s nejlepší cenou
	\item Vybraný vrchol zafixuje a pokračuje obdobně, dokud nejsou naplánovány všechny vrcholy.
\end{itemize}
Nevýhoda: Jakmile je operace naplánována, nemůžeme toto rozhodnutí změnit. Existují varianty s výhledem několik kroků dopředu.

\subsection{Prostorově omezené plánování}
Zadán počet dostupných zdrojů. Cílem nalézt plán, který bude obsahovat co nejméně kontrolních kroků.
Opět NP-těžký problém.\\
Zdroje mohou být zadány jako počet funkčních jednotek (VLIW), nebo plochy čipu/počtu základních logických hradel.

\subsubsection{List based scheduling}
Zobecnění algoritmu ASAP
\begin{itemize}
	\item Udržujeme seznam operátorů, které je možné naplánovat v každém kroku (předchůdci naplánováni)
	\item Uzly jsou uspořádány podle priority, podle které jsou plánovány (naplánování uzlu může přidat nové uzly do seznamu)
	\item Výpočet opakujeme, dokud není celý graf naplánován.
\end{itemize}

Kvalita plánování závisí na zvolené prioritní funkci (v minulém podle velikosti mobility). Dále například podle nejdelší cesty ke konci grafu, nebo podle počtu následníků.

\subsubsection{Plánování reálných obvodů}
Některé operace (násobička) mohou zasahovat do více cyklů (multi-cycled), sdružovat do jednoho kroku (chained), nebo zřetězeny vnitřně (pipelined).

Podmíněné sekce -- zdroje lze sdílet mezi větvemi.

Plánování smyček může probíhat sekvenčně, smyčky lze rozbalit do superiterací (musíme znát počet iterací), nebo zřetězit (loop folding) -- Prolog, Fold, Epilog.

IT = Iteration Time -- počet kontrolních kroků\\
II = Inicialization Interval -- výpočet nové iterace začíná každých II kroků.

Pro smyčky je vhodnější použít Graf závislostí (Dependency Graph).
Naplánovaný potom jako složený graf závislostí (folded DG), který obsahuje zároveň prolog, fold i epilog a vzájemné závislosti.

Omezující podmínky (datové závislosti).

\begin{mydef}
Graf obsahuje cyklus $C$ mezi operacemi $\{O_1, \dots, 0_n\}$, pokud v něm existují datové závislosti $O_i \to O_{i+1}$ pro $\forall i \in \{1, \dots, n\}$ a současně vazba $O_n \to O_1$.

Stupeň cyklu je definován jako $\delta_c = \sum_{i=1}^n \delta_i$.\\
Délka cyklu je definována jako $|c| = \sum_{O \in C} EXE_O$.
\end{mydef}
Pokud graf závislostí obsahuje cyklus $C$ pro který platí $|C| > \delta_c \times II$.

\paragraph{Algoritmus $ASAP_p$ (pipelined)}
Nalézt platný plán pro zadaný graf závislosti (DG) a inicializační interval (II).
\begin{enumerate}
	\item Ověří podmínku existence plánu pro zadaný II
	\item Naplánuje všechny operace do prvního cyklu složeného grafu
	\item Ověří, zda je pro všechny hrany složeného grafu splněna podmínka pro plánování
	$$T_{O'} < T_O + EXE_O - \delta \times II$$
	a pokud nikololiv, posune čas provádění operace do okamžiku 
	$$T_{O'} = T_O + EXE_O - \delta \times II$$
	\item Opakujeme bod (3), dokud není podmínka plánování splněna pro všechny hrany grafu.
\end{enumerate}
Časová složitost je $O(i \times m \times n)$ (doba iterace, počet hran, počet uzlú). Algoritmus nalezne pro zadaný DG a II platný plán s minimální dobou iterace (IT), pokud je zadaný II větší nebo roven jeho minimální hranici.
Nezaručuje vytvořením plánu s minimálními nároku na zdroje.

\subsubsection{Plánování (dokonale) vnořených smyček}
Rozbalením získáme iterační prostor, přidáme datové závislosti.
\begin{itemize}
	\item Plánování -- rozdělení indexového prostoru na části, které mohou být prováděny parallelně.
	\item Alokace/přiřazení funkčních jednotek -- rozdělení prostoru na části, které budou vykonávány na stejném procesoru.
\end{itemize}
Nejlépe, pokud jsou funkce lineární -- snadná paralelizace výsledného obvodu, maticový zápis

Problém nalezení optimální plánovací a alokační funkce. Pro N rozměrný prostor rozdělení pro N-1 rozměrného prostoru funkčních jednotek a jednorozměrného prostoru odpovídajícímu času.
Většinou nemáme tolik výpočetních jednotek a proto virtuální pole procesorů mapujeme na fyzické pole procesorů (1D, nebo 2D struktura).

\emph{Lokálně paralelní globálně sekvenční (LPGS)} -- pole výpočetních jednotek zpracovává společně část indexového prostoru (předávání dat a komunikace)

\emph{Lokálně sekvenční globálně paralelní (GSGP)} -- indexový prostor rozdělen na oddělené části, kde je každá zpracovávána jednou výpočetní jednotkou, všechny jednotky pak pracují paralelně (méně datových závislostí).

Nalezení optimální velikosti dlaždice.

\section{Přiřazení}
Cílem přiřazení zdrojů je mapovat proměnné a operace naplánovaného CDFG grafu do funkčních jednotek, registrů a propojovacích sítí.
\begin{enumerate}
	\item Přiřazení funkčních jednotek -- pro jednu jednotku triviální, pro více jednotek je potřeba vybrat nejvhodnější kombinaci
	\item Přiřazení paměťových elementů -- konstanty do ROM, proměnné do registrů nebo RAM, možnost sdílení registrů podle doby života, registrová pole (s více porty)
	\item Přiřazení propojovacích sítí -- realizace datových přenosů, snaha o co největší sdílení, pokud přenosy neprobíhají současně.
\end{enumerate}
Vzájemné ovlivňování.

Propojovací sítě: Multiplexované --- Sběrnicové (třístavové)

Každý krok výpočtu: Načtení operandu z registru, výpočet, zápis výsledku do registru. Lze zrychlit přiřazení registru před a/nebo za ALU (pipeline).

\subsubsection{Left-Edge algoritmus}
pro optimalizaci sdílení počtu proměnných/registrů podle doby života.

Seřazení do seznamu podle začátku jejich života (primární klíč) a konce jejich života (sekundární klíč).
V každém kroku algoritmu se alokuje nový registr a vždy první nepřekrývající se výskyty proměnných se do tohoto registru namapují a odstraní ze seznamu.

Rychlý a zaručuje optimální výsledky, ale nebere v potaz ostatní části úlohy alokace.

\subsubsection{Rozdělení úlohy na kliky}
Klika je úplný podgraf grafu $G(V, E)$. Rozdělení grafu na minimální počet klik.
Obecně NP-těžký problém -- heuristika:
\begin{itemize}
	\item Cílem je změnit graf $G$ na super-graf $G'(S, E)$, kde $S$ jsou vrcholy odpovídající klikám grafu $G$.
	\item Vychází se ze stavu, kdy $G'$ odpovídá $G$
	\item V každém kroku pro všechny dvojice vypočteme množinu společných sousedů
	\item Dva vrcholy, které mají nejvíce společných sousedů se spojí do jednoho vrcholu
	\item Všechny hrany vycházející z těchto vrcholů se odstraní a vytvoří se hrany propojující zaniklý vrchol se všemi společnými sousedy
\end{itemize}

\paragraph{Aplikace na úlohu přiřazeni}
\begin{description}
	\item[Přiřazení funkčních jednotek] Vrcholy grafu jsou operace vstupního DFG a
	hrany propojují takové vrcholy, které nejsou ve stejném kroku a mohou být zpracovány stejnou funkční jednotkou.

	Ohodnocení hran je inkrementováno, pokud dvojice operací sdílí některou ze svých vstupních nebo výstupních proměnných. Rozdělení s ohledem na maximální ohodnocení hran.
	\item[Přiřazení paměťových elementů] Vrcholy jsou proměnné a
	hrany propojují ty proměnné, které mohou být uloženy ve stejném registru (podle doby života)

	Ohodnocení hran je inkrementováno, pokud dvojice operací sdílí některou ze svých vstupních nebo výstupních portů, s ohledem na přiřazení operací k funkčním jednotkám. Rozdělení s ohledem na maximální ohodnocení hran.
	\item[Přiřazení propojovací sítě] Vrcholy jsou vodiče mezi entitami (registry, funkční jednotky) a
	hrany propojují pouze ty vrcholy, kde neprobíhá souběžný přenos dat.
\end{description}

\section{Alokace}
Často součástí plánování.
\begin{itemize}
	\item Výběr funkčních jednotek -- zřetězené, více-cyklové, multifunkční, pipeline, latence vs. množství zdrojů.
	\item Výběr paměťových elementů pro uložení proměnných -- Registr, Registrové pole, Víceportové RF, ROM, FIFO
	\item Výběr a propojení sloužící pro datové přenosy -- Sdílená, multiplexovaná, segmentovaná sběrnice, specifický komunikační protokol
\end{itemize}

Procesy Alokace -- Plánování -- Přiřazení jsou na sobě závislé. Ideální by bylo plánovat vše dohromady, ale kvůli složitosti jednotlivých částí je to obtížné.

Čas a prostor nejsou jedinými kritérii -- hodinová frekvence, spotřeba, propustnost paměti

\section{Jazyk Catapult C}
Postup při vytváření obvodů
\begin{enumerate}
	\item Příprava zdrojových kódů v jazyce C/C++ (ANSI)
	
	Nepodporované konstrukce: Dynamická alokace paměti, Union struktury, Datová typy float a double (ac\_fixed), rekurze s neznámou hloubkou zanoření
	\item Sestavení hierarchie obvodu
	\item Výběr cílové technologie, načtení knihovních bloků
	
	Výběr ASIC/FPGA, nástroje pro generování RTL, volitelné knihovny bloků
	\item Mapování bloků na hierarchii
	
	Nastavení požadovaní hodinové frekvence, další vlastnosti hodinového signálu a signálu Reset.
	\item Nastavení omezujících podmínek
	
	Latence x Plocha, Top-level funkce, Optimalizace smyček, Mapování rozhraní, Pamování proměnných
	\item Plánování
	
	Na základě omezujících podmínek je naplánováno rozdělení do kontrolních kroků (C-steps). Výstupem je Gantův diagram.
	
	C-step -- odpovídá stavu konečného automatu, mohou tvořit hierarchii (smyčky). Obsahuje množinu naplánovaných operací + režii spojenou s implementací stavu automatu.
	
	Výběr komponent -- různé implementace z knihoven s různým poměrem plocha/zpoždění.
	
	Cíla plánování: Plocha, Latence, Plocha + omezení max. latence, Latence + omezení max. plochy.
	\item Generován RTL
	
	Pokud plán vyhovuje, je vygenerováno RTL -- FSM, schémata, reporty o zdrojích, době výpočtu, kritické cesty. VHDL, Verilog, Netlist, atd) -- mikroarchitektura. Catapult uchovává historii  mezi kterými je možné přepínat.
	\item Verifikace RTL
	
	Potřeba napsat testbench v C/C++. Aplikován na původní zdrojový kód a souběžně na RTL simulovaný v ModelSIM. Porovnání výsledků.
\end{enumerate}

\subsection{Datový typy s bitovou přesností}
Potřebujeme využít každý bit (ne jako v CPU), celočíselné, pevná řádová čárka (\texttt{ac\_int<W,S>}, \texttt{ac\_fixed<W,I,S>}, nepovinné ošetření chování kvantizace a přetečení -- saturace/wrap).

\subsection{Syntéza základních konstrukcí}
\emph{Sekvence operací} je převedena do CDFG a naplánována do C-steps. Výstupy registrovány.

\emph{Podmíněné příkazy} pomocí flatteningu -- paralelní výpočet a o výsledku rozhodne multiplexor (možnost vynutit opačné chování).

\emph{Volání funkce} se chová jako inline kód (pozor v podmíněných sekcích). Ale lze realizovat také jako samostatnou komponentu.

\subsection{Syntéza smyček}
\emph{Nerozbalená smyčka} je výchozí chování -- sekvenční výpočet + 1 takt režie na začátku (inicializace) a na konci (uložení výstupu do registru)

\emph{Main jako smyčka} vykonávaná donekonečna.

\emph{Rozbalování smyček} nejefektivnější, ale velmi ovlivněné datovými závislostmi. Každá smyčka má své nastavení, kde určíme kolikrát rozbalit. Main lze rozbalit pouze částečně. Vhodné od vnitřních, musíme znát počet opakování (můžeme omezit na maximální počet opakování a přidat \texttt{break}).

\emph{Zřetězení smyček} -- následující iterace se začne vykonávat před ukončením předchozí iterace. Můžeme nastavit počáteční interval pro různé výsledné latence a propustnosti.

\emph{Zřetězení vnořených smyček} -- vnitřní smyčky převezmou zřetězení vnějších.

Některé smyčky nelze zřetězit s požadovaným II (zpětné vazby), nebo omezený přístup do/z paměti.

Zvyšuje propustnost dat skrze obvod a snižuje latenci. Zvýšení II vede k úspoře zdrojů (vyšší sdílení).

\emph{Spojování smyček} paralelní výpočet dvou nezávislých smyček. Může vést k větším požadavkům na zdroje.

\subsection{Mapování rozhraní}
Parametry funkce main(), částečně rozeznatelný směr, přidání typů \texttt{wait} (handshake, druhá strana musí potvrdit přijetí), \texttt{wired} (bez pomocných signálů), \texttt{wired\_en} (pomocný enable signál, když obvod vyžaduje čtení/zápis).

Parametry předané hodnotou jsou čteny pouze jednou a to na začátku. Reference jsou čteny pokaždé, když se využívají.

\subsection{Práce s pamětí}

\emph{Paměť} -- úspora zdrojů, sekvenční přístup (synchronní čtení i zápis)

\emph{Registry} -- nákladné na zdroje, paralelní přístup (synchronní zápis, asynchronní čtení)

Parametry lze definovat jako vnější paměť (sekvenční přístup), Catapult vytvoří další potřebné signály (\_data\_in, \_data\_out, \_addr, \_re, \_we). Pokud se nezvolí typ paměť, vytvoří se samostatné vodiče pro všechny prvky -- drahé.

\emph{Vnitřní paměť} sekvenční (1 operace za C-step!). Není vytvářeno rozhraní, potřeba definovat jako static. Nulování pole pomocí \texttt{vinit} (automaticky), nebo nechat neinicializované.

Více přístupů: Zvýšit datovou šířku, blokový přístup, prokládaný přístup

\subsection{Verifikace}
Porovnání originálního C programu s modifikovaným a poté s výsledku RTL schématu.

Časování vstupů/výstupů pomocí \texttt{\_triosy\_lz} signálů

\subsection{Hierarchický návrh}
AC channel pro zasílání zpráv -- FIFO -- šablona v C++ (libovolná data). Přenos mezi komponentami s různou rychlostí zpracování. Může být neblokující -- nastavení velikosti a test na obsah.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Odhady (přesnost, věrnost, metriky, metody) a optimalizace vlastností systému (příkon, energie).} \label{cha:5}
1. semestr, HSC, \texttt{05odhady\_20141026.pdf}, \texttt{06prikon\_20141109.pdf} ?

\section{Odhady}
Přesnost x Složitost:
\begin{itemize}
	\item High-level -- rychlé odhady, abstrakce od implementačních detailů, omezená přesnost, neznámé časování
	\item Low-level -- přesnější, mnoho implementačních detailů = pomalé
\end{itemize}

Metody získávání parametrů systému
\begin{itemize}
	\item Měření -- využití existující instance systémů
	\item Simulace -- program implementující model systému a jeho evaluace
	\item Statistika -- statistická abstrakce systému, analytické nebo simulační vyhodnocování
	\item Formální analýza -- tvorba matematické abstrakce systému, výpočet výrazů
\end{itemize}

Přesnost: $A = + \frac{|E(D) - M(D)|}{M(D)}$ -- odhadovaná a přesná implementace systému D\\
Věrnost: $F = 100 \cdot \frac{2}{n(n-1)} \cdot \sum\limits_{i=1}^n \sum\limits_{j=i+1}^n \mu_{i,j}$ -- pro několik odhadů a měření. $\mu_{i,j} = 1$ pokud jsou odhady a měření ve stejném poměru

\subsection{Metriky: Hardware}
Cena: Úměrná ploše čipu. Tranzistory, ekvivalentní hradla NAND, logické bloky FPGA, počet pinů\\
FSM model: Datová cesta: registr, funkční jednotky, logika, spoje; Řadič: registr stavu, KLS následujícího stavu, výstupní KLS\\
Příkon/Energie (CMOS): $P = P_{static} + P_{dynamic}$; $P_{dynamic} = P_{short} + P_{load}$. $P = C_{load} \times \alpha \times f \times V_{dd}^2$ ($\alpha \dots$ activity factor).

Model architektury: Zpoždění datových cest, počet kroků řadiče, potřebná kapacita paměti.

\emph{Nevyužitá doba (slack) periody hodin} -- hledání takové, při které dosáhneme maximálního využití = minimální slack.\\
$avgslack(T) = \frac{\sum_{k=1}^{|V_T|} occ( v_k) \cdot slack(T, V_k)}{\sum_{k=1}^{|V_T|} occ(V_k)}$

$util(T) = 1 - \frac{avgslack(T)}{T}$

Odhad počtu kroků řadiče -- doba vykonání úlohy, složitost řadiče

\subsection{Metriky -- Výkonnost: Software}
\begin{itemize}
	\item \emph{Změřená doba běhu programu} (potřeba instance implementace), jednoduché ke změření (čítač ticků CPU), ale nepřenositelné na jiné architektury.
	\item \emph{Aplikační benchmark} -- sada programů pro danou aplikační oblast, méně reprezentativní, více přenositelné.\\
	Standard Performance Evaluation Corporation (SPEC), musí být přeloženy se standardním nastavením kompilátorů
	\item \emph{Benchmark algoritmu} -- Počet cyklů, velikost paměti, jednoduše použitelné, nemusí být přenositelné\\
	\item \emph{Parametry architektury HW (platforma, CPU)} -- počet operací za jednotku času, problematické pro porovnání architektur.\\
	MIPS (instructions per second), MFLOPS (floating point operations per second, MACS (multiply and accumulates per second, MOPS (operations per second)
\end{itemize}

Odhad pomocí procesorově specifického modelu, nebo generického.

\emph{Doba výpočtu}:\\
Sekvenční kód: $T_{EXE} = \frac{\text{\#sec}}{\text{program}} = \frac{\text{\#instrukcí}}{\text{program}} = \frac{\text{\#cyklů}}{\text{instrukce}} = \frac{\text{\#sekund}}{\text{cyklus}}$\\
Kód se skoky: Odhad $T_{EXE}$ pro každý blok programu, graf toku řízení základních bloků a stanovení pravděpodobnosti průchodu jednotlivými uzly: $T_{EXE} = \sum_{b_j \in B}(b_i) \times freq(b_i)$.

\subsection{Worst case execution Time (WCET)}
Nejdelší doba vykonání úlohy. Funkce vstupních dat a prostředí, ve kterém je úloha vykonávána.

(BCET = Best case execution time)

WCET nelze stanovit profilací, odhad je vždy vyšší. Nelze nalézt vždy (nerozhodnutelný problém).\\
Nutno prozkoumat všechny cesty v programu (exponenciální růst možností s větvením).\\
Závisí na cílové architektuře (zřetězení, predikce skoků, cache).\\
Důležité pro systémy reálného času (správnost -- včas?, výkonnost).

Omezení pro výpočet -- jeden procesor bez přerušení a OS. Kompletní znalost mikroarchitektury (pipeline, cache, predikce skoků).

Omezení pro program -- konečný počet iterací smyček, bez rekurze, nepřerušený výpočet, jedno vlákno, žádné ukazatele. Potřeba nalézt nejdelší cesty v programu, identifikace proveditelných cest a závislosti mezi různými fragmenty kódu.

CFG (Control flow graf) -- uzly jsou základní bloky, hrany tokem řízení. Nalezení nejdelší cesty (s rozbalením smyček -- acyklický graf). $WCET = \max\{\sum_{i=1}^n c_i \cdot x_i\}$, kde $N$ jsou bloky kódu, $c_i$ je doba vykonání daného bloku, $x_i$ je kolikrát je daný blok vykonán. Počet vykonání zjistíme z rovnice toku mezi bloky: $x_i = \text{ vstupy } = \text{ výstupy }$ a funkčních omezení určených programátorem.

Možnost vyhodnocení chování cache pro daný algoritmus. WCET více sekvenčních úloh nelze sčítat (stav cache může ovlivnit vykonání druhého algoritmu). Časově velmi náročné (obecně nerozhodnutelný problém). Výsledek platný pouze pro daný SW a HW.

\subsection{Vestavěné systémy: Metriky}
\begin{itemize}
	\item Kapacita paměti -- využití cache, hlavní paměti, ROM.\\
	Ovlivnění konfigurací SW, optimalizací kódu. Důležité pro návrh HW. Výrazně omezuje výkonnost
	\begin{itemize}
		\item Velikost paměti programu -- odhad $prog\_size = \sum_{j \in B_i} isntr\_size(j)$
		\item Velikost datové paměti -- program obsahuje množinu deklarací: $data\_size = \sum_{d\in D} data\_size(d)$
	\end{itemize}
	\item Latence
	\begin{itemize}
		\item Latence přerušení -- zakázání při ochraně kritických sekcí kódu (nejhorší případ).\\
		Nejlepší případ -- reakční doba HW + režie OS při zpracování přerušení.
		\item Latence plánování úloh -- max( Latence plánování po přerušení + latence přepínání kontextu)
	\end{itemize}
	\item Propustnost -- počet transakcí za sekundu
	\item Výkonnost OS (služby) -- minimální čas, který potřebuje OS pro dokončení volání systémových služeb
\end{itemize}

Klasické odhady zrychlení:

$S$: Zrychlení, $s$: sekvenční část, $p$: paralelizovaná část úlohy, $N$: stupeň urychlení paralelizované části, $M$: počet stupňů zřetězené sekvenční části.

\emph{Amdahlův zákon}: Akcelerace paralelním zpracováním části úlohy:
$S_A = \frac{s + p}{s + \frac{p}{N}}$

\emph{Gustafsonův zákon}: Zvýšíme množství práce, které bude zpracovávat paralelizovaná část úlohy:
$S_G = s + N \cdot p$

\emph{Gustafsonův zákon + zřetězená sekvenční linka}: Urychlení sekvenční části + předpoklad plné pipeline:
$S_{GZ} = \frac{ \frac{s}{M} + N \cdot p }{ \frac{s}{M} + p}$




\section{Optimalizace vlastností}
\subsection{Příkon}

Tradičně důraz kladen na cenu a výkonnost. V současnosti je také zohledněn příkon a energetická náročnost.

\emph{Pollackovo pravidlo}: Efektivní využitelná výkonnost mikroprocesorů roste přibližně s druhou odmocninou jejich složitosti. Příkon roste úměrně složitosti!

Problémy: Odvod tepla, hustota tepelného výkonu se blíží nukleárnímu reaktoru. Se snížením napětí je potřeba snižovat frekvenci.

\emph{Landaerův limit}: Každý logický obvod má energetické ztráty -- minimální možné množství energie pro změnu jednoho bitu informace.

Přenosná zařízení dominují trhu: Pro baterie neplatí obdoba Mooreova zákona -- kapacita se zvyšuje pomalu a tak je potřeba snižovat výkon.

\subsection{Metriky}
Příkon = ztráty -- teplo, které je potřeba odvést

Energie (příkon za čas) -- pro mobilní zařízení určuje životnost baterie. Lze normalizovat na hodinovou frekvenci.

Energie za čas -- pro zařízení pracující na max. frekvenci.

CMOS: Příkon
\begin{itemize}
	\item Statický: na vstupech se nemění logické úrovně -- svodové proudy (leakage)
	\item Dynamický: změny logických úrovní -- nabíjení a vybíjení parazitních kapacit a rychlost změn.
	\begin{itemize}
		\item Přechodový:
		\begin{itemize}
			\item Přepínací: Parazitní kapacity tranzistorů a frekvence změn jednotlivých vstupů
			\item Zkratový: Při přechodu mohou být horní i dolní tranzistor oba krátce otevřeny -- zkrat.
		\end{itemize}
		\item Příkon zátěže: Nabíjení a vybíjení parazitních kapacit
	\end{itemize}
\end{itemize}
Změna log. úrovně: $E = C \cdot V_{DD}^2$

Dynamický příkon je dominantní: $P_D = \alpha \cdot f_{CLK} \cdot C \cdot V_{DD}^2$ (faktor aktivity -- dán pravděpodobností přechodů mezi úrovněmi: Pro CLK $\alpha = 1$, frekvence hodin)

Př: Snížení napájecího napětí na polovinu $\rightarrow$ příkon klesne 4x, zpoždění vzroste 2x

\subsection{Snížení příkonu}
\begin{itemize}
	\item Dynamický příkon
	\begin{itemize}
		\item Faktor aktivity $\alpha$: Hradlování hodin
		\begin{itemize}
			\item Reprezentace čísel -- přímý kód, jedničkový doplněk, dvojkový doplněk
			\item Sdílení sběrnice v čase zvyšuje aktivitu
			\item Více registrů s více porty, Selektivní write-back -- lepší ICP
			\item Vyrovnávací paměti pro omezení přenášených dat po sběrnici
		\end{itemize}
		\item Parazitní kapacita $C$: Malé tranzistory, krátké spoje
		\item Napájecí napětí $V_{DD}$ nejnižší možné
		\item Pracovní frekvence $f$: nejnižší možná (pro danou úlohu)
		\item Optimalizace příkonu činného systému:
		\begin{itemize}
			\item Dynamic Voltage and Frequency Scaling (DVFS)\\
			Program pracuje po celou dobu s minimální frekvencí, než aby zůstal nevyužitý část kroku. Řízeno aplikací
			\item Adaptive Voltage Scaling (AVS)\\
			Pro daný čip určena optimální hodnota výkonnosti (Operating Performance Point). V závislosti na teplotě čipu se upravuje napájecí napětí v okolí OPP. Pracuje společně s DVFS (přesné doladění napětí)
			\item Dynamic Power Switching (DPS)\\
			Omezuje pouze příkon způsobený svody (leakage). Úloha je dokončena co nejrychleji a poté systém přejde do low-power módu s \uv{nulovým} statickým příkonem. Např. inicializace DMA přenosu.
		\end{itemize}
	\end{itemize}
	\item Statický příkon
	\begin{itemize}
		\item Minimalizace příkonu nečinného systému
		\begin{itemize}
			\item Static Leakage Management (SLM)\\
			Podobně jako DPS, jen pomalejší náběh (Displej se vypne po 10 s)
			\item Low-power módy (standby, deep sleep)
		\end{itemize}
	\end{itemize}
\end{itemize}

Snížení příkonu SoC: Rozdělení na subsystémy a domény: Hierarchicky

\begin{itemize}
	\item Hodinová doména -- společný hodinový signál subsystémů
	\item Napájecí doména -- společné přepínatelní napájecí zdroje
	\item Napěťová doména -- napájení stejným napětím
\end{itemize}

\paragraph{Synchronní obvody}
Globální hodinový signál -- jednoduchá syntéza, bez hazardů. Vyšší příkon, drahý systém distribuce. Fyzikální limity: Omezení pracovní frekvence (clock skew, clock and variation margin) až 40\%.

\paragraph{Asynchronní obvody}
Možný vznik hazardů, není podpora návrhových nástrojů a ne často používaný způsob. Ale nižší příkon, lepší elektromagnetická kompatibilita, latence a propustnost. Řízeny tokem dat!

\paragraph{Micropipeline}
Jedny lokální hodiny pro každá stupeň -- řízené handshake protokolem 

\paragraph{GALS obvody}
Globálně asynchronní a lokálně synchronní obvody. Dekompozice složitých systémů. Vyšší rychlost.

Snížení příkonu: Hradlování hodin.

Popis konečným automatem, komunikujícími sekvenčními procesy, nebo Kahnovou sítí procesů (FIFO fronty)

Alternativní zdroje energie -- vibrace, pohyb, rozptyl teplot, světlo, radiový signál.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Jazyk a sémantika predikátové logiky} \label{cha:6}
1. semestr, MAT, \texttt{logikaaktual3.pdf}, 3., 4. kapitola

(termy, formule, realizace jazyka, pravdivost formulí)

\section{Jazyk predikátové logiky}

\begin{itemize}
	\item Logické symboly
	\begin{itemize}
		\item proměnné: $x, y, z, \dots, x_1, x_2, \dots$
		\item logické spojky: $ \lnot, \land, \lor, \to, \leftrightarrow$
		\item kvantifikátory: $\exists, \forall$
		\item závorky, čárka: $(,)$
		\item predikátový symbol rovnosti $=$
	\end{itemize}
	\item Speciální symboly
	\begin{itemize}
		\item funkční symboly $f, g, h, \dots, f_1, f_2, f_3$, nezáporné celé číslo -- četnost
		\item predikátové symboly $p, q, r, \dots, p_1, p_2, \dots$, kladné celé číslo -- jeho četnost.
	\end{itemize}
\end{itemize}

Obsahuje-li jazyk symbol $=$ pro rovnost, mluvíme o \emph{jazyku s rovností}.
Specifiku jazyka určují jeho funkční a predikátové symboly (určující oblast kterou jazyk popisuje)

\subsection{Termy}
\begin{enumerate}[(i)]
	\item Každá proměnná je term
	\item Je-li $f$ funkční symbol s četností $n$ a jsou-li $t_1, \dots, t_n$ termy, pak také $f(t_1, \dots, t_n)$ je term
	\item Každý term vznikne konečným počtem užití (i), (ii)
\end{enumerate}
(ze (ii) plyne, že každá konstanta je term)

\subsection{Atomické formule}
Je-li $p$ predikátový symbol s četností $n$ a jsou-li $t_1, \dots t_n$ termy, pak $p(t_1, \dots, t_n)$ je \emph{atomická formule}.

Speciální, máme-li jazyk s rovností a jsou-li $t_1, t_2$ termy, pak $(t_1 = t_2)$ je atomická formule.
Píšeme $(t_1 = t_2)$ místo $=(t_1, t_2)$. Podobný zápis používáme i pro jiné binární predikátové operátory, např. místo $< (t_1, t_2)$ píšeme $(t_1 < t_2)$.

\subsection{Formule}
\begin{enumerate}[(i)]
	\item Každá atomická formule je formule
	\item Jsou-li $\varphi, \psi$ formule, pak také $(\lnot \varphi), (\varphi \land \psi), (\varphi \lor \psi), (\varphi \to \psi), (\varphi \leftrightarrow \psi)$ jsou formule.
	\item Je-li $x$ proměnná a $\varphi$ formule, pak také $(\forall x \varphi)$, $(\exists x \varphi)$ jsou formule.
	\item Každá formule vznikne konečným počtem užití (i), (ii), (iii)
\end{enumerate}

\tikzset{every tree node/.style={align=center,anchor=north}}
\Tree[.{Formule}
	[.{Atomická formule}
		{Predikátový symbol\\ + Term\\ $p(t_1, \dots, t_n)$}
		[.{Term}
			{Proměnná\\ $x$}
			{Funkční symbol\\ + Term\\ $f(t_1, \dots, t_n)$}
			]
		]
	{Logické spojky\\ + Formule\\ $\varphi \land \psi$}
	{Kvantifikátory\\ + Proměnné\\ + Formule\\ $\forall x \varphi$}
]

\begin{description}
	\item[Vázaný výskyt proměnné] nachází-li se v nějaké podformuli tvaru $\forall x \varphi$ nebo $\exists x \varphi$.
	\item[Obor kvantifikátoru] $\varphi$
	\item[Volný výskyt proměnné] není vázaný
	\item[Volná (Vázaná) proměnná] existuje-li volný (vázaný) výskyt proměnné v této formuli
	\item[Uzavřená formule (Výrok)] Formule neobsahující žádnou volnou proměnnou
	\item[Otevřená formule (Výrok)] Formule neobsahující žádnou vázanou proměnnou
	\item[Formule s čistými proměnnými] Otevřené a uzavřené formule
\end{description}

\section{Sémantika predikátové logiky}

\begin{mydef}
Nechť $L$ je jazyk 1. řádu. \emph{Realizací jazyka} $L$ rozumíme algebraickou strukturu $\mathcal{M}$, která se skládá z
\begin{enumerate}[(i)]
	\item neprázdné množiny $M$, kterou nazveme \emph{univerzum}
	\item pro každý funkční symbol $f$ četností $n$ je dáno zobrazení $f_\mathcal{M} : M^n \to M$
	\item pro každý predikátový symbol $p$ četnosti $n$, kromě rovnosti, je dána relace $p_\mathcal{M} \subset M^n$
\end{enumerate}
Poznamenejme, že pro nulární funkční symbol, tj. pro konstantu, je $M^0 = \{0\}$ a příslušné zobrazení $M^0 \to M$ lze chápat jako vyznačení určitého prvku z $M$ odpovídajícího daného konstantě.
\end{mydef}

\paragraph{Ohodnocení proměnných}: Libovolné zobrazení $e$ množiny všech proměnných do univerza $M$ dané realizace $\mathcal{M}$ jazyka $L$. Pokud proměnné $x$ přiřazuje prvek $m$, budeme značit $e(x/m)$.

\begin{mydef}
\emph{Hodnota termu} $t$ v realizaci $\mathcal{M}$ jazyka $L$ při daném ohodnocení $e$ proměnných, označovaná $t[e]$, se definuje indukcí následovně:
\begin{enumerate}[(i)]
	\item Je-li $t$ proměnná $x$, potom $t[e]$ je $e(x)$
	\item je-li $t$ term tvaru $f(t_1, \dots, t_n)$, kde $f$ je funkční symbol četnosti $n$ a $t_1, \dots, t_n$ jsou termy, potom $t[e]$ je $f_\mathcal{M}(t_1[e], \dots, t_n[e])$
\end{enumerate}

\end{mydef}
\begin{mydef}
Nechť $\mathcal{M}$ je realizace jazyka $L$, nechť $e$ je ohodnocení proměnných a nechť $\varphi$ je formule jazyka $L$. Indukcí podle složitosti formule $\varphi$ definujeme, co znamená, že \emph{formule $\varphi$ je pravdivá v $\mathcal{M}$ při ohodnocení $e$}. Tuto skutečnost budeme značit $\mathcal{M} \models \varphi[e]$
\begin{enumerate}[(i)]
	\item Je-li $\varphi$ atomická formule tvaru $p(t_1, \dots, t_n)$, kde $p$ je predikátový symbol četnosti $n$ a $t_1, \dots, t_n$ jsou termy, pak $\mathcal{M} \models \varphi[e]$ právě když $(t_1[e], \dots, t_n[e]) \in p_\mathcal{M}$.
	\item Je-li $\varphi$ atomická formule tvaru $t_1 = t_2$, kde $t_1, t_2$ jsou termy, pak $\mathcal{M} \models \varphi[e]$ právě když $t_1[e]$ je tentýž prvek jako $t_2[e]$ v $M$
	\item Je-li $\varphi$ tvaru $\lnot \psi$, kde je $\psi$ je formule jazyka $L$, pak $\mathcal{M} \models \varphi[e]$ je právě když $\mathcal{M} \not\models \psi[e]$.
	\item Je-li $\varphi$ některého z tvarů $(\eta \land \psi), (\eta \lor \psi), (\eta \to \psi), (\eta \leftrightarrow \psi)$, kde $\eta$, $\psi$ jsou formule, klademe: \\
	$\mathcal{M} \models (\eta \land \psi)[e]$ právě když současně $\mathcal{M} \models \eta[e]$ a $\mathcal{M} \models \psi[e]$. \\
	$\mathcal{M} \models (\eta \lor \psi)[e]$ právě platí alespoň jedno z $\mathcal{M} \models \eta[e]$ a $\mathcal{M} \models \psi[e]$ a podobně další logické spojky.
	\item Je-li $\varphi$ tvaru $(\forall x \psi)$, kde $\psi$ je formule jazyka $L$, pak $\mathcal{M} \models \varphi[e]$ právě když pro každý prvek $m \in M$ je $\mathcal{M} \models \psi[e(x/m)]$.
	\item Je-li $\varphi$ tvaru $(\exists x \psi)$, kde $\psi$ je formule jazyka $L$, pak $\mathcal{M} \models \varphi[e]$ právě když existuje $m \in M$ taková, že $\mathcal{M} \models \psi[e(x/m)]$.
\end{enumerate}
\end{mydef}

\begin{comment}
\section{Ostatní}

Formalizovaná axiomatická teorie je dána
\begin{itemize}
	\item symboly -- tvoří abecedu
	\item formulemi -- určitá slova této abecedy, která tvoří jazyk této teorie
	\item axiomy -- výchozí tvrzení této teorie zapsaná pomocí abecedy jako jisté formule
	\item odvozovací pravidla --  pravidla pro manipulaci s formulemi, pomocí kterých odvozujeme z axiomů důsledky.
\end{itemize}

\begin{description}
	\item[Proměnné] Označení libovolného prvku z daného oboru $(x, y, z, \dots, x_1, x_2, \dots)$
	\item[Konstanty] Význačné objekty $(0, 1, \dots)$
	\item[Funkční symboly] Operace $(f, g, h, \dots, f_1, f_2, f_3)$
	\item[Četnost funkčního symbolu] počet argumentů dané operace
	\item[Predikáty] Vlastnosti a vztahy mezi objekty
	\item[Predikátové symboly] Vyjádření predikátů? $(p, q, r, \dots, p_1, p_2, \dots)$.
	\item[Četnost predikátového symbolu] počet argumentů predikátu
	\item[Atomické formule] Nejjednodušší tvrzení, složená z \emph{Proměnných}, \emph{konstant}, \emph{funkčních symbolů}, \emph{predikátových symbolů}.
	\item[Složitější formule] Atomické formule + logické spojky + kvantifikace proměnných ($\forall, \exists$)
	\item[Abeceda predikátové logiky 1. řádu] výše uvedené symboly s logickými spojkami a pomocnými symboly (závorky, čárka).
\end{description}


\section{Predikátová logika 1. řádu}

Matematické teorie pracují s celými soubory objektů (čísla, body v prostoru, prvky algebraických struktur).
Pro označení lib. prvků z daného oboru používáme \emph{proměnné} $(x, y, z, \dots, x_1, x_2, \dots)$

Mezi prvky z daného oboru mohou být některé význačné objekty (0, neutrální prvek grupy, \dots), pro než užíváme zvláštní symboly -- \emph{konstanty} (např. 0, 1, \dots).

S objekty daného oboru lze provádět různé operace (sčítání a násobení čísel, násobení v grupách, \dots).
K označení operace užíváme \emph{funkční symboly} $(f, g, h, \dots, f_1, f_2, f_3)$.
Ke každému funkčnímu symbolu je přiřazeno přirozené číslo, které vyjadřuje jeho \emph{četnost}, tj. počet argumentů dané operace.
Je-li četnost symbolu rovna $n$, říkáme, že symbol je $n$-ární.
Je přirozené chápat konstanty jako nulární funkční symboly.

Matematika zkoumá vlastnosti objektů a vztahy mezi objekty.
Vlastnosti  a vztahy mezi objekty daného oboru, tzv. \emph{predikáty} (\uv{být záporným číslem} (vlastnost), \uv{být menší než}, \uv{být prvkem} (vztahy)) vyjadřujeme pomocí \emph{predikátových symbolů} $(p, q, r, \dots, p_1, p_2, \dots)$.
Predikát znamená vztah mezi užitým počtem objektů.
Tím je každému predikátovému symbolu přiřazeno přirozené číslo, jeho četnost udávající počet jeho argumentů.
Je-li četnost rovna $n$, říkáme, že symbol je \emph{n-ární}.
V mnoha případech používáme zvláštní označení = pro binární predikátový symbol označující rovnost, tj. totožnost objektů z daného oboru.

Z proměnných, konstant, funkčních symbolů a predikátových symbolů sestavujeme jistým způsobem nejjednodušší tvrzení, vyjádřená tzv. \emph{atomickými formulemi}.
Z nich vytváříme složitější formule pomocí \emph{logických spojek} (stejných jako ve výrokové logice) a pomocí \emph{kvantifikace proměnných}.\\
\emph{Univerzální (obecný) kvantifikátor} $\forall$ vyjadřuje platnost pro všechny objekty z daného oboru.\\
\emph{Existenční kvantifikátor} $\exists$ vyjadřuje existenci požadovaného objektu v daném oboru.

Uvedené symboly spolu s logickými spojkami a \emph{pomocnými symboly} (závorka, čárka) tvoří abecedu jazyka \emph{predikátové logiky 1. řádu}.
Proměnné jazyka prvního řádu jsou obecná jména pro objekty daného oboru, tj. pro individua (např. čísla).
Jazyk neobsahuje proměnné pro množiny individuí (např. množiny čísel, relací, \dots), vyšších řádů, které dovolují kvantifikovat např. množiny, relace.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Jazyk predikátové logiky}

\begin{itemize}
	\item Logické symboly
	\begin{itemize}
		\item proměnné: $x, y, z, \dots, x_1, x_2, \dots$
		\item logické spojky: $ \lnot, \land, \lor, \to, \leftrightarrow$
		\item kvantifikátory: $\exists, \forall$
		\item závorky, čárka: $(,)$
		\item predikátový symbol rovnosti $=$
	\end{itemize}
	\item Speciální symboly
	\begin{itemize}
		\item funkční symboly $f, g, h, \dots, f_1, f_2, f_3$, nezáporné celé číslo -- četnost
		\item predikátové symboly $p, q, r, \dots, p_1, p_2, \dots$, kladné celé číslo -- jeho četnost.
	\end{itemize}
\end{itemize}

Obsahuje-li jazyk symbol $=$ pro rovnost, mluvíme o \emph{jazyku s rovností}.
Specifiku jazyka určují jeho funkční a predikátové symboly (určující oblast kterou jazyk popisuje)

\subsection{Termy}
\begin{enumerate}[(i)]
	\item Každá proměnná je term
	\item Je-li $f$ funkční symbol s četností $n$ a jsou-li $t_1, \dots, t_n$ termy, pak také $f(t_1, \dots, t_n)$ je term
	\item Každý term vznikne konečným počtem užití (i), (ii)
\end{enumerate}
(ze (ii) plyne, že každá konstanta je term)

\subsection{Atomické formule}
Je-li $p$ predikátový symbol s četností $n$ a jsou-li $t_1, \dots t_n$ termy, pak $p(t_1, \dots, t_n)$ je \emph{atomická formule}.

Speciální, máme-li jazyk s rovností a jsou-li $t_1, t_2$ termy, pak $(t_1 = t_2)$ je atomická formule.
Píšeme $(t_1 = t_2)$ místo $=(t_1, t_2)$. Podobný zápis používáme i pro jiné binární predikátové operátory, např. místo $< (t_1, t_2)$ píšeme $(t_1 < t_2)$.

\subsection{Formule}
\begin{enumerate}[(i)]
	\item Každá atomická formule je formule
	\item Jsou-li $\varphi, \psi$ formule, pak také $(\lnot \varphi), (\varphi \land \psi), (\varphi \lor \psi), (\varphi \to \psi), (\varphi \leftrightarrow \psi)$ jsou formule.
	\item Je-li $x$ proměnná a $\varphi$ formule, pak také $(\forall x \varphi)$, $(\exists x \varphi)$ jsou formule.
	\item Každá formule vznikne konečným počtem užití (i), (ii), (iii)
\end{enumerate}

Poznamenejme, že píšeme $x \not= y$ místo $\lnot (x, y)$ a také, pokud to nemůže narušit srozumitelnost, vynecháváme některé dvojice závorek.

Při tvorbě formule $\varphi$ podle předchozí definice vytváříme určitou posloupnost formulí, která začíná atomickými formulemi a končí formulí $\varphi$ a každá formule v této posloupnosti vzniká z některých předcházejících pomocí logických spojek a kvantifikátorů. Každá z těchto formulí se nazývá podformule $\varphi$.

Každá formule je konečnou posloupností symbolů. Každý symbol, zejména každá proměnná, se může ve formuli vyskytovat na jednom nebo více místech.
Řekněme, že daný \emph{výskyt} proměnné $x$ ve formuli $\varphi$ je \emph{vázaný}, nenachází-li se v nějaké podformuli tvaru $\forall x \psi$ nebo $\exists x \psi$. V tomto případě se proměnná $x$ vyskytuje v kvantifikátoru samém nebo ve formuli $\psi$ (podformule $\psi$ se nazývá \emph{obor kvantifikátoru} $\forall x$ nebo $\exists x$.
V opačném případě (výskyt není vázaný) řekneme, že daný výskyt proměnné $x$ ve formuli $\phi$ je \emph{volný}.
Proměnná $x$ se nazývá \emph{volnou (vázanou) proměnnou} ve formuli $\phi$, existuje-li její volný (vázáný) výskyt v této formuli.
Proměnná tedy může být ve formuli volná i vázaná. Formule neobsahující žádnou volnou proměnnou se nazývá \emph{uzavřená formule} nebo též \emph{výrok}.
Naopak, formule neobsahující žádnou vázanou proměnnou se nazývá \emph{otevřenou formulí}. Uzavření a otevřené formule nazýváme \emph{formulemi s čistými proměnnými}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Sémantika predikátové logiky}

Chceme dát interpretaci symbolům jazyka predikátové logiky 1. řádu.
Nejprve vymezíme obor, který budeme určovat možné hodnoty proměnných, bude to určitý soubor $M$ uvažovaných objektů.
Funkčním symbolům budou odpovídat operace na $M$ příslušných četností.
Predikátovým symbolům budou odpovídat vztahy mezi objekty z $M$, které lze popsat jako relace na $M$ příslušných četností. Máme-li jazyk s rovností, interpretujeme symbol $=$ jako rovnost objektů z $M$.

\begin{mydef}
Nechť $L$ je jazyk 1. řádu. \emph{Realizací jazyka} $L$ rozumíme algebraickou strukturu $\mathcal{M}$, která se skládá z
\begin{enumerate}[(i)]
	\item neprázdné množiny $M$, kterou nazveme \emph{univerzum}
	\item pro každý funkční symbol $f$ četností $n$ je dáno zobrazení $f_\mathcal{M} : M^n \to M$
	\item pro každý predikátový symbol $p$ četnosti $n$, kromě rovnosti, je dána relace $p_\mathcal{M} \subset M^n$
\end{enumerate}
\end{mydef}

Poznamenejme, že pro nulární funkční symbol, tj. pro konstantu, je $M^0 = \{0\}$ a příslušné zobrazení $M^0 \to M$ lze chápat jako vyznačení určitého prvku z $M$ odpovídajícího daného konstantě.

Chceme-li zkoumat pravdivost formulí jazyka $L$ v nějaké jeho realizaci $\mathcal{M}$ musíme volným proměnným přiřadit hodnoty, jimiž budou nějaké prvky množiny $M$.

\begin{mydef}
Libovolné zobrazení $e$ množiny všech proměnných do univerza $M$ dané realizace $\mathcal{M}$ jazyka $L$ budeme nazývat \emph{ohodnocení proměnných}.

Je-li $x$ proměnná a $e$ ohodnocení proměnných a $m \in M$, potom ohodnocení proměnných, které proměnné $x$ přiřazuje prvek $m$ a pro všechny ostatní proměnné splývá s ohodnocením $e$, budeme značit $e(x/m)$.
\end{mydef}

\begin{mydef}
\emph{Hodnota termu} $t$ v realizaci $\mathcal{M}$ jazyka $L$ při daném ohodnocení $e$ proměnných, označovaná $t[e]$, se definuje indukcí následovně:
\begin{enumerate}[(i)]
	\item Je-li $t$ proměnná $x$, potom $t[e]$ je $e(x)$
	\item je-li $t$ term tvaru $f(t_1, \dots, t_n)$, kde $f$ je funkční symbol četnosti $n$ a $t_1, \dots, t_n$ jsou termy, potom $t[e]$ je $f_\mathcal{M}(t_1[e], \dots, t_n[e])$
\end{enumerate}
\end{mydef}

\begin{mydef}
Nechť $\mathcal{M}$ je realizace jazyka $L$, nechť $e$ je ohodnocení proměnných a nechť $\varphi$ je formule jazyka $L$. Indukcí podle složitosti formule $\varphi$ definujeme, co znamená, že \emph{formule $\varphi$ je pravdivá v $\mathcal{M}$ při ohodnocení $e$}. Tuto skutečnost budeme značit $\mathcal{M} \models \varphi[e]$
\begin{enumerate}[(i)]
	\item Je-li $\varphi$ atomická formule tvaru $p(t_1, \dots, t_n)$, kde $p$ je predikátový symbol četnosti $n$ a $t_1, \dots, t_n$ jsou termy, pak $\mathcal{M} \models \varphi[e]$ právě když $(t_1[e], \dots, t_n[e]) \in p_\mathcal{M}$.
	\item Je-li $\varphi$ atomická formule tvaru $t_1 = t_2$, kde $t_1, t_2$ jsou termy, pak $\mathcal{M} \models \varphi[e]$ právě když $t_1[e]$ je tentýž prvek jako $t_2[e]$ v $M$
	\item Je-li $\varphi$ tvaru $\lnot \psi$, kde je $\psi$ je formule jazyka $L$, pak $\mathcal{M} \models \varphi[e]$ je právě když $\mathcal{M} \not\models \psi[e]$.
	\item Je-li $\varphi$ některého z tvarů $(\eta \land \psi), (\eta \lor \psi), (\eta \to \psi), (\eta \leftrightarrow \psi)$, kde $\eta$, $\psi$ jsou formule, klademe: \\
	$\mathcal{M} \models (\eta \land \psi)[e]$ právě když současně $\mathcal{M} \models \eta[e]$ a $\mathcal{M} \models \psi[e]$. \\
	$\mathcal{M} \models (\eta \lor \psi)[e]$ právě platí alespoň jedno z $\mathcal{M} \models \eta[e]$ a $\mathcal{M} \models \psi[e]$ a podobně další logické spojky.
	\item Je-li $\varphi$ tvaru $(\forall x \psi)$, kde $\psi$ je formule jazyka $L$, pak $\mathcal{M} \models \varphi[e]$ právě když pro každý prvek $m \in M$ je $\mathcal{M} \models \psi[e(x/m)]$.
	\item Je-li $\varphi$ tvaru $(\exists x \psi)$, kde $\psi$ je formule jazyka $L$, pak $\mathcal{M} \models \varphi[e]$ právě když existuje $m \in M$ taková, že $\mathcal{M} \models \psi[e(x/m)]$.
\end{enumerate}
\end{mydef}

\begin{mydef}
Řekneme, že formule $\varphi$ jazyka $L$ je \emph{logicky platná}, jestliže pro každou realizaci $\mathcal{M}$ jazyka $L$ je $\mathcal{M} \models \varphi$, píšeme $\models \varphi$.
\end{mydef}
\end{comment}
















%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Formální systém predikátové logiky} \label{cha:7}

1. semestr, MAT, \texttt{logikaaktual3.pdf}, 5., 6., 7., 8. kapitola

(axiomy a odvozovací pravidla, dokazatelnost, model a důsledek teorie, věty o úplnosti a kompaktnosti, prenexní tvar formulí)

\section{Axiomy}

%Budujeme predikátovou logiku jako formální axiomatický systém. Jazyk $L$ predikátové logiky přebíráme z předchozího s tím, že z logických spojek bereme jako základní $\lnot$ a $\to$ (ostatní mohou být definovány jako ve výrokovém počtu). Z kvantifikátorů bereme jako základní $\forall$, kvantifikátor $\exists$ je možno zavést takto: Je-li $\varphi$ formule, pak $\exists x \varphi$ je zkratka pro $\lnot(\forall x (\lnot \varphi))$. Omezíme se tedy pouze na ty formule, které jsou vytvořeny z atomických formulí jen pomocí spojek $\lnot$, $\to$ a kvantifikátoru $\forall$.. Axiomy predikátové logiky lze rozdělit do čtyř skupin.

\subsection{Schémata výrokových axiomů}

Jsou-li $\varphi, \psi, \eta$ formule jazyka $L$, pak
\begin{eqnarray*}
&\varphi \to (\psi \to \varphi) & \\
&(\varphi \to (\psi \to \eta)) \to ((\varphi \to \psi) \to (\varphi \to \eta)) & \\
&((\lnot \psi) \to (\not \varphi)) \to (\varphi \to \psi) & 
\end{eqnarray*}
jsou axiomy predikátové logiky.

\subsection{Schéma axiomu kvantifikátoru}
Jsou-li $\varphi, \psi$ formule a je-li $x$ proměnná, která nemá volný výskyt ve formuli $\varphi$, pak
$$ (\forall x (\varphi \to \psi)) \to (\varphi \to (\forall x \psi)) $$
je axiom predikátové logiky.

\subsection{Schéma axiomu substituce}
Je-li $\varphi$ formule, $x$ proměnná a $t$ term substituovatelný za $x$ do $\varphi$, pak
$$ (\forall x \varphi) \to \varphi_x[t] $$
je axiom predikátové logiky.

Jestliže $t = x$, pak schéma axiomu substituce má tvar
$$ (\forall x \varphi) \to \varphi $$


\subsection{Schémata axiomů rovnosti}
Je-li $x$ proměnná, pak $x = x$ je axiom. Jsou-li $x_1, \dots, x_n, y_1, \dots, y_n$ proměnné a je-li $f$ funkční symbol s četností $n$, pak
$$(x_1 = y_1 \to (x_2 = y_2 \to ( \dots (x_n = y_n \to f(x_1, \dots, x_n) = f(y_1, \dots, y_n)) \dots ))) $$
je axiom. Jsou-li $x_1, \dots, x_n, y_1, \dots, y_n$ proměnné, je-li $p$ predikátový symbol s četností $n$, pak
$$(x_1 = y_1 \to (x_2 = y_2 \to ( \dots (x_n = y_n \to p(x_1, \dots, x_n) = p(y_1, \dots, y_n)) \dots ))) $$
je axiom.

\section{Odvozovací pravidla predikátové logiky}

\subsection{Pravidlo odloučení (modus ponens}
Z formulí $\varphi, \varphi \to \psi$ se odvodí formule $\psi$.

\subsection{Pravidlo zobecnění (generalizace)}
Pro libovolnou proměnnou $x$ se z formule $\varphi$ odvodí formule $\forall x \varphi$.

%Spolu se schématy výrokových axiomů a pravidle odloučení přechází do predikátové logiky celá výroková logika.

\section{Dokazatelnost?}
\begin{veta}
(O korektnosti) Libovolná formule jazyka $L$ dokazatelná v predikátové logice 1. řádu je logicky platnou formulí, tj. je splněna v každé realizaci jazyka L.
\end{veta}

\begin{lemma}
(Pravidlo $\forall$) Je-li $\vdash \varphi \to \psi$ a proměnná $x$ nemá volný výskyt ve $\varphi$, pak $\vdash \varphi \to (\forall x \psi)$.
\end{lemma}

\begin{lemma}
(Pravidlo $\exists$) Je-li $\vdash \varphi \to \psi$ a proměnná $x$ nemá volný výskyt ve $\psi$, pak $\vdash (\exists x \varphi) \to \psi$.
\end{lemma}

\begin{lemma}
Je-li $\varphi$ formule, $x$ proměnná, $t$ term substituovatelný za $x$ do $\varphi$, pak $\vdash \varphi_x[t] \to (\exists x \varphi)$
\end{lemma}

\begin{lemma}
Nechť $\varphi'$ je instancí formule $\varphi$, tj. nechť $\varphi'$ je tvaru $\varphi_{x_1, \dots, x_n}[t_1, \dots t_n]$ pro nějaké termy $t_1, \dots, t_n$ substituovatelné za $x_1, \dots, x_n$ do $\varphi$. Jestliže $\vdash \varphi$, pak $\vdash \varphi'$.
\end{lemma}

\subsection{Uzávěr formule}
\begin{mydef}
Jsou-li $x_1, \dots, x_n$ všechny volné proměnné ve formuli $\varphi$ v nějakém pořadí, pak formuli $(\forall x_1 \dots \forall x_n \varphi$ nazveme uzávěrem formule $\varphi$.
\end{mydef}

\begin{veta}
(O uzávěru) Je-li $T$ množina formulí a $\varphi'$ uzávěr formule $\varphi$, pak $T \vdash \varphi$ právě když $T \vdash \varphi'$.
\end{veta}

\begin{lemma}
(Distribuce kvantifikátorů) Je-li $\vdash \varphi \to \psi$, potom $\vdash (\forall x \varphi ) \to (\forall x \psi), \vdash (\exists x \varphi) \to (\exists x \psi)$.
\end{lemma}

\begin{veta}
(O dedukci) Nechť $T$ je množina formulí jazyka L, nechť $\varphi$ je uzávřená formule, $\psi$ je libovolná formule jazyka $L$. Potom $T \vdash \varphi \to \psi$, právě když $T, \varphi \vdash \psi$.
\end{veta}

\begin{veta}
(O konstantách) Nechť $T$ je množina formulí jazyka $L$, nechť $\varphi$ je formule. Nechť $x_1, \dots, x_n$ jsou proměnné a nechť $c_1, \dots, c_n$ jsou nové konstanty, jejichž přidáním k $L$ vznikne jazyk $L'$. Potom $T \vdash \varphi_{x_1, \dots x_n}[c_1, \dots, c_n]$, právě když $T \vdash \varphi$.
\end{veta}

\begin{lemma}
Je-li $L$ jazyk s rovností, pak

$$ \vdash x = y \to y = x $$
$$ \vdash x = y \to (y = z \to x = z) $$
\end{lemma}

\begin{lemma}
Je-li $f$ funkční symbol četnosti $n$, je-li $p$ predikátová symbol četnosti $m$ a jsou-li $u$, $v$, $w$, $s_1, \dots, s_n$, $t_1, \dots, t_n$ termy jazyka $L$, pak
\begin{enumerate}[(i)]
	\item $\vdash u = u $
	\item $\vdash u = v \to v = u $
	\item $\vdash u = v \to (v = w \to u = w) $
	\item $\vdash s_1 = t_1 \to (s_2 = t_2 \to \dots (s_n = t_n \to f(s_1, \dots, s_n) = f(t_1, \dots, t_n)) \dots ) $
	\item $\vdash s_1 = t_1 \to (s_2 = t_2 \to \dots (s_n = t_n \to p(s_1, \dots, s_n) = p(t_1, \dots, t_n)) \dots ) $
\end{enumerate}
\end{lemma}

\section{Prenexní tvar formulí}
Základní tvar formulí.

\begin{comment}
\begin{lemma}
Buď $i_1, \dots, i_n$ libovolná permutace čísel $\{1, \dots, n\}$. Nechť $x_1, \dots, x_n$ jsou proměnné a $A$ formule predikátové logiky. Pak platí:
\begin{enumerate}
	\item $\vdash (\forall x_1) \dots (\forall x_n) A \leftrightarrow (\forall x_{i_1}) \dots (\forall x_{i_n}) A $
	\item $\vdash (\exists x_1) \dots (\exists x_n) A \leftrightarrow (\exists x_{i_1}) \dots (\exists x_{i_n}) A $
\end{enumerate}
\end{lemma}

\begin{veta}
Buď $A$ formule taková, že proměnné $x_1, \dots x_n$ jsou jediné proměnné s volným výskytem v $A$. Pak $\vdash A$, právě když $\vdash \forall x_1 \dots \forall x_n A$
\end{veta}

\begin{veta}
(O ekvivalenci) Nechť formule $A'$ vznikne s formule $A$ nahrazením některých výskytů podformulí $B_1 \dots B_n$ pro řadě formulemi $B'_1, \dots, B'_n$. Je-li $\vdash B_i \leftrightarrow B'_i$ pro všechna $i = 1, \dots, n$, pak platí $\vdash A \leftrightarrow A'$.
\end{veta}

\begin{veta}
Buďte $A, B$ formule a $x$ proměnná. Pak

$$ \vdash (\exists x) \lnot A \leftrightarrow \lnot (\forall x) A $$
$$ \vdash (\forall x) \lnot A \leftrightarrow \lnot (\exists x) A $$

Jestliže $x$ není volná ve formuli $A$ a $\circ$ značí některou z výrokových spojek $\land, \lor, \to$, pak platí

$$ \vdash \forall x (A \circ B) \leftrightarrow (A \circ \forall x B) $$
$$ \vdash \exists x (A \circ B) \leftrightarrow (A \circ \exists x B) $$

pro opačnou implikaci $B \to A$ platí:

$$ \vdash \forall x (B \to A) \leftrightarrow (\exists x B \to A)$$
$$ \vdash \exists x (B \to A) \leftrightarrow (\forall x B \to A)$$
\end{veta}
\end{comment}

\begin{mydef}
Nechť $A$ je formule predikátové logiky. Formule $A'$ je \emph{variantou} formule $A$, jestliže vznikne z $A$ postupným nahrazením podformulí tvaru $(Qx) B$ podformulemi $(Q y) B_x[y]$, kde $Q$ je obecný nebo existenční kvantifikátor a $y$ je proměnná, která není volná v $B$.
\end{mydef}

Důsledek: Je-li $A'$ variantou formule $A$, pak je dokazatelné, že obě formule jsou ekvivalentní: $\vdash A \leftrightarrow A'$

\begin{mydef}
Formule $A$ je v \emph{prenexním tvaru}, jestliže má tvar $Q_1 x_1 \dots Q_n x_n B$, kde
\begin{enumerate}[(i)]
	\item $n \geq 0$ a pro každé $i = 1, \dots n$ je $Q_i$ buď $\forall$ nebo $\exists$,
	\item $x_i, \dots, x_n$  jsou navzájem různé proměnné,
	\item $B$ je otevřená formule (neobsahuje kvantifikátory).
\end{enumerate}
\end{mydef}

\begin{veta}
Ke každé formuli $A$ lze sestrojit formuli $A'$ v prenexním tvaru tak, že $\vdash A \leftrightarrow A'$.
\end{veta}

\subsection{Převedení formule na prenexní tvar}
\begin{description}
	\item[Vyloučení zbytečných kvantifikátorů] vynecháme všechny kvantifikátory $\forall x$, resp. $\exists x$ v podformulích tvaru $\forall x B$ nebo $\exists x B$, pokud se proměnná $x$ nevyskytuje volně v $B$.

	\item[Přejmenování proměnných] Vyhledáme podformuli $Q x A$ nejvíce vlevo takovou, že proměnná $x$ se vyskytuje volně v $A$. Pokud $x$ má ještě další výskyt ve výchozí formuli, nahradíme podformuli $Q x A$ její variantou $Q x' A'$, kde $x'$ je proměnná různá od všech proměnných vyskytujících se v převáděné formuli. Tento proces opakujeme do té doby, až všechny kvantifikátory mají různé proměnné a žádná proměnná není v získané formule současně volná i vázaná (formule s čistými proměnnými).

	\item[Eliminace spojky $\leftrightarrow$] provede se podle následujícího schématu:
	$$ A \leftrightarrow B \dots (A \to B) \land (B \to A)$$

	\item[Přesun negace dovnitř] - provádíme postupně náhrady podformulí podle schémat
	\begin{eqnarray*}
	& \lnot (\forall x A)	\dots \exists x \lnot A & \\
	& \lnot (\exists x A)	\dots \forall x \lnot A & \\
	& \lnot (A \to B)		\dots A \land \lnot B & \\
	& \lnot (A \lor B)	\dots \lnot A \land \lnot B & \\
	& \lnot (A \land B)	\dots \lnot A \lor \lnot B & \\
	& \lnot (\lnot A )	\dots A &
	\end{eqnarray*}

	\item[Přesun kvantifikátoru doleva] pro podformuli $B$, ve které se nevyskytuje proměnná $x$, provádíme náhrady podle schémat
	\begin{eqnarray*}
	& (QxA) \lor B	\dots Qx(A \lor B) &\\
	& (QxA) \land B	\dots Qx(A \land B) &\\
	& (QxA) \to B		\dots \bar{Q}x(A \to B) &\\
	& B \to (QxA)		\dots Qx(B \to A) &\\
	& (\exists x A) \lor (\exists y B) 	\dots \exists x (A \lor B_y[x]) &\\
	& (\forall x A) \land (\forall y B) 	\dots \forall x (A \land B_y[x]) &
	\end{eqnarray*}
	kde $\bar{Q}$ je kvantifikátor "opačný" ke $Q$. N+kde lze snížit počet kvantifikátorů pomocí schémat
\end{description}

\section{Věta o úplnosti}

\begin{mydef}
Je-li $L$ jazyk 1. řádu a $T$ množina formulí jazyka $L$, říkáme, že $T$ je \emph{teorie 1. řádu} s jazykem L.
\end{mydef}

\begin{mydef}
Říkáme, že teorie je \emph{sporná}, jestliže pro každou formuli $\varphi$ jazyka $L$ platí $T \vdash \varphi$. V opačném případě je teorie \emph{bezesporná}.
\end{mydef}
(tedy platí $T \vdash \varphi$ a zároveň $T \vdash \lnot \varphi$)

Důsledek: Nechť $T$ je množina formulí a nechť $\varphi'$ je uzávěr formule $\varphi$. Potom $T \vdash \varphi$, právě když $T \cup \{\lnot \varphi'\}$ je sporná teorie.

\subsection{Model a důsledek teorie}

\begin{mydef}
Buď $T$ teorie s jazykem $L$ a nechť $\mathcal{M}$ je nějaká realizace jazyka $L$. Řekněme, že $\mathcal{M}$ je model teorie $T$, jestliže $\mathcal{M} \models \varphi$ pro každou formuli $\varphi \in T$. Pak píšeme $\mathcal{M} \models T$.
\end{mydef}

\begin{mydef}
Řekneme, že formule $\varphi$ je \emph{důsledkem teorie $T$}, jestliže pro každý model teorie $\mathcal{M}$ teorie $T$ je $\mathcal{M} \models \varphi$. Pak píšeme $T \models \varphi$.
\end{mydef}

\begin{veta}
(O korektnosti) Je-li teorie s jazykem $L$ a $\varphi$ formule taková, že $T \vdash \varphi$, pak $T \models \varphi$.
\end{veta}

Důsledek: Má-li teorie $T$ s jazykem $L$ nějaký model, potom je bezesporná.

\begin{veta}
(Gödelova věta o úplnosti) Je-li $T$ teorie s jazykem $L$ a je-li $\varphi$ libovolná formule jazyka $L$, pak $T \vdash \varphi$ právě když $T \models \varphi$.
\end{veta}

\begin{veta}
(Gödelova věta o úplnosti) Teorie $T$ je bezesporná, právě když má nějaký model.
\end{veta}

\begin{mydef}
Řekneme, že teorie $T$ s jazykem L je \emph{úplná}, jestliže $T$ je bezesporná a pro každou uzavřenou formuli $\varphi$ platí $T \vdash \varphi$ nebo $T \vdash \lnot \varphi$ (v důsledku bezespornosti nemůže platit $T \vdash \varphi$ i $T \vdash \lnot \varphi$ současně), V opačném případě říkáme, že $T$ je \emph{neúplná}.
\end{mydef}

\begin{mydef}
Řekneme, že teorie $T$ s jazykem $L$ je \emph{Henkinova}, jestliže pro libovolnou uzavřenou formuli tvaru $\exists x \psi$ jazyka $L$ existuje konstanta $c$ jazyka $L$ taková, že $T \vdash (\exists x \psi) \to \psi_x[x]$.
\end{mydef}

\begin{lemma}
Libovolná Henkinova teorie má model.
\end{lemma}

\begin{mydef}
Jazyk $L'$ je rozšířením jazyka $L$ jestliže každý speciální symbol jazyka $L$ je obsažen v jazyce $L'$. Teorie $T'$ jazyka $L'$ je rozšířením teorie $T$ jazyka $L$, jestliže pro libovolnou formuli $\varphi$ jazyka $L$ takovou, že $T \vdash \varphi$, je také $T' \vdash \varphi$. Teorie $T'$ je konzervativním rozšířením teorie $T$, jestliže  navíc pro každou formuli $\psi$ jazyka $L$ takovou, že $T' \vdash \psi$, je již $T \vdash \psi$.
\end{mydef}

\begin{lemma}
(Heinkin) K libovolné teorii lze sestrojit Heinkinovu teorii $T_H$, která je konzervativním rozšířením teorie $T$.
\end{lemma}

\begin{lemma}
Teorie $T$ je bezesporná, právě když každá její konečná podmnožina $Q \subseteq T$ je bezesporná.
\end{lemma}

\begin{veta}
(Lindenbaum) Je-li $T$ bezesporná teorie s jazykem $L$, pak existuje rozšíření $T'$ teorie $T$ se stejným jazykem $L$.
\end{veta}

\section{Věta o kompaktnosti a věta Herbrandova}

\begin{veta}
(O kompaktnosti) Nechť $T$ je množina formulí jazyka $L$. Pak teorie $T$ má nějaký model, právě když každá její konečná podmnožina $Q \subseteq T$ má model.
\end{veta}

\begin{veta}
(Löwenheim,Skolem) Má-li teorie $T$ s jazykem $L$ nekonečný model, pak má model libovolné mohutnosti $n \geq max\{\aleph_0, |L|\}$
\end{veta}

Is there more?





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Algebraické struktury} \label{cha:8}

1. semestr, MAT, \texttt{Zaklady\_obecne\_algebry.pdf}, 1. kapitola?

(grupy, okruhy, obory integrity a tělesa, svazy a Boolovy algebry, univerzální algebry)

\section{Operace a zákony}

\begin{mydef}
Buď $A$ množina, $n \in \mathbb{N}_0$. Potom zobrazení $\omega : A^n \to A$ se nazývá n-ární operace na $A$. Tedy pro $n \in \mathbb{N}$:

$$ \omega : A^n \to A $$
$$ \omega : (x_1, \dots, x_n) \to \omega x_1 \dots x_n$$
\end{mydef}

\begin{mydef}
Buď $A$ množina, $n \in \mathbb{N}_0, D \subseteq A^n$. Potom zobrazení $\omega : D \to A$ se nazývá n-ární parciální operace na $A$.
\end{mydef}

\begin{mydef}
Buď $A$ množina $I$ množina (indexů). Pro $i \in I$ buď $\omega_i$ n-ární operace na $A$, $n_i \in \mathbb{N}$. Potom $\mathcal{A} := (A, (\omega_i)_{i \in I}$ označujeme (univerzální) algebru s nosnou množinou $A$ a souborem operací $(\omega_i)_{i \in I} =: \Omega$.
\end{mydef}

\begin{mydef}
Buď $A$ množina, $\circ$ binární operace na $A$. Prvek $e \in A$ se nazývá
a) \emph{levý neutrální prvek} vzhledem k $\circ: \Leftrightarrow x \in A : e \circ x = x$,
b) \emph{pravý neutrální prvek} vzhledem k $\circ: \Leftrightarrow x \in A : x \circ e = x$,
c) \emph{neutrální prvek} vzhledem k $\circ: \Leftrightarrow x \in A : e \circ x = x \circ e = x$
\end{mydef}

\begin{veta}
Buď $\circ$ binární operace na $A$, $e_1$ levý neutrální prvek a $e_2$ pravý neutrální prvek. Potom platí: $e_1 = e_2$ a $e_1 (= e_2)$ je neutrální prvek.
\end{veta}
Existuje nanejvýše jeden neutrální prvek.

\begin{mydef}
Buď $A$ množina $\circ$ binární operace, $e$ neutrální prvek, $x \in A$. Potom nazýváme prvek $y \in A$
a) \emph{levým inverzním prvkem} k $x: \Leftrightarrow y \circ x = e$
b) \emph{pravým inverzním prvkem} k $x: \Leftrightarrow x \circ y = e$
c) \emph{inverzním prvkem} k $x: \Leftrightarrow x \circ y = y \circ x = e$
\end{mydef}

\begin{mydef}
Prvek $x$ se nazývá invertibilní: $\Leftrightarrow$ existuje inverzní prvek k $x$.
\end{mydef}

\begin{mydef}
Buď $A$ množina, $\circ$ binární operace na $A$. $\circ$ se nazývá \emph{asociativní}: $\Leftrightarrow \forall x,y,z \in A: (x \circ y) \circ = x \circ (y \circ z)$ (asociativní zákon). 
\end{mydef}

\begin{veta}
Buď $\circ$ \textbf{asociativní} binární operace na $A$, $x \in A$, $y_1$ levý inverzní prvek k $x$, $y_2$ pravý inverzní prvek k $x$. Potom platí $y_1 = y_2$.
\end{veta}

Je-li operace asociativní, existuje ke každému prvku nejvýše jeden inverzní prvek.

\begin{mydef}
Binární operace $\circ$ se nazývá operace s dělením na $A$: $\Leftrightarrow \forall (a,b) \in A^2 \exists (x,y) \in A^2: a \circ x = b$ (levý zákon o dělení) $\land y \circ a = b$ (pravý zákon o dělení).
\end{mydef}

\begin{veta}
Buď $A \not= \emptyset$ a $\circ$ asociativní binární operace na $A$. Potom jsou následující tvrzení ekvivalentní:
\begin{enumerate}[a)]
	\item $\circ$ je operace s dělením na $A$
	\item Existuje neutrální prvek $e$ (vzhledem k $\circ$) a každý prvek $x \in A$ je invertibilní, tzn. $\exists y \in A: x \circ y = y \circ x = e$.
\end{enumerate}
\end{veta}

\begin{mydef}
Binární operace $\circ$ na $A$ se nazývá operace s krácením: $\Leftrightarrow \forall a, x_1, x_2, y_1, y_2 \in A: (a \circ x_1 = a \circ x_2 \Rightarrow x_1 = x_2)$ (levý zákon o krácení) $\land (y_1 \circ a = y_2 \circ a \Rightarrow y_1 = y_2$ (pravý zákon o krácení).
\end{mydef}

\begin{mydef}
Binární operace $\circ$ na $A$ se nazývá komutativní: $\Leftrightarrow \forall x,y \in A: x \circ y = y \circ x$ (komutativní zákon).
\end{mydef}

\begin{mydef}
Pokud jsou $+, \cdot$ binární operace na $A$, potom se $\cdot$ nazývá distributivní nad $+$: $\Leftrightarrow \forall x,y,z \in A: x \cdot (y + z) = x \cdot y + x \cdot z$ (levý komutativní zákon) $\land (y + z) \cdot x = y \cdot x + z \cdot x$ (pravý komutativní zákon).
\end{mydef}

\section{Důležité typy algeber}
\begin{mydef}
Algebra $(A, \cdot)$ typu (2) se nazývá \emph{grupoid}.
\end{mydef}

\begin{mydef}
Grupoid $(H, \cdot)$ se nazývá \emph{pologrupa}: $\Leftrightarrow \cdot$ je asociativní.
\end{mydef}

\begin{mydef}
\begin{enumerate}[a)]
	\item Pologrupa $(H, \cdot)$ se nazývá \emph{monoid} typu (2): $\Leftrightarrow$ existuje neutrální prvek $e$.
	\item Algebra $(H, \cdot, e)$ typu (2,0) se nazývá \emph{monoid} typu (2, 0): $\Leftrightarrow$ platí následující zákony pro všechna $x,y,z \in H$:
	\begin{enumerate}[1)]
		\item $x(yz) = (xy)z$
		\item $ex = x$, $xe = x$
	\end{enumerate}
\end{enumerate}
\end{mydef}

\begin{mydef}
\begin{enumerate}[a)]
	\item Monoid $(G, \circ)$ s neutrálním prvkem $e$ se nazývá \emph{grupa} typu (2): $\Leftrightarrow$ každý prvek $x \in G$ je invertibilní, tj., $\forall x \in G \exists x^{-1} \in G: x x^{-1} = x^{-1} x = e$.
	\item Algebra $(G, \cdot, e, ^{-1}$ typu (2, 0, 1) se nazývá \emph{grupa} typu (2, 0, 1): $\Leftrightarrow$ platí následující zákony pro všechna $x, y, z \in G$:
	\begin{enumerate}[1)]
		\item $x(yz) = (xy)z$
		\item $ex = x$, $xe = x$
		\item $x x^{-1} = e$, $x^{-1} x = e$
	\end{enumerate}
	\item Grupa $(G, \cdot)$, resp. $(G, \cdot, e, ^{-1})$ se nazývá \emph{komutativní nebo abelovská}ů $\Leftrightarrow \forall x,y \in G: xy = yx$.
\end{enumerate}
\end{mydef}

\begin{mydef}
\begin{enumerate}[a)]
	\item Algebra $(R, +, \cdot)$ typu (2, 2) se nazývá \emph{okruh} typu (2, 2): $\Leftrightarrow$
	\begin{enumerate}[1)]
		\item $(R, +)$ je abelovská grupa
		\item $(R, \cdot)$ je pologrupa
		\item $\cdot$ je distributivní nad $+$
	\end{enumerate}
	\item Algebra $(R, +, 0, -, \cdot)$ typu (2, 0, 1, 2) se nazývá \emph{okruh} typu (2, 0, 1, 2): $\Leftrightarrow$
		\begin{enumerate}[1)]
		\item $(R, +, 0, -)$ je abelovská grupa
		\item $(R, \cdot)$ je pologrupa
		\item $\cdot$ je distributivní nad $+$
	\end{enumerate}
	Prvek $0$ se nazývá "nulový prvek" okruhu. Budeme psát $x - y:= x + (-y)$
\end{enumerate}
\end{mydef}

\begin{mydef}
\begin{enumerate}[a)]
	\item Algebra $(R, +, 0, -, \cdot, 1)$ typu (2, 0, 1, 2, 0) se nazývá \emph{okruh s jednotkovým prvkem}: $\Leftrightarrow$
	\begin{enumerate}[1)]
		\item $(R, +, 0, -, \cdot)$ je okruh
		\item $1$ je neutrální prvek vzhledem k $\cdot$, tj. $\forall x \in R: 1 \cdot x = x \cdot 1 = x$ (1 se nazývá \emph{jednotkový prvek} okruhu).
	\end{enumerate}
	\item Okruh $(R, +, 0, -, \cdot)$ se nazývá \emph{komutativní}: $\Leftrightarrow \forall x ,y \in R: xy = yx$
	\item Algebra $(R, +, 0, -, \cdot, 1)$ se nazývá \emph{komutativní okruh s jednotkovým prvkem}: $\Leftrightarrow$
		\begin{enumerate}[1)]
		\item $(R, +, 0, -, \cdot)$ je komutativní okruh
		\item $1$ je neutrální prvek vzhledem k $\cdot$.
	\end{enumerate}
\end{enumerate}
\end{mydef}

\begin{mydef}
Komutativní okruh s jednotkovým prvkem $(R, +, 0, -, \cdot, 1)$ se nazývá \emph{obor integrity}: $\Leftrightarrow$
\begin{enumerate}
	\item $R \backslash \{0\} \not= \emptyset$ (tj. $0 \not= 1$
	\item $\forall x,y \in R: x \not= 0 \land y \not= 0 \Rightarrow xy \not= 0$ (tj. neexistují dělitelé nuly).
\end{enumerate}
$\cdot$ je operace s krácením na $R \backslash \{0\}$.
$(R \backslash \{0\}, \cdot, 1)$ je komutativní monoid.
\end{mydef}

\begin{mydef}
\begin{enumerate}[a)]
	\item Okruh s jednotkovým prvkem $(R, +, 0, -, \cdot, 1)$ se nazývá těleso: $\Leftrightarrow$
	\begin{enumerate}[1)]
		\item $0 \not= 1$
		\item $(R \backslash \{0\}, \cdot)$ je grupa
	\end{enumerate}
	\item Komutativní těleso se nazývá \emph{pole}.
\end{enumerate}
\end{mydef}

\begin{veta}
Každé \emph{pole} je \emph{obor integrity}. Každý konečný obor integrity je pole.
\end{veta}

\begin{mydef}
Buď $(K, +, 0, -, \cdot, 1)$ pole, $I = \{a, b, c\} \cup K$, kde $a,b,c \not\in K$, $a,b,c$ po dvou různé. Algebra $(V, (\omega_i)_{i \in I}$ typu $(2, 0, 1, (1)_{\lambda \in K})$ se nazývá vektorový prostor nad $K$: $\Leftrightarrow$
\begin{enumerate}[1)]
	\item $(V, \omega_a, \omega_b, \omega_c) =: (V, +, 0, -)$ je abelovská grupa,
	\item $\forall x,y \in V, \lambda, \mu \in K$:\\
	$$\omega_\lambda(x + y) = \omega_\lambda(x) + \omega_\lambda(y) $$
	$$\omega_{\lambda + \mu}(x) = \omega_\lambda(x) + \omega_\mu(x) $$
	$$\omega_{\lambda \mu}(x) = \omega_\lambda( \omega_\mu(x)) $$
	$$\omega_1(x) = x $$
\end{enumerate}
\end{mydef}

\begin{mydef}
Algebra $(V, \cap, \cup)$ typu $(2, 2)$ se nazývá \emph{svaz}: $\Leftrightarrow$ pro všechna $a,b,c \in V$ platí:
\begin{enumerate}[1)]
	\item $a \cap b = b \cap a$,
		$a \cup b = b \cup a$
	\item $a \cap (b \cap c) = (a \cap b) \cap c$,
		$a \cup (b \cup c) = (a \cup b) \cup c$
	\item $a \cap (a \cup b) = a$,
		$a \cup (a \cap b) = a$
\end{enumerate}
Podle 1) a 2) jsou $\cap$, $\cup$ komutativní a asociativní, tj. $(V, \cap)$, $(V, \cup)$ jsou komutativní pologrupy. Zákony uvedení v bodě 3) se nazývají absorpční zákony.

$(V, \cap, \cup)$ je svaz $\Leftrightarrow$ $(V, \cup, \cap)$ je svaz -- princip duality pro svazy.
\end{mydef}

\begin{mydef}
Svaz $(V, \cap, \cup)$ se nazývá distributivní: $\Leftrightarrow$ pro všechna $a, b, c \in V$ platí 
\begin{enumerate}[4)]
	\item $a \cap (b \cup c) = (a \cap b) \cup (a \cap c)$,
		$a \cup (b \cap c) = (a \cup b) \cap (a \cup c)$
\end{enumerate}
\end{mydef}

\begin{mydef}
Buď $(V, \cap, \cup)$ svaz.
Prvek $0 \in V$ se nazývá \emph{nulový prvek svazu $V$}: $\Leftrightarrow \forall a \in V: a \cup 0 = a$ (tj. 0 je neutrální vzhledem k $\cup$).
Prvek $1 \in V$ se nazývá \emph{jednotkový prvek svazu $V$}: $\Leftrightarrow \forall a \in V: 1 \cap a = a$ (tj. neutrální vzhledem k $\cap$).
\end{mydef}

\begin{mydef}
Algebra $(V, \cap, \cup, 0, 1)$ typu (2, 2, 0, 0) se nazývá \emph{ohraničený svaz}: $\Leftrightarrow$
\begin{enumerate}[1)]
	\item $(V, \cap, \cup)$ je svaz,
	\item $0$ je nulový prvek svazu $V$,
	\item $1$ je jednotkový prvek svazu $V$.
\end{enumerate}
\end{mydef}

\begin{mydef}
Ohraničený svaz $(V, \cap, \cup, 0, 1)$ se nazývá komplementární: $\Leftrightarrow \forall x \in V \exists a' \in V: a \cap a' = 0 \land a \cup a' = 1$. Prvek $a'$ se nazývá \emph{komplement} prvku $a$.
\end{mydef}

\begin{mydef}
Distributivní a komplementární svaz $(V, \cap, \cup, 0, 1)$ se nazývá Boolův svaz.
\end{mydef}

\begin{veta}
Je-li $(V, \cap, \cup, 0, 1)$ Booleův svaz, pak existuje ke každému $a \in V$ přesně jeden komplement $a'$.
\end{veta}

\begin{mydef}
Algebra $(B, \cap, \cup, 0, 1, ')$ typu (2, 2, 0, 0, 1) se nazývá Booleova algebra: $\Leftrightarrow$
\begin{enumerate}[1)]
	\item $(B, \cap, \cup, 0, 1)$ je ohraničený svaz
	\item $\forall a \in B: a \cap a' = 0 \land a \cup a' = 1$.
\end{enumerate}
\end{mydef}

\subsection{Strom algeber}
\begin{itemize}
\item Booleův svaz
 \begin{itemize}
 \item Distributivní svaz
  \begin{itemize}
  \item Svaz $(V, \cap, \cup)$
   \begin{itemize}
   \item $(V, \cap)$, $(V, \cup)$ jsou komutativní pologrupy (komutativní a asociativní zákony)
   \item Absorpční zákony
   \end{itemize}
  \item Distributivní zákony
  \end{itemize}
 \item Komplementární svaz
  \begin{itemize}
  \item Ohraničený svaz
   \begin{itemize}
   \item Svaz $(V, \cap, \cup)$
   \item $0$ je nulový prvek svazu $V$
   \item $1$ je jednotkový prvek svazu $V$
   \end{itemize}
  \item Komplement $'$
  \end{itemize}
 \end{itemize}
\item Vektorový prostor nad $K$
 \begin{itemize}
 \item Pole $(K, +, 0, -, \cdot, 1)$
 \item Abelovská grupa: $(V, \omega_a, \omega_b, \omega_c) = (V, +, 0, -)$ je 
 \item ??? zákony
 \end{itemize}
\item Pole
 \begin{itemize}
 \item Konečný
 \item Obor Integrity
  \begin{itemize}
  \item Komutativní okruh s jednotkovým prvkem
   \begin{itemize}
   \item $(R, +, 0, -)$ je komutativní okruh
   \item 1 je neutrální prvek vzhledem k $\cdot$
   \end{itemize}
  \item $1 \not= 0$
  \item neexistují dělitelé nuly
  \end{itemize}
 \end{itemize}
\item Pole
 \begin{itemize}
 \item Komutativní
 \item Těleso
  \begin{itemize}
  \item Okruh s jednotkovým prvkem
   \begin{itemize}
   \item $(R, +, 0, -, \cdot)$ je okruh typu $(2, 0, 1, 2)$ nebo $(R, +, \cdot)$
    \begin{enumerate}
    \item $(R, +, 0, -)$ je abelovská grupa nebo $(R, +)$
     \begin{enumerate}
     \item \textbf{Grupa} $(G, \cdot, e, ^{-1})$ nebo $(G, \circ)$
     \item Komutativní zákony
     \end{enumerate}
    \item $(R, \cdot)$ je pologrupa
    \item $\cdot$ je distributivní nad $+$
    \end{enumerate}
   \item $1$ je neutrální prvek vzhledem k $\cdot$
   \end{itemize}
  \item $0 \not= 1$
  \item $(R \backslash \{0\}, \cdot)$ je grupa
  \end{itemize}
 \end{itemize}

\item Grupa
      \begin{itemize}
      \item Monoid
       \begin{itemize}
       \item Pologrupa $(H, \cdot)$, $(H, \cdot, e)$
        \begin{itemize}
        \item Grupoid
         \begin{enumerate}
		 \item Algebra $(A, \cdot)$ typu 2
		 \end{enumerate}
        \item $\cdot$ asociativní
        \end{itemize}
       \item neutrální prvek
       \item x(yz) = (xy)z
       \end{itemize}
      \item x(yz) = (xy)z
      \item neutrální prvek
      \item každý prvek je invertibilní
      \end{itemize}
\end{itemize}

\section{Základní pojmy teorie grup}

\paragraph{Grupoid}
Součin: $a_1, a \dots a_n := (a_1 \dots a_{n-1})a_n$

Mocniny: $a^1 = a$, $a^{n+1} = (a^n)a$

\paragraph{Grupa}
$(ab)^{-1} = b^{-1}a^{-1}$

$a^0 = e$;
$a^{-n} = (a^{-1})^n$;
$a^n a^m = a^{n+m}$;
$(a^m)^n = a^{mn}$;
$(a b)^n = a^n b^n$ (pokud je $\cdot$ komutativní)

Kardinální číslo ($a^n$) se nazává \emph{řád prvku}: $o(a) := |\{a^0 = e, a^1, a^{-1}, a^2, a^{-2}, \dots\}| = |\{ a^k | k \in Z\}$.

$|G|$ (mohutnost množiny) se nazývá řád grupy/algebry.

Dělení se zbytkem: $\forall k,l \in Z, l \not= 0 \exists q,r \in Z: 0 \leq  r < |l| \land k = lq + r$.

"$r$ je kongruentní s $s$ modulo $n$": $n|(r - s)$ ($n$ dělí $(r-s)$).

Je-li $o(a) = \infty$, pak jsou mocniny prvku $a$ navzájem různé. Je-li $o(a) = n$, potom $a^r = a^s \Leftrightarrow r \equiv s \text{ mod } n$



\section{Svazy a Booeovy algebry}
\subsection{(Částečně uspořádané množiny)}

$M$ je množina, $R$ je relace na $M$. 

Částečné uspořádání $(M, R)$ = reflexivita, antisymetrie, tranzitivita.

$(M, R)$ Řetězec nebo Lineárně uspořádaná množina: navíc srovnatelnost: $\forall x,y \in M: xRy \lor yRx$.

\begin{mydef}
Buď $(M, \leq)$ uspořádaná množina. Potom se $k \in M$ nazývá nejmenší (resp. největší) prvek množiny $M :\Leftrightarrow \forall x \in M: k \leq x$ (resp. $k \geq x$).
\end{mydef}

Existuje vždy nejvýše jeden nejmenší resp. největší prvek.

\begin{mydef}
Buď $(M, \leq)$ uspořádaná množina. Potom se $m \in M$ nazývá minimální (resp. maximální) prvek množiny $M :\Leftrightarrow \forall x \in M: x \leq m$ (resp. $x \geq m$) $\Rightarrow x = m$.
\end{mydef}

\begin{veta}
\begin{enumerate}[a)]
	\item Buď $(M, \leq)$ uspořádaná množina a $N \subseteq M$. Potom je $(N, \leq)$ rovněž uspořádaná množina. Je-li $(M, \leq)$ řetězec, potom je také $(N, \leq)$ řetězec. Přitom $(N, \leq)$ zkráceně označuje $(N, \leq \cap (N \times N))$.
	\item Je-li $(M, \leq)$ uspořádaná množina, potom také $(M, \geq)$ je uspořádaná množina (tzv. \uv{princip duality uspořádané množiny}). Také maximální a minimální prvek.
\end{enumerate}
\end{veta}

\begin{mydef}
Buď $(M, \leq)$ uspořádaná množina a $N \subseteq M$. Potom se nazývá $u \in M$ dolní závora množiny $N : \Leftrightarrow \forall x \in N: u \leq x$. Největší prvek množiny všech dolních závor se nazývá \emph{infimum} množiny $N$, formálně inf $N$ nebo $\bigcap N$. Prvek $v \in M$ se nazývá horní závora množiny $N: \Leftrightarrow \forall x \in N: x \in N: x \leq v$. Nejmenší horní závora se nazývá suprémum množiny $N$, formálně sup $N$ nebo $\bigcup N$.
\end{mydef}

\paragraph{Hasseův diagram} Buď $(M, \leq)$ konečná uspořádaná množina a nechť relace "sousední" je definována takto:

a, b sousedí: $\Leftrightarrow \begin{cases}
a < b \text{ nebo } b < a \\
\text{ neexistuje c taková, že } a < c < b \text{ nebo } b < c < a
\end{cases}$

Potom je Hasseův diagram $(M, \leq)$ dán grafy relace \uv{sousedí}. (Množina uzlů je M; je-li $a < b$, nakreslí se uzel $a$ \uv{níže} než uzel $b$ a $a$ se spojí s $b$ hranou, pokud jsou $a$ a $b$ sousední).

\subsection{(Částečná) uspořádaní a svazy}
\begin{mydef}
Buď $(V, \leq)$ uspořádaná množina. $(V, \leq)$ se nazývá svazově uspořádaná: $\Leftrightarrow sup\{a, b\}$ a $inf\{a, b\}$ existují pro všechna $a, b \in V$.
\end{mydef}

\begin{lemma}
Buď $(V, \cap, \cup)$ svaz, potom platí:
\begin{enumerate}[a)]
	\item $\forall a \in V: a \cap a = a = a \cup a$
	\item $\forall a, b \in V: a \cap b = a \Leftrightarrow a \cup b = b$
\end{enumerate}
\end{lemma}

\begin{veta}
\begin{enumerate}
	\item Buď $(V, \cap, \cup)$ svaz. Pokud definujeme relaci $\leq$ na $V$ pomocí vztahu $a \leq b: \Leftrightarrow a \cap b = a, a,b \in B$, potom je $(V, \leq)$ svazově uspořádaná množina.
	\item Buď $(V, \leq)$ svazově uspořádaná množina. Definujeme-li na $V$ binární operace $\cap, \cup$ pomocí vztahů $a \cap b := inf\{a, b\}$ a $a \cap b := sup\{a, b\}, a, b \in V$, potom je $(V, \cap, \cup)$ svaz.
	\item Přiřazení definovaná v a) a b) jsou navzájem inverzní.
\end{enumerate}
\end{veta}

Princip duality pro svazy:

$(V, \cap, \cup)$ svaz $\Leftrightarrow (V, \cup, \cap)$ svaz

$(V, \leq)$ svazově uspořádaný $\Leftrightarrow (V, \geq)$ svazově uspořádaný

\subsection{Booleovy algebry}

Dualita: $(B, \cap, \cup, 0, 1, ')$ Booleova algebra $\Leftrightarrow (B, \cup, \cap, 1, 0, ')$ Booleova algebra

\begin{lemma}
Buď $(V, \cap, \cup)$ svaz. Potom platí:
\begin{enumerate}[a)]
	\item $\forall a,b,c \in V: a \cap (b \cup c) = (a \cap b) \cup (a \cap c) \Leftrightarrow \forall a, b, c \in V: a \cup (b \cap c) = (a \cup b) \cap (a \cup c)$
	\item $\forall a \in V: 0 \cup a = a \Leftrightarrow \forall a \in V: 0 \cap a = 0$
	\item $\forall a \in V: 1 \cap a = a \Leftrightarrow \forall a \in V: 1 \cup a = 1$
\end{enumerate}
\end{lemma}

\begin{veta}
(Věta o komplementech) Buď $(B, \cap, \cup, 0, 1, ')$ Booleova algebra. Potom platí:
\begin{enumerate}[a)]
	\item Jsou-li $a, a^*$ prvky množiny $B$, kde $a \cup a^* = 1$ a $a \cap a^* = 0$, pak platí $a^* = a'$
	\item $(a')' = a$ pro všechna $a \in B$
	\item $0' = 1$ a $1' = 0$
	\item $(a \cup b)' = a' \cap b'$ a $(a \cap b) = a' \cup b'$ pro všechna $a, b \in B$ (De Morganovy zákony)
\end{enumerate}
\end{veta}

\begin{veta}
(Věta o homomorfizmech) Buďte $(B, \cap, \cup, 0, 1, ')$ a $(C, \cap, \cup, 0, 1, ')$ Booleovy algebry, $\varphi: B \to C$ surjektivní zobrazení. Potom platí $\varphi$ je homomorfizmus $(B, \cap, \cup, 0, 1, ')$ do $(C, \cap, \cup, 0, 1, ') \Leftrightarrow \varphi$ je homomorfizmus $(B, \cap, \cup)$ do $(C, \cap, \cup)$ (tj. stačí aby $\varphi$ bylo konzistentní se svazovými operacemi).
\end{veta}

\subsection{Stoneova věta o reprezentaci}
\begin{mydef}
Buď $(V, \cap, \cup, 0, 1)$ svaz s nulovým a jednotkovým prvkem. Potom se $a \in V$ nazývá \emph{atom}: $\Leftrightarrow$
\begin{enumerate}[1)]
	\item $0 < a$
	\item $0 \leq b \leq a \Rightarrow b = 0 \lor b = a$
\end{enumerate}
(tj. $a$ je horním sousedním prvkem nulového prvku.)
\end{mydef}

\begin{lemma}
Buď $(B, \cap, \cup, 0, 1, ')$ konečná Booleova algebra. Potom ke každému prvku $b \in B \backslash \{0\}$ existuje atom $a \in B$, kde $a \leq b$. (Toto platí i pro libovolní konečné svazy.).
\end{lemma}

\begin{veta}
(Stoneova věta) Buď $(B, \cap, \cup, 0, 1, ')$ konečná Booleova algebra a $M := \{a \in B | a \text{atom algebry} \}$. Potom platí:

$$ (B, \cap, \cup, 0, 1, ') \cong (\mathcal{P}(M), \cap, \cup, \emptyset, M, ')$$

přičemž  vztahem $\varphi(b) := \{a \in M | a \leq b\}$ je dán izomorfizmus $\varphi: B \to \mathcal{P}(M)$.
\end{veta}

$|M| = |M_1| \Rightarrow (\mathcal{P}(M), \cap, \cup, \emptyset, M, ') \cong (\mathcal{P}(M_1), \cap, \cup, \emptyset, M_1, ')$

$|M| = n \in \mathbb{N}_0 \Rightarrow |\mathcal{P}(M)| = 2^n$

Je-li $B$ konečná Booleova algebra, potom platí $|B| = 2^n$ pro libovolné $n \in \mathbb{N}_0$ pro libovolné $n \in \mathbb{N}_0$. Ke každému $n \in \mathbb{N}_0$ tak existuje -- až na izomorfizmus -- přesně jedna Booleova algebra s $2^n$ prvky, totiž $\mathcal{P}(\{0, 1, \dots, n-1\})$.

\begin{mydef}
Buď $M$ množina.  $\mathcal{K} \in \mathcal{P}(M)$ se nazývá množinový okruh: $\Leftrightarrow$ pro všechna $A, B \in \mathcal{K}$ platí:
\begin{enumerate}[1)]
	\item $A \cup B \in \mathcal{K}$
	\item $A \cap B \in \mathcal{K}$
	\item $A \cap B' = A \backslash B \in \mathcal{K}$
\end{enumerate}
\end{mydef}

\begin{mydef}
Buď $\mathcal{K} \in \mathcal{P}(M)$ množinový okruh a nechť $M \in \mathcal{K}$. Potom Booleova algebra $(\mathcal{K}, \cap, \cup, \emptyset, M, ')$ se nazývá algebra množinového okruhu.
\end{mydef}

Algebra množinového okruhu je tedy podalgebra $(\mathcal{P}(M), \cap, \cup, \emptyset, M, ')$

\begin{mydef}
(Stoneova věta) Každá Booleova algebra je izomorfní s nějakou algebrou množinového okruhu.
\end{mydef}

















%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Základní algebraické metody} \label{cha:9}

1. semestr, MAT, \texttt{Zaklady\_obecne\_algebry.pdf}, 2. kapitola

(podalgebry, homomorfismy, přímé součiny, kongruence a faktorové algebry, normální podgrupy a ideály okruhů)

\section{Podalgebry}

\begin{mydef}
Buď $A$ množina, $\omega: A^n \to A$ n-ární operace na $A$ ($n \in N_0)$, $T \subseteq A$. Potom se množina $T$ nazývá uzavřená vzhledem k $\omega: \Leftrightarrow \omega(T^n) \subseteq T$ (tj. $t_1, \dots, t_n \in T \Rightarrow \omega t_1 \dots t_n \in T$, v případě $n = 0: \omega \in T$.
\end{mydef}

\begin{mydef}
Buď $\mathcal{A} = (A, (\omega_i)_{i \in I}$ algebra typu $(n_i)_{i \in I}$, $T \subseteq A$. Potom se množina $T$ nazývá uzavřená vzhledem k $(\omega)_{i \in I}: \Leftrightarrow T$ je uzavřená vzhledem k $\omega_i$ pro všechna $i \in I$. V tomto případě se pomocí vztahu $\omega_i^*x_1 \dots x_{n_1}$, $(x_1, \dots x_n) \in T^{n_i}$, definuje $n_i$-ární operace $\omega_i^*$'na $T$, tj $\omega_i^* = \omega_i|T^{n_i}$. Algebra $(T, (\omega_i^*)_{i \in I}$ se nazývá podalgebra algebry $\mathcal{A}$. Většinou píšeme: $\omega_i^* =: \omega_i$.
\end{mydef}

$(\mathbb{N}, +)$ je podpologrupa $(\mathbb{Z}, +)$ (ale není grupa -- chybí inverzní prvek).

$(\mathbb{N}, +, \cdot)$ je podalgebrou $(\mathbb{Z}, +, \cdot)$ (ale není podokruhem).

$(\mathbb{R}, +, 0, -, \cdot, 1)$ je podpolem $(\mathbb{C}, +, 0, -,\cdot, 1)$ zatímco $(\mathbb{Z}, +, 0, -,\cdot, 1)$

\begin{veta}
Buď $(A, \Omega)$ algebra a $(T_j)_{j \in J}$ soubor podalgeber. Potom je $\bigcap_{\{j \in J\}} T_j$ rovněž podalgebra.
\end{veta}

\begin{veta}
Buď $(A, \Omega)$ algebra a $S \subseteq A$ podmnožina. Potom je

$$\left< S \right> := \bigcap\{T | T \supseteq S, T \text{je podalgebra algebry} (A, \Omega)\}$$

je nejmenší podalgebra algebry $(A, \Omega)$, která $S$ obsahuje.
\end{veta}

\begin{mydef}
$\left< S \right>$ se nazývá podalgebra algebry $(A, \Omega)$ generovaná množinou $S$. Množina $S$ se nazývá systém generátorů podalgebry $\left< S \right>$.
\end{mydef}

\begin{veta}
Buď $(G, \cdot, e, ^{-1})$ grupa, $x \in G, S = \{x\}$. Potom platí:

$$\left< x \right> := \left< S \right> = \{x^k | k \in \mathbb{Z}\}$$
\end{veta}

\begin{mydef}
$\left< x \right>$ se nazývá podgrupa grupy $(G, \cdot, e, ^{-1})$ generovaná prvkem $x$.
\end{mydef}

\begin{mydef}
Grupa $(G, \cdot, e, ^{-1})$ se nazývá cyklická: $\Leftrightarrow \exists x \in G: G = \left< x \right>$
\end{mydef}

\begin{itemize}
	\item pro $(\mathbb{Z}, +, 0, -)$ platí $\mathbb{Z} = \left< 1 \right> = \left< -1 \right>$
	\item pro $(\mathbb{Z}_m, +, 0, -)$ platí $\mathbb{Z}_m = \left< 1 \right> = \left< k \right>$, kde $NSD(m, k) = 1$
\end{itemize}

\subsection{Relace ekvivalence a rozklad na třídy ekvivalence?} % XXX
\begin{mydef}
Je-li $M$ množina, potom se podmnožina $R$ množiny $M \times M$ nazývá binární relace na $M$. Místo $(x, y) \in R$ píšeme většinou $xRy$. Speciální relace $\alpha_M := M \times M$ se nazývá univerzální relace, $\iota_M := \{(x, x) | x \in M\}$ se nazývá identická relace nebo relace rovnosti.
\end{mydef}

\begin{mydef}
Relace $R \subseteq M \times M$ se nazývá:
\begin{enumerate}[1)]
	\item \emph{reflexivní}: $\Leftrightarrow \iota_M \subseteq R$, tj. $\forall x \in M: xRx$
	\item \emph{symetrická}: $\Leftrightarrow \forall x, y \in M: xRy \Rightarrow yRx$
	\item \emph{antisymetrická}: $\Leftrightarrow \forall x, y \in M: xRy \land yRx \Rightarrow x = y$
	\item \emph{transitivní}: $\Leftrightarrow \forall x, y, z \in M: xRy \land yRz \Rightarrow xRz$
\end{enumerate}
Relace splňující 1), 2) a 4) se nazývá relace \emph{ekvivalence}, relace splňující 1), 3) a 4) se nazývá relace \emph{(částečného) uspořádání)}.
\end{mydef}

\begin{mydef}
Buď $M$ množina. $\mathcal{P} \subseteq \mathcal{P}(M)$ se nazývá rozklad množiny $M$ na třídy ekvivalence: $\Leftrightarrow$
\begin{enumerate}[1)]
	\item $\bigcup_{C \in \mathcal{P}} C = M$
	\item $\emptyset \not\in \mathcal{P}$
	\item $A, B \in \mathcal{P}  \Rightarrow A = B \lor A \cap B = \emptyset$ (tj. množiny v $\mathcal{P}$ jsou po dvou disjunktní.
\end{enumerate}
\end{mydef}

\begin{veta}
Buď $\pi$ relace ekvivalence na množině $M$, $a \in M$, $[a]_\pi := \{b \in M | b \pi a\}$, tzv. třída ekvivalence prvku $a$ a $M/\pi := \{[a]_\pi | a \in M\}$ tzv. faktorová množina množiny M podle ekvivalence $\pi$. Potom je $M/\pi$ rozklad množiny na třídy ekvivalence.

Je-i naopak $\mathcal{P}$ rozklad množiny $M$ na třídy ekvivalence a $\pi$ je definováno vztahem $a \pi b \Leftrightarrow \exists C \in \mathcal{P}: a, b \in C$, potom je $\pi$ relace ekvivalence na množině $M$, a platí $M/\pi' = \mathcal{P}$.

$\pi \mapsto M/\pi$ je bijektivní zobrazení množiny všech relací ekvivalence na množině M na množinu všech rozkladů množiny M na třídy ekvivalence. Inverzní zobrazení je dáno výše uvedeným předpisem $\mathcal{P} \mapsto \pi$.
\end{veta}

\begin{veta}
Buďte $M, N$ množiny, $f: M \to N$ zobrazení a $x \pi_f y: \Leftrightarrow f(x) = f(y)$. Potom platí:
\begin{enumerate}[a)]
	\item $\pi_f$ je relace ekvivalence na $M$, která se nazývá jádro $f$.
	\item Zobrazení
	$M/_{\pi_f} \to f(M) := \{f(x) | x \in M\} \subseteq N$\\
	$[x]_{\pi_f} \mapsto f(x)$\\
	je korektně definováno a bijektivní.
\end{enumerate}
\end{veta}

\subsection{Rozklad grupy na třídy podle podgrupy}

\begin{veta}
Buď $(G, \cdot, e, ^{-1})$ grupa a $(H, \cdot, e, ^{-1})$ podgrupa grupy $G$. Buď dále $\pi \subseteq G \times G$ podmnožina definovaná pomocí vztahu $x \pi y: \Leftrightarrow x^{-1}y \in H. x, y \in G$. Potom je $\pi$ relace ekvivalence na $G$.
\end{veta}

\begin{mydef}
Buď $(G, \cdot, e, ^{-1})$ grupa, $A, B \subseteq G$. Potom se nazývá $AB := \{ab | a \in A, b \in B\}$ složený součin A a B. Speciální případy: $A = \{a\}: AB := aB = \{ab | b \in B\}, B = \{b\}: AB := Ab = \{ab | a \in A\}$. Pro podgrupu H grupy G se nazývá $aH$ levá třída rozkladu grupy G podle H a $Ha$ se nazývá pravá třída rozkladu grupy G podle H ($a \in G$ pevné ale libovolné).
\end{mydef}

\begin{veta}
Buď $(G, \cdot, e, ^{-1})$ grupa, $H$ podgrupa grupy $G$, $a, b \in G$. Potom je vztahem $i: aH \to bH; ax \mapsto bx$ definováno bijektivní zobrazení.
\end{veta}


\section{Homomorfismy}

\begin{mydef}
Buďte $\mathcal{A} = (A, (\omega_i)_{i \in I})$ a $\mathcal{A}^* = (A^*, (\omega^*_i)_{i \in I}$ algebry téhož typu $(n_i)_{i \in I}$. Zobrazení $f: A \to A^*$ se nazývá homomorfizmus algebry $\mathcal{A}$ do algebry $\mathcal{A}^*: \Leftrightarrow$
\begin{enumerate}
	\item Pro $i \in I$, kde $n_i > 0$ platí $\forall x_1, \dots, x_{n_i} \in A: f(\omega_ix_1 \dots x_{n_i}) = \omega_i^*f(x_1)\dots f(x_{n_1})$
	\item pro $i \in I$, kde $n_i = 0$, platí $f(\omega_i) = \omega_i^*$
\end{enumerate}
\end{mydef}

\begin{lemma}
Buďte $(G, \cdot, e, ^{-1})$ a $(H, \cdot, e, ^{-1})$ grupy, $f: G \to H$. Potom platí $f$ je homomorfismus grupy $(G, \cdot, e, ^{-1})$ do grupy $(H, \cdot, e, ^{-1}) \Leftrightarrow f$ je homomofizmus grupy $(G, \cdot)$ do grupy $(H, \cdot)$.
\end{lemma}

Pro vektorové prostory a okruhy ...

\begin{mydef}
Buďte $\mathcal{A} = (A, (\omega_i)_{i \in I})$ a $\mathcal{A}^* = (A^*, (\omega^*_i)_{i \in I}$ algebry téhož typu $(n_i)_{i \in I}$ a $f: A \to A^*$ homomorfizmus algebry $\mathcal{A}$ do algebry $\mathcal{A}^*$. $f$ se nazývá:
\begin{enumerate}
	\item \emph{izomorfizmus}, pokud $f$ je bijektivní (v tomto případě říkáme, že $\mathcal{A}$ je izomorfní obraz $\mathcal{A}^*$, a píšeme $\mathcal{A} \cong \mathcal{A}^*$).
	\item \emph{endomorfizmus}, pokud $\mathcal{A} = \mathcal{A}^*$
	\item \emph{automorfismus}, pokud $\mathcal{A} = \mathcal{A}^*$ a $f$ je izomorfismus.
	\item \emph{epimorfizmus}, pokud $f$ je surjektivní (v tomto případě se nazývá $\mathcal{A}^*$ homomorfní obraz $\mathcal{A}$).
	\item \emph{monomorfizmus}, pokud je $f$ injektivní (v tomto případě se $\mathcal{A}$ nazývá izomorfně uzavřená v $\mathcal{A}^*$).
\end{enumerate}

$g \circ f$ zachovává homomorfismus a isomorfismus.

$f^{-1}$ zachovává homomorfismus.
\end{mydef}

\begin{veta}
Buď $(H, \cdot)$ pologrupa, $(H^*, \cdot)$ grupoid a $f: H \to H^*$ homomorfizmus. Potom je podalgebra $(f(H), \cdot)$ grupoidu $(H^*, \cdot)$ pologrupa.

Platí také pro: (abelovské) grupy, (komutativní) okruhy, okruhy s jednotkovým prvkem, svazy, Booleovy algebry, vektorové prostory nad K.
\end{veta}

Rozlišujeme fundamentální operace a odvozené operace (tvořené konečným počtem proměnných a symbolů operací).

Izomorfismus je pouze přeznačení. Algebry jsou "stejné", izomorfizmus zachovává algebraické vlastnosti.

\begin{veta}
(Cayleyova věta o reprezentaci) Buď $(G, \cdot, e, ^{-1})$ grupa. Potom je $G$ izomorfní s podgrupou symetrické grupy $(S_G, \circ, id_G, ^{-1})$. Krátce: Každá grupa je izomorfní s nějakou grupou permutací.
\end{veta}

\section{Kongruence a faktorové algebry}

\begin{mydef}
Buď $\mathcal{A} = (A, (\omega_i)_{i \in I})$ algebra typu $(n_i)_{i \in I}$ a $\pi$ relace ekvivalence na $A$. $\pi$ se nazývá (relace) kongruence na $\mathcal{A} : \Leftrightarrow$ pro všechna $i \in I$, kde $n_i > 0, a_1, \dots, a_{n_i}, b_1, \dots, b_{n_i} \in A$ platí

$$ a_1 \pi b_1 \land \dots \land a_{n_i} \pi b_{n_i} \Rightarrow \omega_i a_i \dots a_{n_i} \pi \omega_i b_1 \dots b_{n_i} $$
\end{mydef}

\begin{veta}
Buď $\mathcal{A} = (A, (\omega_i)_{i \in I})$ algebra a $\pi$ kongruence na $\mathcal{A}$. Potom jsou vztahy

$$ \omega_i^*[a_1)_\pi \dots [a_{n_i}]_\pi := [\omega_i a_1 \dots a_{n_i}]_\pi, n > 0, a_1, \dots a_{n_1} \in A$$

$$ \omega_i^* := [\omega_i]_\pi, n_i = 0 $$

definovány operace $(\omega_i^*)_{i \in I}$ na faktorové množině $A/\pi$
\end{veta}

\begin{mydef}
Algebra $\mathcal{A}/\pi := (A/\pi, (\omega_i^*)_{i \in I})$ se nazývá faktorová algebra algebry $\mathcal{A}$ podle kongruence $\pi$. Často klademe $\omega_i := \omega_i^*$.
\end{mydef}

$(\mathbb{Z}, +, 0, -, \cdot, 1)$ je komutativní okruh s jednotkovým prvkem, který se nazývá okruh zbytkových tříd modulo $n$.

\begin{veta}
Buď $\mathcal{A} := (A, (\omega_i)_{i \in I})$ algebra, $\pi$ kongruence na $\mathcal{A}$. Potom je zobrazení
$$
 \nu =
   \begin{dcases}
     A \to A / \pi \\
     a \mapsto [a]_\pi
   \end{dcases}
$$
surjektivní homomorfizmus algebry $\mathcal{A}$ na $\mathcal{A}/\pi$, který se nazývá přirozený homomorfizmus.
\end{veta}

$\mathcal{A}/\pi$ je homomorfní obraz $\mathcal{A}$ a každý zákon, který platí v $\mathcal{A}$ platí také v $\mathcal{A}/\pi$ (pologrupy, (abelovské grupy), vektorové prostory, (komutativní) okruhy, okruhy s jednotkovým prvkem, svazy, Booleovy algebry). Nemusí být u oboru integrity!

\begin{veta}
(O homomorfizmu) Buďte $\mathcal{A} := (A, (\omega_i)_{i \in I})$ a  $\mathcal{A^*} := (A^*, (\omega_i^*)_{i \in I})$ algebry téhož typu $(n_i)_{i \in I}$ a $f: A \to A^*$ homomorfizmus. Potom je jádro $\pi_j$ kongruencí na $\mathcal{A}$ a existuje přesně jeden injektivní homomorfizmus $g$ z $\mathcal{A}/\pi$ do $\mathcal{A}^*$ takový, že $f = g \circ \nu$ ($\nu$ je přirozené zobrazení).
\end{veta}

Pro podalgebry $(f(A), (\omega_i^*)_{i \in I})$ algebry $\mathcal{A}^*$ platí $(f(A), (\omega_i^*)_{i \in I}) \cong \mathcal{A}/\pi_f$, tedy je každý homomorfní obraz algebry izomorfní s nějakou faktorovou algebrou.

Relace rovnosti $\iota = \{(x, x) | (x \in A\}$ a univerzální relace $\alpha = A \times A$ jsou vždy kongruencemi na $\mathcal{A}$. Platí $\mathcal{A}/\iota \cong \mathcal{A}$ a $|\mathcal{A}/\alpha| \leq 1$. $\mathcal{A}/\iota$ a $\mathcal{A}/\alpha$ jsou triviální faktorové algebry.

\begin{mydef}
Algebra $\mathcal{A}$ se nazývá prostá, má-li pouze triviální kongruence.
\end{mydef}

\subsection{Relace kongruence na grupách a okruzích}

\begin{veta}
Buď $(G, \cdot, e, ^{-1})$ grupa a $\pi$ relace ekvivalence na $G$. Potom platí
\begin{enumerate}[a)]
	\item $\pi$ je kongruence na $(G, \cdot, e, ^{-1}) \Leftrightarrow \pi$ je kongruence na $(G, \cdot)$
	\item Je-li $\pi$ kongruence na $(G, \cdot)$ a $[e]_\pi =: N$, potom platí
	\begin{enumerate}[i)]
		\item $N$ je podgrupa $(G, \cdot, e, ^{-1})$
		\item $x N x^{-1} = \{x y x^{-1} | y \in N\} \subseteq N$ pro všechna $x \in G$ 
		\item $x \pi y \Leftrightarrow x^{-1} y \in N$ pro všechna $x, y \in G$ (tj. $[x]_\pi = x N$ pro všechna $x \in G$).
	\end{enumerate}
\end{enumerate}
\end{veta}

\begin{mydef}
Podgrupa $N$ grupy $(G, \cdot, e, ^{-1})$ se nazývá normální podgrupa grupy $G$ (symbolicky $N \triangleleft G$): $\Leftrightarrow x N x^{-1} \in N$ pro všechna $x \in G$.
\end{mydef}
(v abelovské grupě je každá podgrupa normální)

\begin{lemma}
Por podgrupu $N$ grupy $G$ jsou následující tvrzení ekvivalentní:
\begin{enumerate}
	\item $N$ je normální podgrupa grupy $G$
	\item $\forall x \in G: x N x^{-1} = N$
	\item $\forall x \in G: N x = x N$, tj. pravá třída rozkladu = levá třída rozkladu.
\end{enumerate}
\end{lemma}

\begin{veta}
Buď $(G, \cdot, e, ^{-1})$ grupa, $N \triangleleft G$ a $\pi$ buď binární relace na $G$ definovaná vztahem $x \pi y: \Leftrightarrow x^{-1}y \in N, x,y \in G$. Potom je $\pi$ relace kongruence na $G$, kde $[e]_\pi = N$.
\end{veta}

\begin{veta}
Vztahem $\pi \mapsto [e]_\pi$ je definování bijektivní zobrazení množiny kongruencí na grupě G na množinu všech normálních podgrup grupy G. Inverzní zobrazení je dáno pomocí vztahu $N \mapsto \pi$, kde $x \pi y: \Leftrightarrow x^{-1}y \in N$.
\end{veta}

Chceme-li najít všechny homomorfní obrazy -- až na izomorfizmus -- nějaké grupy $G$, můžeme tedy určit všechny normální podgrupy $N$ grupy $G$ a vytvořit faktorové algebry $G/\pi$ pomocí odpovídajících kongruencí. Pokud normální podgrupě $N$ odpovídá kongruence $\pi$, píšeme $G/N := G/\pi = \{x N | x \in G\}$. Takováto faktorová algebra se nazývá faktorgrupa grupy $G$.

Triviálním kongruencím $\iota = \{(x, x) | x \in G\}$ a $\alpha = G \times G$ odpovídají tzv. triviální normální podgrupy ${e}$ a $G$. $G$ je prostá $\Leftrightarrow G$ má pouze triviální podgrupy.

\begin{veta}
Buď $G$ grupa, $U$ podgrupa, kde $[G:U] = 2$ (index $U$ v $G$). Potom platí $U \triangleleft G$.
\end{veta}

\section{Normální podgrupy}
\section{Ideály okruhů}

\begin{mydef}
Buď $(R, +, 0, -, \cdot)$ okruh a $I$ podokruh okruhu $R$. Potom se $I$ nazývá:
\begin{itemize}
	\item \emph{levý ideál} okruhu R: $\Leftrightarrow \forall r \in R: rI := \{ri | i \in I\} \subseteq I$
	\item \emph{pravý ideál} okruhu R: $\Leftrightarrow \forall r \in R: Ir := \{ir | i \in I\} \subseteq I$
	\item \emph{ideál} okruhu R (formálně $I \triangleleft R$): $\Leftrightarrow \forall r \in R: Ir  \subseteq I \land rI \subseteq I$
\end{itemize}
\end{mydef}

$R$ a $\{0\}$ jsou vždy ideály okruhu $R$, takzvané triviální ideály.

\begin{lemma}
Buď $(R, +, 0, -, \cdot, 1)$ okruh s jednotkovým prvkem a $I$ ideál okruhu $R$. Potom platí $1 \in I \Leftrightarrow I = R$.
\end{lemma}

\begin{veta}
Každé těleso má pouze triviální ideály.
\end{veta}

\begin{veta}
Buď $(R, +, 0, -, \cdot, 1)$ komutativní okruh s jednotkovým prvkem, který má pouze triviální ideály. Potom je $R$ pole nebo $R = \{0\}$
\end{veta}

Komutativní okruh $R \not= \{0\}$ s jednotkovým prvkem je pole $\Leftrightarrow R$ má pouze triviální ideály.

\begin{veta}
Buď $(R, +, 0, -, \cdot)$ okruh.
\begin{enumerate}[a)]
	\item Je-li $\pi$ kongruence na $R$, potom je $I := [0]_\pi$ ideál okruhu R, a platí $R/\pi = R/I = \{x + I | x \in R\}$
	\item Je-li $I$ ideál okruhu $R$ a $\pi$ binární relace na $R$ definovaná vztahem $x \pi y :\Leftrightarrow y - z \in I, x,y \in R$, potom je $\pi$ kongruence na $R$ a $[0]_\pi = I$
	\item $\pi \mapsto [0]_\pi$ definuje bijektivní zobrazení množiny všech kongruencí na $R$ na množinu všech ideálů okruhu $R$. Inverzní zobrazení je dáno vztahem $I \mapsto \pi$, kde $\pi$ je kongruence definovaná v b). 
\end{enumerate}
\end{veta}

Okruh $R$ je prostý $\Leftrightarrow$ $R$ má pouze triviální kongruence $\Leftrightarrow$ $R$ má pouze triviální ideály $\{0\} := (0)$ a $R$.

\begin{veta}
Komutativní okruh $R \not= \{0\}$ s jednotkovým prvkem je prostý právě tehdy, když je pole
\end{veta}

\section{Přímé součiny}

\begin{mydef}
Buďte $\mathcal{A}_k = (A_k, \omega_i^{(k)_{i \in I}}, k \in K$ algebry téhož typu $(n_i)_{i \in I}$ a $A := \prod\limits_{k \in K} A_k = \{(a_k)_{k \in K} | a_k \in A_k\}$ kartézský součin všech množin $A_k$. Pro všechna $i \in I$ buď operace $\omega_i$ na $A$ definována vztahem:

$$ \omega_i(a_k^{(1)})_{k \in K} \dots (a_k^{n_i})_{k \in K} := (\underbrace{\omega_i^{(k)}a_k^{(1)} \dots a_k^{(n_i)}}_{\in A_k})_{k \in K} \text{pro} n_i > 0 $$

$$ \omega_i := (\omega_i^{(k)})_{k \in K} \text{ pro } n_i = 0 $$

Algebra $(A, (\omega_i)_{i \in I})$ se nazývá přímý součin algeber $\mathcal{A}_k$ a značí se $\prod\limits_{k \in K} \mathcal{A}_k$.
\end{mydef}

\begin{veta}
Pokud platí při vhodných termech $t_1, t_2$ zákon tvaru $\forall x_1, \dots x_n : t(x_1, \dots, x_n) = t_2(x_1, \dots, x_n)$ ve všech algebrách $\mathcal{A}_k, k \in K$, potom platí také v $\prod\limits_{k \in K}\mathcal{A}_k$.
\end{veta}

Důsledek: Přímé součiny pologrup (grup, vektorových prostorů, okruhů, Booleových algeber) jsou opět pologrupy (grupy, vektorové prostoru, okruhy, Booleovy algebry). Nikoliv však pro obory integrity!

Přímý součin je až na izomorfizmus komutativní ($A_1 \times A_2 \cong A_2 \times A_1$ a asociativní (uzávorkování).

\begin{veta}
Grupa $C_n \times C_m$ je cyklická $\Leftrightarrow \text{NSD}(m, n) = 1$.
\end{veta}

Je-li $n = p_1^{e_1} \dots p_k^{e_k}$ rozklad na prvočinitele čísla $n \in N$, potom platí $C_n \cong C_{p_1{e_1}} \times \dots \times C_{p_k{e_k}}$.

\begin{veta}
(Hlavní věta o konečně generovaných abelovských grupách) Je-li $G = \left< x_1, \dots, x_m \right>$ abelovská grupa generovaná prvky $x_1, \dots x_m$, potom platí:

$$ G \cong C_\infty^k \times C_{n_1} \times C_{n_r} $$

přičemž $k \geq 0 (C_\infty^0 := \{e\}), n_i = \mathbb{N}, r \geq 0$. Přitom platí $G$ je konečná $\Leftrightarrow k = 0$.
\end{veta}
($C_\infty$ označuje nekonečnou cyklickou grupu.)

















%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Obory integrity a dělitelnost} \label{cha:10}

1. semestr, MAT, \texttt{Zaklady\_obecne\_algebry.pdf}, 4, 5. kapitola

(okruhy polynomů, pravidla dělitelnosti, Gaussovy a Eukleidovy okruhy)

\section{Polynomy}
\subsection{Konstrukce okruhů polynomů}

\begin{mydef}
Buď $(R, +, 0, -, \cdot, 1)$ komutativní okruh s jednotkovým prvkem. Výraz tvaru $\sum_{k=0}^\infty a_kx^k$, kde $a_k \in R$ pro všechna $k \in \mathbb{N}_0$ a množina $\{k \in \mathbb{N}_0 | a_k \not= 0\}$ je konečná, se nazývá polynom neurčití $x$ nad $R$. Množinu všech polynomů neurčité $x$ nad R označíme symbolem $R[x]$. Definujeme nyní operace $+, 0, -, \cdot, 1$ na $R[x]$ tak, aby $(R[x], +, 0, -, \cdot, 1)$ byl opět komutativní okruh s jednotkovým prvkem:

$ \sum_{k = 0}^\infty a_k x^k + \sum_{k = 0}^\infty b_k x^k  := \sum_{k = 0}^\infty (a_k + b_k) x^k$,
$0 := \sum_{k = 0}^\infty 0 x^k $,
$-(\sum_{k = 0}^\infty a_k x^k) := \sum_{k = 0}^\infty (-a_k) x^k$,
$\sum_{k = 0}^\infty a_k x^k \cdot \sum_{k = 0}^\infty b_k x^k := \sum_{k = 0}^\infty \sum_{l = 0}^n a_l k_{k-l} x^k$,
$1 := \sum_{k = 0}^\infty \delta_k x^k$
\end{mydef}

\begin{veta}
$(R[x], +, 0, -, \cdot, 1)$ je komutativní okruh s jednotkovým prvkem.
\end{veta}

\begin{mydef}
Je-li $p(x) = \sum_{l = 0}^n a_k x^k$, kde $a_n \not= 0$, pak se $n$ nazývá stupeň polynomu $p(x)$ (píšeme $n = \text{grad } p(x)$). 
\end{mydef}

\begin{mydef}
Je-li $p(x) = \sum_{k = 0}^n a_k x^k \in R[x]$, pak se prvky $a_x$ nazývají koeficienty polynomu $p(x)$. $0 \in R[x]$ je nulový polynom a $a \in R \subseteq R[x]$ se nazývá konstantní polynom. Platí-li $\text{grad } p(x) = n$ a $a_n = 1$, pak se $p(x)$ nazývá normalizovaný polynom. Polynomy tvaru $ax + b$, kde $a \not= 0$ se nazývají lineární polynomy.
\end{mydef}

\begin{veta}
Je-li $R$ obor integrity, potom je také $R[x]$ obor integrity, a pro $p(x), q(x) \in R[x] \backslash \{0\}$ platí $\text{grad } (p(x)q(x)) = \text{grad } p(x) + \text{grad } q(x)$.
\end{veta}

Není-li R obor integrity, pak ani $R[x]$ není obor integrity, neboť $r$ je podokruh  okruhu $R[x]$.

\subsection{Polynomy $n$ neurčitých $x_1, \dots x_n$}

Indukcí definujeme

$$R[x_1] := R[x], R[x_1, \dots, x_n] := (r[x_1, \dots, x_{n-1}])[x_n], n > 1$$

Potom platí

$$ R[x_1, \dots, x_n] = \{ \sum\limits_{0 \leq i_i, \dots, i_n \leq m} a_{i_i \dots i_n} x_1^{i_1} \dots x_n^{i_n} | m \in \mathbb{N}_0, a_{i_1} \dots a_{i_n} \in R \} $$

\subsection{Polynomy a funkce}
\paragraph{Princip dosazování} Buď $(R, +, 0, -, \cdot, 1)$ komutativní okruh s jednotkovým prvkem a $p(x) = a_n x^n + \dots + a_1 x + a_0 \in R[x]$. Pro $a \in R$ je potom $p(a) := a_n a^n + \dots + a_1 a + a_0$ opět prvkem z $R$ který se nazývá \emph{hodnota polynomu v $a$}. Funkce

$$ \begin{dcases}
R \to R \\
a \mapsto p(a)
\end{dcases} $$

se nazývá polynomiální funkce indukovaná polynomem $p(x)$ a často se taká označuje $p$.

\begin{veta}
Zobrazení
$$ \begin{dcases}
R[x] \to R \\
p(x) \mapsto p(a)
\end{dcases} $$
je pro pevně dané $a \in R$ surjektivní homomorfizmus $R[x]$ na $R$.
\end{veta}

\begin{mydef}
Buď $p(x) \in R[x]$ (komutativní okruh s jednotkovým prvkem). Potom se $a \in R$ nazývá kořen polynomu $p(x): \Leftrightarrow p(a) = 0$. Polynom $p(x)$ se nazývá dělitelný polynomem $q(x) \in R[x]$ (formálně $q(x) | p(x)$): $\Leftrightarrow p(x) = q(x)r(x)$ kde $r(x) \in R[x]$.
\end{mydef}

\begin{veta}
Je-li $a$ kořen polynomu $p(x)$, pak je $p(x)$ dělitelný lineárním polynomem $x - a$ (a opačně).
\end{veta}

Nechť je $R$ obor integrity (např. $R = \mathbb{Z}$ nebo $R$ pole). Je-li $\text{grad } p(x) = n$ a platí $(x - a)^k | p(x)$ , tj. $p(x) = (x -a)^k q(x)$, potom je $k + \text{ grad } q(x) = \text{ grad } p(x) = n$, z čehož plyne $k \leq n$.

\begin{mydef}
Buď $p(x) \in R[x] \backslash \{0\}$ a nechť $a \in R$ je kořenem $p(x)$. Potom největší číslo $k \in \mathbb{N}$ takové, že $(x - a)^k | p(x)$, se nazývá násobnost kořene $a$.

$l \leq \text{ grad } p(x)$
\end{mydef}

\begin{veta}
Nechť $a_1, \dots a_r$ jsou po dvou různé kořeny polynomu $p(x) \in R[x] \backslash \{0\}$ s násobností $k_1 ,\dots, k_r$. Potom platí

$$ (x - a)^{k_1} \dots (x - a)^{k_r} | p(x)$$
\end{veta}

Potom platí: $k_1 + \dots + k_r \leq \text{ grad } p(x)$

\begin{veta}
Buďte $p(x), q(x) \in R[x] \backslash \{0\}, \text{ grad } p(x) \leq n$ a $p(b_i) = q(b_i)$ pro $n+1$ po dvou různých prvků $b_0, \dots, b_n$ množiny $R$. Potom platí $p(x) = q(x)$.
\end{veta}

\begin{mydef}
Pole $K$ se nazývá algebraicky uzavření, jestliže každý polynom $p(x) \in K[x] \ K$ má alespoň jeden kořen.
\end{mydef}
Pokud má nad oborem integrity každý lineární polynom kořen, pak je tento obor integrity pole ($ax - 1 (a \not=0)$ má kořen $c \Rightarrow ac = 1 \Rightarrow c = a^{-1}$).

\begin{veta}
(Gaussova základní věta algebry) Pole $\mathbb{C}$ je algebraicky uzavřené.
\end{veta}

\begin{veta}
Je-li $K$ pole, potom jsou následující tvrzení ekvivalentní:
\begin{enumerate}[a)]
	\item $K$ je algebraicky uzavřené
	\item Pro všechna $p(x) \in K[x]$, kde $\text{ grad } p(x) = n > 0$, platí $p(x) = c(x - b_1)^{k_1} \dots (x - b_r)^{k_r}$, kde $b_1, \dots, b_r, c \in K$ a $k_1 + \dots + k_r = n$.
\end{enumerate}
\end{veta}

Výpočet kořenů nad poli:
\begin{enumerate}[1)]
	\item $\text{grad } p(x) = 1$: $ax + b$:  triviální
	\item $\text{grad } p(x) = 2$: $p(x) = ax^2 + bx + c (a \not= 0)$ má kořeny $\frac{-b \pm \sqrt{b^2 - 4ac}}{2a}$ (2 resp. 4 zde označuje 1 + 1 resp. 1+1+1+1; vyjádření kořenů musí existovat a musí být $1+1 \not= 0$.
	\item $\text{grad } p(x) = 3, 4$ Cardanovy vzorce
	\item $\text{grad } p(x) > 4$  nejsou obecné vzorce
\end{enumerate}

\subsection{Interpolace pomocí polynomů}
Buď $K$ pole a $f: K \to K$ funkce. \textbf{Zadáno}: $b_i = f(a_i)$  pro po dvou různá $a_i \in K, 1 \leq i \leq n$ (např. výsledek řady měření). \textbf{Hledá se}: $p(x) \in K[x]$, kde $p(a_i) = b_i = f(a_i), 1 \leq i \leq n$ a $\text{ grad } p(x) < n$. (Existuje nejvýše jeden takový polynom $p(x)$ z $p(a_i), 1 \leq i \leq n$, kde $\text{grad } p(x), \text{ grad } q(x) < n$ totiž plyne $p = q$.)

\subsubsection{Lagrangerovy interpolační vzorce}
Buď
$$q_i(x) := \prod\limits_{1 \leq j \leq n, j \not=i} (x - a_j) = \dots (x - a_{i-1}) (x - a_{i+1}) \dots (x - a_n)$$
Potom platí:
$$q_i(a_k) =  \begin{dcases}
0 \text{pro} i \not= k \\
\prod\limits_{1 \leq j \leq n, j \not=i} (a_k - a_j) \not= 0 \text{pro } i = k
\end{dcases}$$
Pro 
$$ p(x) := \sum\limits_{i = 1}^n b_i \frac{q_i(x)}{q i (a_i)} $$
Potom platí $$ p(a_j) = b_j, 1 \leq j \leq n $$

Je-li $K$ konečné pole (např. $K = \mathbb{Z}_p, p$ prvočíslo), $f: K \to K$, potom existuje polynom $p(x) \in K[x]$ takový, že $f(a) = p(a)$ pro všechna $a \in K$.

% \subsubsection{Newtonovy interpolačnı́ vzorce}
% XXX ???

\section{Obory integrity a dělitelnost}
\subsection{Jednoduchá pravidla dělitelnosti}


\begin{mydef}
Buď $(I, +, 0, -, \cdot, 1)$ obor integrity. Jsou-li $a, b \in I$, potom říkáme, že prvek $a$ je dělitelný prvkem $b$ a $b$ se nazývá dělitel prvku $a$ ($b$ \uv{dělí} $a$, formálně $b|a$): $\Leftrightarrow \exists c \in I: a = bc$.
\end{mydef}

Elementární pravidla dělitelnosti:
\begin{enumerate}[1)]
	\item $\forall a \in I: a | 0$
	\item $\forall a \in I: 1 | a$
	\item $\forall a \in I: a | a$
	\item $\forall a,b,c \in I: a|b \land b|c \Rightarrow a|c$
	\item $\forall a,b,c \in I: a|b \Rightarrow a|bc$
	\item $\forall a,b,c \in I: a|b \land a|c \Rightarrow a|b+c$
	\item $\forall a,b,c \in I, c \not= 0: a|b \Leftrightarrow ac|bc$
	\item $\forall a,b,c,d \in I: a|b \land c|d \Rightarrow ac|bd$
	\item $\forall a,b \in I, n \in \mathbb{N}: a|b \Rightarrow a^n|b^n$
\end{enumerate}

\begin{mydef}
Buď $(I, +, 0, -, \cdot, 1)$ obor integrity. Dělitel prvku 1 se nazývá jednotka oboru integrity $I$. Buď $E(I)$ množina všech jednotek $I$. Prvky $a, b \in I$ se nazývají asociované (formálně $a \sim b$): $\Leftrightarrow \exists e \in E(I): a = be$.
\end{mydef}

\begin{veta}
\begin{enumerate}[a)]
	\item $e \in I$ je jednotka oboru integrity $I \Leftrightarrow \exists f \in I: ef = 1$
	\item $(E(I(, \cdot))$ je abelovská grupa, která se nazývá grupa jednotek oboru integrity  $I$.
	\item $\sim$ je relace kongruence na $(I, \cdot)$
	\item $\forall a, b \in I: a \sim b \Leftrightarrow a|b \lor b|a$
\end{enumerate}
\end{veta}

\begin{mydef}
Buď $(I, +, 0, -, \cdot, 1)$ obor integrity, $a \in I$.
\begin{description}
	\item[Triviální dělitelé prvku $a$] jsou všechna $e \in E(I)$ a všechna $b$ taková, že $b \sim a$
	\item[Vlastní dělitelé prvku $a$] jsou všechna $b$ taková, že $b | a, b \not\in E(I)$ a $b \not\sim a$
\end{description}
\end{mydef}

\begin{mydef}
Prvek $a \in I \backslash E(I), a \not= 0$ se nazývá ireducibilní prvek: $\Leftrightarrow a$ má pouze triviální dělitele. (např. prvočísla v $\mathbb{Z}$.)
\end{mydef}

\begin{mydef}
$p \in I \backslash E(I), p \not= 0$ se nazývá prvočinitel: $\Leftrightarrow p|ab \Rightarrow p|a \lor p|b$
\end{mydef}

Prvočinitel $\Leftrightarrow$ je ireducibilní prvek.

\section{Gaussovy okruhy}

\begin{mydef}
Obor integrity $I$ se nazývá Gaussův okruh: $\Leftrightarrow$ Ke každému prvku $a \in I \backslash E(I), a \not= 0$, existují prvočinitelé $p_1, \dots, p_r$ (nikoliv nutně po dvou různí) tak, že platí $a = p_1 \dots p_r$
\end{mydef}

\begin{veta}
(Jednoznačnost rozkladu na prvočinitele) Buď $I$ Gaussův okruh, $a \in I \backslash E(I), a \not= 0, a = p_1^{(1)} \dots p_{r_1}^{(1)} = p_1^{(2)} \dots p_{r_2}^{(2)}$, kde $p_i^{(1)}, p_j^{(2)}$ jsou prvočinitelé. Potom je $r_1 = r_2 := r$ a existuje permutace množiny $\{1, \dots r\}$ taková, že $p_i^{(1)} \sim p_{\pi(i)}^{(2)}, i = 1, \dots, r$.
\end{veta}

$\mathbb{Z}$ a $K[x]$ (K pole) jsou Gaussovy okruhy.

\begin{mydef}
Buď $I$ obor integrity, $a_1, \dots, a_n \in I$.
\begin{enumerate}[1)]
	\item $d \in I$ se nazývá \emph{největší společný dělitel} (NSD) prvků $a_1, \dots a_n \in I: \Leftrightarrow$ (i) $d | a_i, i = 1, \dots, n$ a (ii) $\forall t \in I: t|a_i, i = 1, \dots, n \Rightarrow t | d$
	\item $v \in I$ se nazývá \emph{nejmenší společný násobek} (NSN) prvků $a_1, \dots a_n \in I: \Leftrightarrow$ (i) $a_i | v, i = 1, \dots, n$ a (ii) $\forall w \in I: a_i | w, i = 1, \dots, n \Rightarrow v | w$
\end{enumerate}
\end{mydef}

\begin{veta}
V Gaussově okruhu $I$ je každý ireducibilní prvek prvočinitelem.
\end{veta}

\begin{veta}
Je-li $I$ Gaussův okruh, $a \in I \backslash E(I), a \not=0$, potom platí $a = e p_1^{e_1} \dots p_r^{e_r}$, kde $e \in E(I), p_1, \dots p_r$ jsou normovaní navzájem různí prvočinitelé $e_i \in \mathbb{N}$. 
\end{veta}

\begin{lemma}
Buď $I$ Gaussův okruh, $a, b \in I \backslash \{0\}, a = fp_1^{f_1} \dots p_r^{f_r}, b = g p_1^{g_1} \dots p_r^{g_r}$ ($p_j$ normovaní navzájem různí prvočinitelé, $f_j, g_j \in \mathbb{N}_0, f,g \in E(I)$). Potom platí $a|b \Leftrightarrow f_j \leq g_j$ pro $j = 1, \dots, r$.
\end{lemma}

\begin{veta}
Buď $I$ Guassův okruh, $a_1, \dots, a_n \in I, a_i \not= 0, a_i = e_i p_1^{e_{1i}} \dots p_r^{e_{ri}}, e_i \in E(I), p_j$ navzájem různí normovaní prvočinitelé, $e_{ji} \in \mathbb{N_0}$. Potom platí:

$$ \text{NSD}(a_1, \dots, a_n) = p_1^{\text{min}_{1 \leq n \leq n}(e_{1i})} \dots p_r^{\text{min}_{1 \leq n \leq n}(e_{ri})}$$

a

$$ \text{NSN}(a_1, \dots, a_n) = p_1^{\text{max}_{1 \leq n \leq n}(e_{1i})} \dots p_r^{\text{max}_{1 \leq n \leq n}(e_{ri})}$$

Jsou-li některá $a_i = 0$, potom je NDS$(a_1, \dots, a_n) = $NSD$(a_i|a_i \not= 0)$; jsou-li všechna $a_i = 0$, potom je NDS$(a_1, \dots a_n) = 0$. Jsou-li některá $a_i = 0$, pak je $NSN(a_1, \dots, a_n) = 0$.
\end{veta}

\begin{veta}
Buď $I$ Gaussův okruh a $\cap, \cup$ binární operace na $I / \sim= \{[a]_\sim | a \in I\}$ definovaní vztahy:

$$[a]_\sim \cap [b]_\sim := [NSD(a, b)]_\sim $$
$$[a]_\sim \cup [b]_\sim := [NSN(a, b)]_\sim $$

Potom jsou $\cap, \cup$ korektně definovány (tj. nezávisle na volbě reprezentantů) a $(I / \sim, \cap, \cup)$ je svaz s nulovým prvkem $[1]_\sim = E(I)$ a jednotkovým prvkem $[0]_\sim = \{0\}$ (svaz dělitelů). Příslušné uspořádání $\leq$ je dáno vztahem: $[a]_\sim \leq [b]_\sim : \Leftrightarrow a|b$.
\end{veta}

$(\mathbb{Z}/ \sim, \cap, \cup) \equiv (\mathbb{N}_0, NSD, NSN)$

\section{Eukleidovy okruhy}
\begin{mydef}
Obor integrity $I$ se nazývá Eukleidův okruh: $\Leftrightarrow$ existuje zobrazení $H: I \backslash \{0\} \to \mathbb{N}_0$ (Eukleidovské ohodnocení) s následující vlastností: pro všechna $a \in I \backslash \{0\}, b \in I$ existují $q, r \in I$ tak, že $b=aq + r$, kde $r = 0 \lor H(r) < H(a)$ (dělení se zbytkem).
\end{mydef}

$\mathbb{Z}$ je Ekleidův okruh, kde $H(a) := |a|$. Každé pole je Eukleidův okruh ($q = a^{-1}b, r = 0$).

\begin{veta}
$K[x]$ (K pole) je Eukleidův okruh, kde $H(p(x)) := \text{ grad }p(x)$, tj. pro $p(x) \not= 0$, $p_1(x)$ libovolné, je $p_1(x) = p(x)q(x) + r(x)$, kde $r(x) = 0$ nebo grad $r(x) < \text{grad }p(x)$.
\end{veta}

Libovolný polynom $p(x) \in K[x]$ a libovolný prvek $a \in K$ existuje $r \in K$ tak, že $p(x) = (x - a)q(x) + p(a)$.

\begin{veta}
Každý Eukleidův okruh je Gaussův okruh.
\end{veta}













%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Teorie polí} \label{cha:11}

1. semestr, MAT, \texttt{Zaklady\_obecne\_algebry.pdf}, 6. kapitola

(minimální pole, rozšíření pole, konečná pole a jejich konstrukce)

\section{Minimální pole}
\begin{mydef}
Pole $(K, +, 0, -, \cdot, 1)$ se nazývá minimální, pokud nemá žádná jiná podpole než sama sebe.
\end{mydef}

\begin{veta}
Každé pole má vždy jediné podpole, které je minimální.
\end{veta}

\begin{lemma}
Buď $(R, +, 0, -, \cdot, 1)$ okruh s jednotkovým prvkem. Pak $\{n \cdot 1 | n \in \mathbb{Z}\}$ je komutativní podokruh okruhu R s tímtéž jednotkovým prvkem 1, totiž podokruh generovaný prvkem 1.
\end{lemma}

\begin{mydef}
Buď $(R, +, 0, -, \cdot)$ okruh. Pak symbolem char $R$ označíme charakteristiku okruhu $R$, tj. nejmenší číslo $n \in \mathbb{N}$ takové, že pro každé $a \in R$ platí $n \cdot a = 0$ (kde $n \cdot a := \underbrace{a + a + \dots + a}_{n\text{-krát}}$. Pokud takové číslo neexistuje, pak klademe char $R = 0$.

Je-li $(R, +, 0, -, \cdot, 1)$ okruh s jednotkovým prvkem a $n \in \mathbb{N}$, pak pro každé $a \in R$ platí $n \cdot a = 0$, právě když platí $n \cdot 1 = 0$ (platí-li $n \cdot 1 = 0$ a je-li $a \in R$ libovolný prvek, pak máme $n \cdot a = \underbrace{a + a + \dots + a}_{n\text{-krát}} = (\underbrace{1 + 1 + \dots + 1}_{n\text{-krát}})\cdot a = (n \cdot 1) \cdot a = 0 \cdot a = 0$; opačná implikace je zřejmá). Je-li tedy R okruh s jednotkovým prvkem $1$, pak char R je nejmenší číslo $n \in N$ pro něž platí $n \cdot 1 = 0$, případně char $R = 0$ pokud takové číslo neexistuje. Odtud ihned plyne, že platí

$\text{char }R = \begin{dcases}
o(1), \text{ pokud } o(1) \in \mathbb{N}, \\
0, \text{ pokud } o(1) = \infty
\end{dcases}$

($o(1)$ značí řád prvku $1$ v abelovské grupě $(R, +)$, tedy $o(1) = |\{n \cdot 1 | n \in \mathbb{Z}\}|$ pokud je tato kardinalita konečná, jinak $\infty$.
\end{mydef}

$\text{char }R = \begin{dcases}
|\{n \cdot 1 | n \in \mathbb{Z}\}|, \text{ pokud se jedná o končnou kardinality }, \\
0, \text{ jinak }
\end{dcases}$

Okruh zbytkových tříd: $\mathbb{Z}_n$: char $\mathbb{Z}_n = n (n \in \mathbb{N}_0)$, char $\mathbb{Z} = 0$.

\begin{lemma}
Buď $(R, +, 0, -, \cdot, 1)$ okruh s jednotkovým prvkem a nechť $m = \text{ char }R$. Potom $\{n \cdot 1 | n \in \mathbb{Z}\} \cong \mathbb{Z}_m$
\end{lemma}

\begin{lemma}
\begin{enumerate}[1)]
	\item Je-li $R$ obor integrity a $m = \text{ char }R$, potom také $\{n \cdot 1 | n \in \mathbb{Z}\}$, a tedy i $\mathbb{Z}_m$ je obor integrity, takže platí $m=0$ nebo $m \in \mathbb{P}$ ($\mathbb{P}$ značí množinu všech prvočísel).
	\item Je-li $R$ obor integrity a char $R \in \mathbb{P}$, potom $\{n \cdot 1 | n \in \mathbb{Z}\}$ je pole.
\end{enumerate}
\end{lemma}

\begin{veta}
Buď $(K, +, 0, -, \cdot, 1)$ pole takové, že char $K \in \mathbb{P}$. Potom $\{n \cdot 1 | n \in \mathbb{Z}$ je minimální podpole pole K. V tomto případě tedy platí: minimální podpole pole K je izomorfní se $\mathbb{Z}_m$, kde $m = \text{ char } K$.
\end{veta}

\begin{veta}
Buď $(K, +, 0, -, \cdot, 1)$ pole, kde char $K = 0$. Potom je $\{ \frac{n \cdot 1}{m \cdot 1} | n \in \mathbb{Z}, m \in \mathbb{Z} \backslash \{0\}\}$ nejmenším podpolem  a tudíž minimálním podpolem pole $K$. Toto minimální podpole je izomorfní s $\mathbb{Q}$. Přitom jsme položili $\frac{n \cdot 1}{m \cdot 1} := (n \cdot 1)(m \cdot 1)^{-1}$.
\end{veta}

Každé minimální pole je izomorfní se $\mathbb{Z}_p (p \in \mathbb{P})$ nebo $\mathbb{Q}$.

\section{Rozšíření pole}
\begin{mydef}
Buďte $K, L$ pole a $K$ podpole pole $L$. Potom $L$ se nazývá nadpole nebo rozšíření pole $K$.
\end{mydef}

Pole $L$ se nazývá \emph{kořenové pole} polynomu $f(x)$ vzhledem ke $K$, pokud je rozšířením pole s právě $n$ kořeny.

Buď $L$ takové kořenové pole polynomu $f(x)$ vzhledem ke $K$. Potom je

$K(\alpha_1, \dots, \alpha_n) := \bigcap \{M \subseteq L | M \text{ podpole pole } L, K \subseteq M, \alpha_1, dots, \alpha_n \in M \}$

nejmenší podpole pole L, které obsahuje pole $K$ a prvky $\alpha_1, \dots, \alpha_n$. $K(\alpha_1, \dots, \alpha_n)$ se nazývá \emph{rozkladové pole} polynomu $f(x)$ vzhledem ke K.

\begin{veta}
(Kroneckerova věta) Ke každému $f(x) \in K[x], f(x) \not= 0$, existuje kořenové pole a tedy rozkladové pole polynomu $f(x)$ vzhledem ke K.
\end{veta}

Je-li $L$ nadpole pole $K$, potom je $L$ také vektorovým prostorem nad $K$. Vztahem $\text{dim}_K K =: [L : K]$ definujeme tzv. stupeň rozšíření $L$ pole $K$. Je-li $[L : K] < \infty$, pak se $L$ nazývá \emph{konečné rozšíření} pole $K$.

\begin{enumerate}
	\item $[ L : K] = 1 \Leftrightarrow L = K$
	\item Je-li $p(x) \in K[x]$ ireducibilní polynom stupně $k$, pak existuje rozšíření $L$ pole $K$ a prvek $\alpha \in L$ tak, že $p(x) = 0$ a $\{1, \alpha, \dots, \alpha^{k-1}\}$ je báze $L$ nad $K$. Tedy platí $ [L : K] = k$.
\end{enumerate}

\begin{mydef}
Buď $L$ nadpole pole $K$ a $\alpha \in L$.
$\alpha$ se nazývá \emph{algebraický} prvek nad $K: \Leftrightarrow \exists f(x) \in K[x] \backslash \{0\}: f(\alpha) = 0$. \\
$\alpha$ se nazývá \emph{transcendentní} prvek nad $K: \Leftrightarrow \not\exists f(x) \in K[x] \backslash \{0\}: f(\alpha) = 0$.
\end{mydef}

\begin{mydef}
Je-li $L$ nadpole pole $K$ a $S \subseteq L$, pak definujeme rozšíření $K(S)$ pole $K$ takto:

$$K(S) := \bigcap \{E \subseteq L | E \text{ je podpole pole L, které obsahuje } K \cup S\}$$

Je-li $S = \{u_1, \dots, u_r\}$ konečné, pak píšeme $K(S) =: K(u_1, \dots, u_r)$. Je-li speciálně $S = \{\alpha\}$ jednoprvkové, pak píšeme $K(S) =: K(\alpha)$ (\uv{jednoduché rozšíření} pole K).
\end{mydef}

\section{Konečná pole (Galoisova pole)}

\begin{veta}
Řád každého konečného pole je mocnina prvočísla $p^n (p \in \mathbb{P}, n \in \mathbb{N})$. Obráceně ke každé mocnině čísla $p^n$ existuje až na izomorfizmus jediné pole $K$ takové, že $|K| = p^n$.
\end{veta}
Způsob zápisu pro $K$, kde $|K| = p^n: K = GF(p^n)$ (Galoisovo pole).

\begin{veta}
Je-li $K$ konečné pole, pak je grupa $(K \backslash \{0\}, \cdot)$ cyklická.
\end{veta}

\subsection{Konstrukce konečného pole $K$}

Každý generátor grupy $(K \ \{0\}, \cdot)$ se nazývá primitivní prvek $K$. Je-li $\alpha$ primitivní prvek $K$, pak $K = \{0, 1, \alpha, \alpha^2, \dots, \alpha^{|K|-2}\}$. Buď $\mathbb{Z}_q, q \in \mathbb{P}$, minimální podpole pole $K$. Pak pro libovolná primitivní prvek $\alpha$ z $K$ platí $K \cong \mathbb{Z}_q(\alpha)$ a $\alpha$ je algebraický prvek nad $\mathbb{Z}_q$ (neboť je kořenem polynomu $x^{|K|-1} - 1 \in \mathbb{Z}_q[x]$). Buď $f(x)$ minimální polynom kořene $\alpha$ vzhledem k $\mathbb{Z}_q$. Potom je $f(x)$ ireducibilní a platí

$$ \mathbb{Z}_q(\alpha) = \{a_0 + a_1 \alpha + \dots + a_{n-1}\alpha^{m-1} | a_i \in \mathbb{Z}_q\}$$

kde $m = \text{ grad } f(x)$. Odtud dostáváme $|\mathbb{Z_q}(\alpha)| = q^m$ a z podmínky $|\mathbb{Z}_q(\alpha)| = |K| = p^n$ nyní vyplývá $q = p$ a $m = n$.

Při určování konečného pole $K = GF(p^n)$, tj. při sestavování tabulek jeho operací, lze proto postupovat následujícím způsobem:
\begin{enumerate}
	\item Za minimální podpole pole $K$ se vezme $\mathbb{Z}_p$.
	\item Zvolíme normovaný ireducibilní polynom $q(x) \in \mathbb{Z}_p[x]$ stupně $n$. Nechť např. $q(x) = x^n - a_{n-1}x^{n-1} - \dots - a_1 x - x_0$ kde $a_i \in \mathbb{Z}_p$.
	\item Položíme $q(\alpha) = 0$ a uvažujeme bází $\{1, \alpha, \dots, \alpha^{n-1}\}$ vektorového prostoru $GF(p^n)$ nad $\mathbb{Z}_p$ (víme, že $[GF(p^n): \mathbb{Z}_p] = n$). Spočítáme použitím $q(\alpha = 0)$ (tj. $a^n = a_0 + x_1 \alpha + \dots + a_{n-1}x^{n-1}$ mocniny $\alpha$. Platí-li $\alpha^{p^n-1} = 1$ pro $1 \leq j < p^n - 1$, je $\alpha$ primitivní prvek $GF(p^n)$. Jinak učiníme další pokus s novým polynomem $q(x)$.
\end{enumerate}













%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Metrické prostory} \label{cha:12}

1. semestr, MAT, \texttt{Zaklady\_funkcionalni\_analyzy\_opr.pdf}, 1. -  6. kapitola

(příklady, konvergence posloupností, spojitá a izometrická zobrazení, úplnost, Banachova věta o pevném bodu)

\section{Definice, příklady}
\begin{mydef}
Metrickým prostorem budeme rozumět dvojici $\mathcal{X} = (X, \varrho)$, kde $X$ je množina, jejíž prvky nazýváme bodu a $\varrho$ je tzv. vzdálenost (metrika), což je nezáporná reálná funkce $\varrho(x, y)$, která je definována pro každou dvojicí $x, y \in X$ (tedy $\varrho: X \times X \to \mathbb{R}_0^+$ je zobrazení) a která splňuje tyto podmínky:
\begin{enumerate}[1)]
	\item $\forall x, y \in X: \varrho(x, y) = 0 \Leftrightarrow x = y$
	\item $\forall x, y \in X: \varrho(x, y) = \varrho(y, x)$ (symetrie)
	\item $\forall x, y, z \in X: \varrho(x, y) + \varrho(y, z) \geq \varrho(x, z)$ (trojúhelníková nerovnost)
\end{enumerate}
\end{mydef}

Příklady:
\begin{itemize}
	\item Diskrétní metrický prostor $(X, \varrho)$:
	$$\varrho(x, y) = \begin{dcases}
	0 \text{v případě} x = y\\
	1 \text{v případě} x \not= y
	\end{dcases}$$
	\item Metrický prostor $\mathbb{R}^1$ se vzdáleností $\varrho(x, y) = |x-y|$
	\item $n$-rozměrný euklidovský prostor $\mathbb{R}^n$ se vzdáleností $\varrho(x, y) = \sqrt{\sum\limits_{k = 1}^n}(y_k - x_k)^2$. Tento metrický prostor $(\mathbb{R}^n, \varrho)$ značíme $\mathbb{R}^n_1$.
	\item Metrický prostor $\mathbb{R}^n_0$ používá vzdálenost $\varrho_0(x, y) = \max\limits_{1 \leq k \leq n} |y_k - x_k|$
	\item Množina $C(\left<a, b \right>)$ (často též značená $C^0\left<a,b\right>$) všech spojitých reálných funkcí, které jsou definovány na intervalu $\left<a, b\right>$, se vzdáleností: $\varrho(f, g) = \max\limits_{a \leq t \leq b} | g(t) - f(t)$ také tvoří metrický prostor.
	\item Označme symbolem $l_2$ metrický prostor, jehož body jsou posloupnosti reálných čísel
	$x = (x_1, x_2, \dots, x_n, \dots)$
	splňující podmínku
	$\sum\limits_{k=1}^\infty x_k^2 < +\infty$
	a v němž se vzdálenost definuje vztahem
	$\varrho(x, y) = \sqrt{\sum\limits_{k=1}^\infty(y_k - x_k)^2}$
	\item Uvažujeme množinu všech spojitých funkcí na intervalu $\left<a, b\right>$. Vzdálenost definujeme jako $\varrho(x, y) = \left( \int_a^b (x(t) - y(t))^2 dt \right)^\frac{1}{2}$. Tento metrický prostor budeme značit $C_2^0\left<a, b\right>$ a nazývat prostorem spojitých funkcí s kvadratickou metrikou.
	\item Uvažujme množinu všech ohraničených posloupností $x = (x_1, x_2, \dots, x_n, \dots)$ reálných čísel. Položíme-li $\varrho(x, y) = sup |x_k - y_k|$ dostaneme metrický prostor $M^\infty$.
\end{itemize}

\begin{mydef}
Nechť $\mathcal{X} = (X, \varrho)$ je libovolný metrický prostor. Metrický prostor $\mathcal{M} = (M, \varrho)$ s toutéž metrikou $\varrho$ uvažovanou pouze na množině $M \subset X$ se nazývá podprostorem metrického prostoru $X$.
\end{mydef}

\section{Konvergence posloupností}
Buď $\mathcal{X} = (X, \varrho)$ metrický prostor, $x_0 \in X, r \in \mathbb{R}^+$. \emph{Otevřenou koulí} $S(x_0, r)$ v metrickém prostoru $\mathcal{X}$ budeme nazývat množinu bodů $x \in X$, které vyhovují podmínce

$$\varrho(x, x_0) < r$$

Bod $x_0$ se nazývá \emph{středem} a číslo $r$ \emph{poloměrem} této koule.

\emph{Uzavřenou koulí} poloměru $\epsilon$ se středem $x_0$ budeme také nazývat $\epsilon$-okolím bodu $x_0$ a značit symbolem $0_\epsilon(x_0)$.

Bod $x$ nazýváme bodem \emph{uzávěru množiny} $M$, jestliže jeho libovolné okolí obsahuje alespoň jeden bod z $M$. Množina všech bodů uzávěru množiny $M$ se označuje $\overline{M}$ a nazývá se \emph{uzávěrem} množiny.

Protože každý bod, který náleží $M$ je bodem uzávěru množiny $M$ (tento bod totiž leží v každém svém okolí), platí $M \subseteq \overline{M}$.

Množinu $M$, pro kterou platí $M = \overline{M}$, nazýváme \emph{uzavřenou}.

Bod $x$ nazýváme \emph{vnitřním bodem množiny $M$}, existuje-li okolí $O_\epsilon(x)$ tohoto bodu, které je celé obsažené v množině $M$. Množinu, jejíž všechny body jsou vnitřní nazýváme \emph{otevřenou}.

Zřejmě je tedy množina $M$ otevřená (uzavřená), právě když její doplněk je uzavřená (otevřená) množina.

\begin{veta}
Uzávěr uzávěru $M$ je roven uzávěru $M$:
$$ \overline{\overline{M}} = \overline{M} $$
\end{veta}

\begin{veta}
Jestliže $M_1 \subseteq M$, potom $\overline{M_1} \subseteq \overline{M}$
\end{veta}

\begin{veta}
Uzávěr sjednocení je roven sjednocení uzávěrů:
$$ \overline{M_1 \cup M_2} = \overline{M_1} \cup \overline{M_2} $$
\end{veta}

Nechť $x_1, x_2, \dots$ je posloupnost bodů v metrickém prostoru $\mathcal{X} = (X, \varrho)$. Říkáme, že tato \emph{posloupnost konverguje k bodu} $x \in X$, jestliže ke každému reálnému číslu $\epsilon > 0$ lze najít takové přirozené čislo $N(\epsilon)$, že okolí $O_\epsilon(x)$ obsahuje všechny body $x_n$, kde $n \geq N(\epsilon)$. Bod $x$ se nazývá \emph{limita posloupnosti} $\{x_n\}$.

Nebo: Posloupnost $\{x_n\}$ konverguje k bodu $x$, jestliže

$$\lim\limits_{n\to \infty} \varrho(x, x_n) = 0 $$

Žádná posloupnost nemůže mít dvě různé limity. Jestliže posloupnost $\{x_n\}$ konverguje k bodu $x$, potom každá posloupnost vybraná z této posloupnosti konverguje k témuž bodu.

\begin{veta}
Aby bod $x$ byl bodem uzávěru množiny $M$, je nutné a stačí, aby existovala posloupnost $\{x_n\}$ bodů množiny $M$ konvergující k $x$.
\end{veta}

Nechť $A$ je podmnožina metrického prostoru $\mathcal{X}$. Množinu $A$ nazýváme hustotou v $\mathcal{X}$, jestliže $\overline{A} = \mathcal{X}$.

Například množina racionálních čísel je hustá na číselní přímce.

Metrický prostor $\mathcal{X}$, který obsahuje \emph{spočetnou} množinu, se nazývá \emph{separabilní}.

Příklady separabilních metrických prostorů:
\begin{itemize}
	\item Diskrétní metrická prostor je separabilní, právě když je spočetný. V tomto prostoru je $\overline{M}$ libovolné množiny $M$ totožný s množinou $M$.
	\item V metrickém prostoru $\mathbb{R}^1$ je hustou množinou množina racionálních čísel.
	\item V metrickém prostorech $\mathbb{R}^n$, $\mathbb{R}^n_0$ je hustou množinou množina vektorů s racionálními souřadnicemi.
	\item V metrickém prostorech $C^0\left<a, b\right>$ a $C_2^0\left<a, b\right>$ je hustou množinou množina polynomů s racionálními koeficienty.
	\item V metrickém prostorech $l_2$ je hustou množinou množina všech posloupností $\{x_n\}$. kde $x_n$ jsou racionální čísla, přičemž počet čísel $x_n$ různých od nuly je pouze konečný a pro různé posloupnost obecně různý.
\end{itemize}

Příklad neseparabilního prostoru: Metrický prostor $M^\infty$ všech ohraničených posloupností není separabilní.

\section{Spojitá zobrazení. Homeomorfismus. Izometrické zobrazení}
\begin{mydef}
Nechť $\mathcal{X} = (X, \varrho)$ a $\mathcal{Y} = (Y, \varrho^*)$ jsou dva různé metrické prostory. Zobrazení $f: \mathcal{X} \to \mathcal{Y}$ prostoru $\mathcal{X}$ do prostoru $\mathcal{Y}$ se nazývá spojité v bodě $x_0 \in X$, jestliže k libovolnému $\epsilon > 0$ lze najít takové $\delta > 0$, že pro všechny body $x$ s vlastností $\varrho(x, x_0) < \delta$ platí
$$\varrho^*(f(x), f(x_0)) < \epsilon$$
\end{mydef}

Zobrazení $f: \mathcal{X} \to \mathcal{Y}$ se nazývá spojité, jestliže je spojité ve všech bodech prostoru $\mathcal{X}$.

Je-li $\mathcal{Y}$ číselná přímka, potom spojité zobrazení $\mathcal{X}$ do $\mathcal{Y}$ se nazývá spojitou funkcí na $\mathcal{X}$.

\begin{veta}
Zobrazení $f: \mathcal{X} \to \mathcal{Y}$ je spojité v bodě $x$, právě když pro libovolnou posloupnost $\{x_n\}$, která konverguje k bodu $x$, konverguje posloupnost $\{f(x_n)\}$ k bodu $y = f(x)$.
\end{veta}

\begin{veta}
Aby zobrazení $f: \mathcal{X} \to \mathcal{Y}$ bylo spojité, je nutné a stačí, aby vzor vzhledem k $f$ každé uzavřené množiny z $\mathcal{Y}$ byla uzavřená množina v $\mathcal{X}$.
\end{veta}

\begin{veta}
Aby zobrazení $f: \mathcal{X} \to \mathcal{Y}$ bylo spojíté, je nutné a stačí, aby vzor každé otevřené množiny z $\mathcal{Y}$ byla otevřená množina.
\end{veta}

\begin{veta}
Nechť $\mathcal{X}, \mathcal{Y}, \mathcal{Z}$ jsou metrické prostory a $f: \mathcal{X} \to \mathcal{Y}$, $\varphi: \mathcal{Y} \to \mathcal{Z}$ spojitá zobrazení. Potom zobrazení $z = \varphi(f(x))$ metrického prostoru $\mathcal{X}$ do metrického prostoru $\mathcal{Z}$ je spojité.
\end{veta}

\begin{mydef}
Zobrazení $f$ se nazývá homeomorfismus, je-li vzájemně jednoznačné a jak zobrazení tak k němu inverzní zobrazení $f^{-1}$ jsou spojitá.

Metrické prostory $\mathcal{X}$ a $\mathcal{Y}$ se nazývají homeomorfní, existuje-li mezi nimi homeomorfní zobrazení.
\end{mydef}

\begin{veta}
Aby vzájemně jednoznačné zobrazení bylo homeomorfní, je nutné a stačí, aby uzavřené (otevřené) množiny odpovídaly uzavřeným (otevřeným) množinám.
\end{veta}

\begin{mydef}
Říkáme, že vzájemně jednoznačné zobrazení $y = f(x)$ metrického prostoru $\mathcal{X} = (X, \varrho)$ na metrický prostor $\mathcal{Y} = (Y, \varrho^*)$ je izometrické, jestliže

$$ \varrho(x_1, x_2) = \varrho^*(f(x_1), f(x_2)) \quad \forall x_1, x_2 \in X $$

Samotné metrické prostory $\mathcal{X}$ a $\mathcal{Y}$ mezi kterými je možno stanovit izometrické zobrazení se nazývají izometrickými mezi sebou.
\end{mydef}

\section{Úplné metrické prostory}

Číselná osa

\begin{mydef}
Posloupnost $\{x_n\}$ bodů metrického prostoru $\mathcal{X}$ budeme nazývat \emph{cauchyovskou} (nebo \emph{fundamentální}), jestliže splňuje Caughyovo kritérium, tj. jestliže ke každému $\epsilon > 0$ existuje takové kladné celé číslo $N(\epsilon)$, že
$$ \forall m,n \geq N(\epsilon) \quad \varrho(x_m, x_n) < \epsilon $$
\end{mydef}

\begin{mydef}
Jestliže v metrickém prostoru $\mathcal{X}$ libovolná cauchyovská posloupnost konverguje (tj. existuje $x \in \mathcal{X}$ tak, že $\varrho(x_n, x) \to 0$), potom nazýváme tento prostor \emph{úplný}.
\end{mydef}

Příklady:
\begin{enumerate}
	\item V diskrétním metrickém prostoru jsou cauchyovské pouze stacionární posloupnosti, tj. takové, v nichž se od určitého indexu stále opakuje tentýž bod. Každá taková posloupnost ovšem konverguje, tj. tento prostor jeúplný.
	\item Úplnost prostoru $\mathbb{R}^1$, tj. úplnost množiny všech reálných čísel je známa z matematická analýzy.
	\item Úplnost euklidovského prostoru $\mathbb{R}^n$ plyne snadno z úplnost prostoru $\mathbb{R}^1$: Nechť $\{x^{(p)}\}$ je cauchyovská posloupnost bodů
	$$ x^{(p)} = (x^{(p)}_1, x^{(p)}_2, \dots, x^{(p)}_n) \in \mathbb{R}^n, p = 1, 2, \dots $$
	\item Úplnost prostorů $\mathbb{R}^n_0, \mathbb{R}^n_1$ lze ukázat obdobně.
	\item Také metrické prostory $C^0 \left<a, b \right>, l_2$ a $M^\infty$ jsou úplné.
	\item Prostor $C_2^0 \left<a, b \right>$ není úplný.
\end{enumerate}

Není-li metrický prostor $\mathcal{X}$ úplný, pak jej lze vždy vnořit do úplného prostoru $\mathcal{X}^*$. Přesněji, existuje (až na izometrii) jediný úplný prostor $\mathcal{X}^*$ takový, že $\mathcal{X}$ je podprostor prostoru $\mathcal{X}^*$ a $\mathcal{X}$ je v $\mathcal{X}^*$ hustý.

\section{Banachův princip pevného bodu (BPPB}

\begin{mydef}
Nechť $\mathcal{X} = (X, \varrho)$ je metrický prostor. Zobrazení $A$ prostoru $\mathcal{X}$ do prostoru $\mathcal{X}$ se nazývá \emph{kontraktivní} (neboli kontrakce), existuje-li takové číslo $\alpha < 1$, ž epro libovolné dva body $x, y \in X$ platí nerovnost
$$\varrho(Ax, Ay) \leq \alpha \varrho(x, y)$$
\end{mydef}

\begin{veta}
Každé kontraktivní zobrazení je spojité.
\end{veta}

\begin{mydef}
Bod $x$ se nazývá \emph{pevný bod} zobrazení $A$, jestliže $Ax$ = x. Jinak řečeno, pevné body jsou řešení rovnice $Ax = x$.
\end{mydef}

\begin{veta}
(BPPB) Každé kontraktivní zobrazení definované v neprázdném úplném metrickém prostoru $\mathcal{X}$ má právě jeden pevný bod.
\end{veta}

\section{Aplikace BPPB}
BPPB lze použít k důkazu vět o existenci a jednoznačnosti řešení pro rovnice různých typů. Kromě důkazu existence a jednoznačnosti řešení rovnice $Ax = x$ dává BPPB také praktickou metodu přibližného výpočtu tohoto řešení (nazývanou metoda postupných aproximací).




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Normované a unitární prostory} \label{cha:13}

1. semestr, MAT, \texttt{Zaklady\_funkcionalni\_analyzy\_opr.pdf}, 7. -  11. kapitola

(základní vlastnosti a příklady, normované prostory konečné dimenze, uzavřené ortonormální systémy a Fourierovy řady)

\section{Definice, příklady}

\begin{mydef}
Nechť $\mathcal{L}$ je neprázdná množina prvků $x, y, z, \dots$ a nechť je splněno těchto osm podmínek:
\begin{enumerate}[I.]
	\item $\mathcal{L}$ je komutativní grupa, tj. ke každým dvěma prvkům $x, y \in \mathcal{L}$ je jednoznačně přiřazen třetí prvek ležící v $\mathcal{L}$, který je nazývaný jejich součet a označovaný $x + y$, přičemž platí tyto čtyři axiomy:
	\begin{enumerate}[1.]
		\item $x + y = y + x$ (komutativita)
		\item $x + (y + z) = (x + y) + z$ (asociativita)
		\item v $\mathcal{L}$ existuje takový prvek (značíme jej $\theta$), že $x + \theta = x$ pro všechny prvky $x \in \mathcal{L}$ (existence nulového prvku)
		\item Ke každému prvku $x \in \mathcal{L}$ existuje prvek, který značíme $-x$, takový, že $x + (-x) = \theta$ (existence opačného prvku)
	\end{enumerate}
	\item Ke každému číslu $\alpha$ nějakého číselného tělesa $T$ a ke každému prvku $x \in \mathcal{L}$ je jednoznačně přiřazen prvek $\alpha x \in \mathcal{L}$ (tzv. součin prvku $x$ a čísla $\alpha$), přičemž platí tyto dva axiomy:
	\begin{enumerate}[1.]
		\item $\alpha(\beta x) = (\alpha \beta) x \quad \alpha, \beta \in T, x \in \mathcal{L}$
		\item $1 \cdot x = x \quad 1 \in T, x \in \mathcal{L}$
	\end{enumerate}
	\item Obě operace (tj. sčítání prvků a násobení prvku číslem) jsou svázány těmito dvěma zákony:
	\begin{enumerate}[1.]
		\item $(\alpha + \beta) x = \alpha x + \beta x, \quad \alpha, \beta \in T, x \in \mathcal{L}$
		\item $\alpha (x + y) = \alpha x + \beta x, \quad \alpha \in T, x, y \in \mathcal{L}$
	\end{enumerate}
\end{enumerate}
Množinu $\mathcal{L}$ potom nazýváme \emph{lineárním nebo vektorovým prostorem} nad číselným tělesem $T$. Podle toho, zde čísly $\alpha, \beta, \dots$ rozumíme komplexní čísla, resp. reálná čísla, mluvíme krátce o \emph{komplexním}, resp. \emph{reálném prostoru}. Prvky lineárního prostoru $\mathcal{L}$ nazýváme \emph{body} nebo \emph{vektory}, kdežto čísla $\alpha, \beta, \dots$ nazýváme \emph{skaláry}.
\end{mydef}

\begin{mydef}
Lineární prostor $\mathcal{L}$ se nazývá \emph{normovaný}, jestliže každému prvku $x \in \mathcal{L}$ je přiřazeno reálné nezáporné číslo $||x||$, které se nazývá \emph{norma} prvku $x$, přičemž pro každé $x, y \in \mathcal{L}$ a $ \alpha \in T$ platí:
\begin{enumerate}
	\item $||x|| = 0$ když a jen když $x = \theta$
	\item $||\alpha x|| = |\alpha| \cdot ||x||$ (homogenita)
	\item $||x + y|| \leq ||x|| + ||y||$ (trojúhelníková nerovnost)
\end{enumerate}
Protože se zabýváme pouze lineárními prostory, budeme lineární normované prostory stručně nazývat \emph{normovanými prostory}.
\end{mydef}

Snadno je vidět, že každý lineární normovaný prostor i každá jeho podmnožina je současně metrickým prostorem.

\begin{mydef}
\emph{Úplný} lineární normovaný prostor se nazývá \emph{Banachovým prostorem}.
\end{mydef}

Příklady lineárních normovaných prostorů:
\begin{enumerate}
	\item Číselné těleso $T$ je normovaný prostor (nad $T$) s normou danou absolutní hodnotou. Např. reálná osa $\mathbb{R}^1$, tj. množina všech reálných čísel s obvyklými aritmetickými operacemi sčítání a násobení, je lineárním prostorem. Prostor $\mathbb{R}^1$ se stane normovaným prostorem jestliže pro každé číslo $x \in \mathbb{R}^1$ položíme $||x|| := |x|$.
	\item Množina všech uspořádaných $n$-tic reálných, popřípadě komplexních čísel $x = (x_1, x_2, \dots)$, kde sčítání $n$-tic a násobení $n$-tic konstantou je definováno vztahy
	$$(x_1, x_2, \dots, x_n) + (y_1, y_2, \dots, y_n) = (x_1 + y_1, x_2 + y_2, \dots, x_n + y_n) $$
	$$\alpha (x_1, x_2, \dots, x_n) = (\alpha x_1, \alpha x_2, \dots, \alpha x_n) $$
	je lineárním prostorem, který budeme nazývat \emph{n-rozměrným prostorem}. Jde-li o n-tice reálných čísel a jsou-li multiplikativní konstanty také reálná čísla, budeme mluvit o \emph{reálném n-rozměrném prostoru} a používat označení $\mathbb{R}^n$.
	Normu v reálném n-rozměrném prostoru $\mathbb{R}^n$ s prvky $x = (x_1, x_2, \dots, x_n) $ definujeme předpisem
	$$||x||_2 = \sqrt{\sum\limits_{k = 1}^n x_k^2}$$
	V lineárním prostoru $\mathbb{R}^n$ lze definovat normu také předpisem
	$$||x||_1 = \sum\limits_{k = 1}^n |x_k|$$
	nebo
	$$||x||_0 = \max\limits_{1 \leq k \leq n}^n |x_k|$$
	V komplexním n-rozměrném prostoru $\mathbb{C}^n$ je potřeba  použít explicitní absolutní hodnotu. Nebo obecně:
	$$||x||_p = \left( \sum\limits_{k = 1}^n |x_k|^p \right)^\frac{1}{p}$$
	\item Množina všech spojitých reálných funkcí reálné proměnné na intervalu $\left<a, b\right>$ (popř. spojitých komplexních funkcí reálné proměnné) s běžnými operacemi sčítání funkcí a násobení funkce číslem je reálný (popř. komplexní) lineární prostor, která je jedním z nejdůležitějších v matematické analýze. Značíme jej $\mathbb{C}^0\left<a,b\right>$ nebo zkráceně $\mathbb{C}\left<a,b\right>$. V prostoru $\mathbb{C}^0\left<a,b\right>$ definujeme normu vztahem
	$$||f|| = \max\limits_{a \leq t \leq b} |f(t)|$$
	\item Nechť $\mathbb{C}_2^0\left<a,b\right>$ opět sestává ze všech spojitých funkcí, ale norma je definována vztahem
	$$||f|| = \left( \int_a^b [f(t)]^2 dt \right)^\frac{1}{2}$$
	\item Prostor $l_2$ všech posloupností $x = \{x_k\}_{k=1}^\infty$, které splňují podmínku
	$$\sum\limits_{k=1}^\infty |x_k|^2 < + \infty$$
	se stane lineárním normovaným prostorem, definujeme-li, že součet dvou prvků $x = (x_1, x_2, \dots, x_n, \dots)$ a $y = (y_1, y_2, \dots, y_n, \dots)$ z $l_2$ je roven
	$$x + y = (x_1 + y_1, x_2 + y_2, \dots, x_n + y_n, \dots)$$
	a že součin čísla $\alpha$ a prvku $x \in l_2$je dán vztahem
	$$\alpha x = (\alpha x_1, \alpha x_2, \dots, \alpha x_n, \dots)$$
	Normu v $l_2$ definujeme vztahem
	$$||x|| = \sqrt{\sum\limits_{k = 1}^\infty |x_k|^2}$$
	\item Prostor $c$ se sestává ze všech konvergentních posloupností. Prostor $c_0$ se sestává z posloupností $x = (x_1, x_2, \dots, x_n, \dots)$ reálných čísel, které splňují podmínku $\lim\limits{n \to \infty} = 0$. Sčítání prvků a násobení prvků skalárem se definují v prostorech $c$ a $c_0$ stejně jako v předchozím příkladě a norma je dána $||x|| = \max\limits_{1 \leq n \infty} |x_n|$
	\item Množina $M^\infty$ všech ohraničených posloupností $x = \{x_k\}_{k=1}^\infty$ reálných (popř. komplexních) čísel s týmž operacemi jako v předchozích příkladech je lineární prostor. Normu v něm můžeme zavést vztahem $||x|| = \sup\limits_{1\leq n\leq \infty} |x_n|$
\end{enumerate}
Všechny příklady s výjimkou prostoru $\mathbb{C}_2^0\left<a,b\right>$ jsou Banachovými prostory.

\begin{mydef}
(Lineární nezávislost) Množina vektorů $\{x_1, x_2, \dots, x_n\}$ se nazývá lineárně závislá, jestliže existují konstanty $\alpha_1, \dots, \alpha_n$, z nichž aspoň jedna je různá od nuly a platí

$$\alpha_1 x_1 + \alpha_2 x_2 + \dots + \alpha_n x_n = \theta$$

V opačném případě se tato množina nazývá lineárně nezávislá. Jinak řečeno, množina se nazývá lineárně nezávislá, jestliže z předchozí rovnosti plyne, že $\alpha_1 = \alpha_2 = \dots = 0$.

Nekonečná podmnožina prostoru $\mathcal{L}$ se nazývá \emph{lineárně nezávislá}, jestliže každá její konečná množina je lineárně nezávislá.

Výraz $\alpha_1 x_1 + \alpha_2 x_2 + \dots + \alpha_n x_n$ nazýváme lineární kombinací prvků $x_1, x_2, \dots, x_n$.

Jestliže v prostoru $\mathcal{L}$ lze najít $n$ lineárně nezávislých prvků, ale libovolné $n+1$ prvky jsou již lineárně závislé, říkáme, že prostor $\mathcal{L}$ má \emph{dimenzi (rozměr)} $n$. Jestliže v prostoru $\mathcal{L}$ lze nalézt nekonečný systém lineárně nezávislých prvků, říkáme, že prostor $\mathcal{L}$ má nekonečnou dimenzi.

\emph{(Lineární) bází v n-rozměrném prostoru $\mathcal{L}$} nazýváme libovolný systém $n$ lineárně nezávislých prvků. Prostory $\mathbb{R}^n$ v reálném případě a $\mathbb{C}^n$ v komplexním případě mají dimenzi $n$.
\end{mydef}

Každý z předchozích příkladů má nekonečnou dimenzi.

\begin{mydef}
(Podprostory lineárního prostoru) Neprázdná podmnožina $\mathcal{L}^*$ lineárního prostoru $\mathcal{L}$ se nazývá \emph{podprostor} prostoru $\mathcal{L}$, jestliže sama tvoří lineární prostor vzhledem k operacím sčítání prvků a násobení skalárem, které jsou definovány v prostoru $\mathcal{L}$. Jinak řečeno, $\mathcal{L}^* \subset \mathcal{L}^*$ je podprostor, jestliže
$x,y \in \mathcal{L}^* \Rightarrow \alpha x + \beta y \in \mathcal{L}^*$
pro libovolná čísla $\alpha, \beta$.

V každém lineárním prostoru $\mathcal{L}$ existuje podprostor, který se skládá pouze z nulového prvku $\theta$ a nazývá se \emph{nulový podprostor}. Také celý prostor $\mathcal{L}$ lze považovat za podprostor prostoru $\mathcal{L}$. Podprostor různý od prostoru $\mathcal{L}$ a obsahující aspoň jeden nenulový prvek se nazývá \emph{vlastní podprostor}.
\end{mydef}

\begin{mydef}
Průnik libovolného systému $\{\mathcal{L}_\gamma\}$ podprostorů lineárního prostoru $\mathcal{L}$ je zřejmě opět podprostor.
(Jestliže $\mathcal{L}^* = \bigcap\limits_\gamma \mathcal{L}_\gamma$ a $x, y \in \mathcal{L}^*$, potom také $\alpha x + \beta y \in \mathcal{L}^*$ pro všechna čísla $\alpha, \beta$.
Nechť  $\{x_\alpha\}$ je libovolná neprázdná množina prvků lineárního prostoru $\mathcal{L}$. Průnik všech podprostorů obsahující množinu $\{x_\alpha\}$ nazveme \emph{podprostorem vytvořeným (generovaným) množinou} $\{x_\alpha\}$ nebo \emph{lineárním obalme množiny} $\{x_\alpha\}$. Tento podprostor budeme označovat $L\{x_\alpha\}$. Je to nejmenší podprostor obsahující množinu $\{x_\alpha\}$.
\end{mydef}

\section{Normované prostory konečné dimenze}

Každý lineární prostor $X(n)$ konečné dimenze $n$ je izomorfní s euklidovským prostorem $\mathbb{R}^n$, a proto můžeme považovat prvky uvažovaného prostoru $X(n)$ za n-tice reálných čísel.

\begin{veta}
(Riesz) Nechť $X(n)$ je normovaný prostor konečné dimenze $n$. Aby posloupnost
$\{x_\nu = (\xi_1^{(\nu)}, \xi_2^{(\nu)}, \dots, \xi_n^{(\nu)})$,
konvergovala k prvku
$x_0 = (\xi_1^{(0)}, \xi_2^{(0)}, \dots, \xi_n^{(0)}) \in X(n)$, je nutné a stačí, aby
$\xi_k^{(\nu)} \to \xi_k^{(0)} (k = 1, 2, \dots, n).$
\end{veta}

\begin{lemma}
Je-li posloupnost $\{x_\nu\}$ ohraničená, potom je ohraničená i každá posloupnost $\{\xi_k^{(\nu)} (k = 1, 2, \dots, n)$.
\end{lemma}

Důsledek: Každý normovaný prostor konečné dimenze je úplný.

\section{Hilbertovy prostory}
\subsection{Unitární prostory a jejich základní vlastnosti}

\begin{mydef}
Skalárním součinem v reálném lineárním prostoru $R$ nazýváme zobrazení $(-, -): R \to \mathbb{R}$, tedy reálnou funkci $(x, y)$ definovanou pro každou dvojici prvků $x, y \in R$, která splňuje tyto čtyři podmínky ($x, x_1, x_2, y \in R, \lambda $ je reálné číslo):
\begin{enumerate}
	\item $(x, y) = (y, x)$
	\item $(x_1 + x_2, y) = (x_1, y) + (x_2, y)$
	\item $(\lambda x, y) = \lambda(x, y)$
	\item $(x, x) \geq 0$, přičemž $(x,x) = 0$, když a jen když $x = \theta$.
\end{enumerate}
\end{mydef}

\begin{mydef}
Lineární prostor, v němž je definován skalární součin se nazývá \emph{unitární prostor}. V unitárním prostoru $R$ se norma zavádí vztahem
$||x|| = \sqrt{(x, x)}$
\end{mydef}

Množina $\{ x_\alpha \}$ nenulových vektorů $x_\alpha \in R$ se nazývá \emph{ortogonální} soustava, jestliže
$(x_\alpha, x_\beta) = 0$ pro $\alpha \not= \beta$

Soustava nenulových vektorů $x_\alpha \in R$ se nazývá \emph{ortonormální}, jestliže
$$(x_\alpha, x_\beta) = \begin{dcases}
0 \text{ pro } \alpha \not= \beta \\
1 \text{ pro } \alpha = \beta
\end{dcases}$$

Je zřejmé, že je-li $\{x_\alpha\}$ ortogonální soustava, potom $\{x_\alpha / ||x_\alpha|| \}$ je ortonormální soustava. Úplná ortonormální soustava se nazývá ortonormální báze.

\begin{veta}
Je-li $\{x_\alpha\}$ ortogonální soustava, jsou vektory $x_\alpha$ lineárně nezávislé.
\end{veta}

\begin{mydef}
Množina $\{x_\alpha\} \in R$ se nazývá úplný systém vektorů, jestliže uzávěr podprostoru generovaného množinou $\{x_\alpha\}$ je celý prostor $R$. Je-li $\{x_\alpha\}$ navíc ortogonální (ortonormální) soustavou, nazýváme ji \emph{ortogonální (ortonormální) báze}.
\end{mydef}

Pokud má prostor $R$ konečnou dimenzi, pak je každá jeho ortogonální báze (lineární) bází. Ovšem toto neplatí pro prostory nekonečné dimenze, neboť báze vygeneruje pouze hustou podmnožinu v prostoru $R$, což nemusí být celý prostor $R$.

Příklad: Konečně rozměrný prostor $\mathbb{R}^n$, jehož prvky jsou všechny n-tice reálných čísel
$x = (x_1, x_2, \dots, x_n)$,
s obvyklými operacemi sčítání n-tic a násobení konstantou a se skalárním součinem
$(x, y) = \sum\limits_{i = 1}^n x_i y_i$
je dobře známým příkladem unitárního prostoru (Takto zavedený skalární součin definuje v prostoru $\mathbb{R}^n$ normu $||x||_2 = \sqrt{\sum\limits_{k=1}^n x_k^2}$,
a tedy tvoří euklidovskou metriku.). Ortonormální bázi tohoto prostoru (jednu z nekonečně mnoha možných) tvoří vektory
$ e_1 = (1, 0, \dots, 0) $,
$ e_2 = (0, 1, \dots, 0) $,
\dots,
$ e_n = (0, 0, \dots, 1) $.

Prostor $l_2$ s prvky
$x = (x_1, x_2, \dots, x_n, \dots)$, kde $\sum\limits_{i=1}^\infty x_i^2 < + \infty$
a se skalárním součinem $(x, y) = \sum\limits_{i=1}^\infty x_i y_i$
je unitární prostor. Nejjednodušší ortonormální bázi v prostoru $l_2$ tvoří vektory
$ e_1 = (1, 0, 0, \dots) $,
$ e_2 = (0, 1, 0, \dots) $,
$ e_n = (0, 0, 1, \dots) $,
\dots.
Ortogonálnost a normovanost této soustavy jsou zřejmé; soustava je úplná. Nechť $x = (x_1, x_2, \dots, x_n, \dots)$ je libovolný vektor prostoru $l_2$ a $x^{(n)} = (x_1, x_2, \dots, x_n, 0, 0, \dots)$. Potom $x^{(n)}$ je lineární kombinace vektorů $e_1, \dots, ,e_n$ a $||x^{(n)} - x|| \to 0$ pro $n \to \infty$.
Tedy každý prvek v $l_2$ leží v uzávěru vygenerovaného prostoru. Ovšem soustava vektorů $e_n$ netvoří bázi prostoru $l_2$, neboť prostor generovaný touto soustavou obsahuje pouze posloupnosti, které mají pouze konečný počet členů (jedná se o prostor polynomů $\mathbb{R}[X]$).

Prostor $C_2^0 \left<a,b\right>$ všech spojitých reálných funkcí definovaných na intervalu $\left<a, b\right>$ se skalárním součinem definovaným vztahem $(f,g) = \int_a^b f(t)g(t) dt$ je také unitární prostor, ale neúplný. Mezi různými ortogonálními bázemi, které lze v něm uvést je nejdůležitější soustava trigonometrických funkcí
$1$, $\cos\frac{2\pi nt}{b-a}$, $\sin\frac{2\pi nt}{b-a}$, $n=1, 2, \dots$.
Má-li interval $\left<a,b\right>$ délku $2\pi$, např. je-li $a=-\pi, b = \pi$, potom příslušná trigonometrická soustava je 
$1$, $\cos nt$, $\sin nt$, $n=1, 2, \dots$.

\section{Existence ortogonálních bází, ortogonalizace}
Každý z prostorů uvedených v předchozí kapitole je separabilní.
\begin{veta}
Nechť $R$ je separabilní unitární prostor. V takovém prostoru je každá ortogonální systém nejvýše spočetný.
\end{veta}

\begin{veta}
(Schmidtova věta o ortogonalizaci). Nechť
$f_1, f_2, \dots, f_n, \dots$
je lineárně nezávislý systém prvku v unitárním prostoru $R$. Potom v prostoru $R$ existuje systém prvků
$\varphi_1, \varphi_2, \dots, \varphi_n, \dots$,
který splňuje tyto podmínky:
\begin{enumerate}
	\item Systém je ortonormální
	\item Každý prvek $\varphi_n$ je lineární kombinace prvků $f_1, f_2, \dots, f_n$, že
		$\varphi_n = a_{n1}f_1 + \dots + a_{nn} f_n$, přičemž $a_{nn} \not= 0$.
	\item Každý prvek $f_n$ lze vyjádřit ve tvaru $f_n = n_{n1} \varphi_1 + \dots + b_{nn} \varphi_n$, přičemž $b_{nn} \not= 0$
\end{enumerate}
Každý prvek systému je určen podmínkami 1 - 3 až na znaménko jednoznačně.
\end{veta}

Přechod od systému $f_n$ k systému $\varphi_n$, který splňuje podmínky 1 - 3 se nazývá \emph{ortonormalizace}.
Je zřejmé, že prostory vytvořené výše zmíněnými systémy jsou totožné, takže je-li jeden z těchto systémů úplný v prostoru $R$, je úplný v prostoru $R$ i druhý.

Důsledek: V separabilním unitárním prostoru R existuje ortonormální báze.

\section{Besselova nerovnost. Uzavřené ortogonální systémy}

Je-li $e_1, e_2, \dots, e_n$ ortonormální báze n-rozměrného unitárního prostoru $\mathbb{R}^n$, potom vektor $x \in \mathbb{R}^n$ lze zapsat ve tvaru
$x = \sum\limits_{k=1}^n c_k e_k$, kde $c_k = (x, e_k)$.

Nechť $\varphi_1, \varphi_2, \dots, \varphi_n, \dots$
je ortonormální systém v unitárním prostoru $R$ a $f$ je libovolný prvek v prostoru $R$. Přiřadíme prvku $f \in R$ posloupnost čísel
$c_k = (f, \varphi_k), k = 1, 2, \dots$
které budeme nazývat \emph{souřadnicemi} nebo \emph{Fourierovými koeficienty prvku $f$ vzhledem k systému $\{\varphi_k\}$},
a funkční řadu $\sum\limits_{k=1}^n c_k \varphi_k$ kterou nazveme \emph{Fourierovou řadou prvku $f$ vzhledem k systému $\{\varphi_k\}$}.

Dá se ukázat, že řada $\sum\limits_{k=1}^\infty c_k \varphi_k^2$  konverguje a platí
$\sum\limits_{k=1}^\infty c_k^2 \leq ||f||^2$.

Uvedenou nerovnost nazýváme \emph{Besselovou nerovností}.

\begin{mydef}
Ortonormální systém se nazývá \emph{uzavřený}, jestliže mezi každým vektorem $f \in R$ a jeho Fourierovými koeficienty $c_k$ platí tzv. \emph{Parsevalova rovnost}:

$$\sum\limits_{k=1}^\infty c_k^2 = ||f||^2$$
\end{mydef}

Uzavřenost systému je ekvivalentní s tím, že pro každý vektor $f \in R$ konverguje posloupnost částečných součtů Fourierovy řady $\sum{k=1}^n c_k \varphi_k$ k prvku $f$. Pojem uzavřenosti ortonormálního systému úzce souvisí s dříve zavedeným pojmem úplnosti systému:

\begin{veta}
V separabilním unitárním prostoru $R$ je každý úplný ortonormální systém uzavřený a naopak.
\end{veta}

Nechť $\{\varphi_n\}$ je libovolný ortogonální systém. Vzhledem k němu lze sestrojit normovaný systém, vytvořený z prvků $\psi_n = \varphi_n/||\varphi_n||$. Pro libovolný prvek $f \in R$ platí
$c_n = (f, \psi_n) = \frac{1}{||\varphi_n||}(f, \varphi_n)$ a 
$\sum_{n=1}^\infty c_n \psi_n = \sum_{n=1}^\infty \frac{c_n}{||\varphi_n||} = \sum_{n=1}^\infty a_n \varphi_n$, kde
$$a_n = \frac{c_n}{||\varphi_n||} = \frac{(f,\varphi_n)}{||\varphi_n||^n}$$

Koeficienty $a_n$ nazveme \emph{Fourierovými koeficienty v ortogonálním (nenormovaném) systému $\{\varphi_n\}$}. Dosadíme-li do Besselovy nerovnosti za $c_n$, dostaneme
$$\sum\limits_{n=1}^\infty ||\varphi_n||^2a_n^2 \leq ||f||^2$$
což je Besselova nerovnost pro libovolný ortogonální systém.

Příklad: Uvažujme v unitárním prostoru $C_2^0\left<-\pi, \pi\right>$ všech spojitých funkcí na intervalu $\left<-\pi, \pi\right>$ se skalárním součinem daným vztahem $(f, g) = \int_{-\pi}^\pi f(t) g(t) dt$ úplný ortogonální systém goniometrických funkcí, tedy systém
$1, \cos nt, \sin nt, n = 1, 2, \dots$

Tento systém není ortonormální, k němu příslušný ortonormální systém tvoří funkce
$\frac{1}{\sqrt{2\pi}}, \frac{\cos nt}{\sqrt{\pi}}, \frac{\sin nt}{\sqrt{\pi}}, n = 1, 2, \dots$

Nechť $f$ je funkce z prostoru $C_2^0\left<-\pi, \pi\right>$. Fourierovy koeficienty této funkce vzhledem k systému $1, \cos nt, \sin nt$ se většinou značí $\frac{a_0}{2}, a_n$ a $b_n$.
V souladu s obecnými vzorci pro Fourierovy koeficienty tedy máme
$$\frac{a_0}{2} = \frac{1}{2 \pi} \int_{-\pi}^\pi f(t) dt \dots a_0 = \frac{1}{\pi} \int_{-\pi}^\pi f(t) dt$$
$$a_n = \frac{1}{\pi} \int_{-\pi}^\pi f(t) \cos nt dt, b_n = \frac{1}{\pi} \int_{-\pi}^\pi f(t) \sin nt dt$$

Fourierova řada funkce $f$ vzhledem k systému goniometrických funkcí má tvar

$$\frac{a_0}{2} + \sum\limits_{n=1}^\infty (a_n \cos nt + b_n \sin nt)$$

a konverguje k $f$.

\begin{comment}
\section{Úplné unitární prostoru. Rieszova-Fischerova věta}

\begin{veta}
(Riesz-Fischer). Nechť $\{\varphi_n\}$ je libovolný ortonormální systém v úplném unitárním prostoru R a nechť čísla $c_1, c_2, \dots, c_n, \dots$ jsou taková, že řada
$$\sum\limits_{k=1}^\infty c_k^2$$
konverguje. Potom existuje takový prvek $f \in R$, že $c_k = (f, \varphi_k)$ a
$$\sum\limits_{k=1}^\infty (f, f) = ||f||^2$$
\end{comment}




















%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Obyčejné grafy} \label{cha:14}

1. semestr, MAT, \texttt{Grafy\_1\_141212.pdf}, \texttt{Grafy\_2\_141220.pdf}

(stupně uzlů, sledy, souvislost, izomorfismy, stromy, kostry, Kruskalův a Primův algoritmus pro hledání minimální kostry ohodnoceného grafu, eulerovské a hamiltonovské grafy, planarita a obarvitelnost)

\begin{mydef}
\textbf{Obyčejný graf} je dvojice $G=(U, H)$, kde $U$ je konečná množina uzlů (vrcholů) a $H \subseteq \left\{ \left\{u, v\right\}: u, v \in U \land u \not= v \right\}$ je (konečná) množina hran. O hraně $h = \{u, v\}$ říkáme, že je incidentní s uzly $u$ a $v$ nebo že je mezi uzly $u$ a $v$, spojuje uzly $u$ a $v$ a podobně.
\end{mydef}

\begin{mydef}
Je-li $G=(U, H)$ obyčejný graf, definujeme \textbf{sled} mezi uzly $u, v$ o délce $n$ jako posloupnost $(u=w_0, h_1, w_1, h_2, \dots, w_{n-1}, h_n, w_n = v$ takovou, že  $w_0, w_1, \dots, w_n \in U, h_1, h_2, \dots, h_n \in H$ a $h_1 = \{w_{i-1}m w_i\}, 1 \leq i \leq n$.
\end{mydef}
(ve sledu se mohou opakovat jak uzly, tak hrany)

\begin{mydef}
Je-li $G=(U, H)$ obyčejný graf, potom \textbf{tahem} mezi uzly $u, v$ o délce $n$ rozumíme sled $(u=w_0, h_1, w_1, h_2, \dots, w_{n-1}, h_n, w_n = v$ takový, že platí $i \not= j \Rightarrow h \not= h_j, 1 \leq i, j \leq n$.

Je-li navíc $w_0 = w_n$, pak se tento tah nazývá uzavřený.
\end{mydef}

(uzly se mohou opakovat, ale ne hrany)

\begin{mydef}
Je-li $G=(U, H)$ obyčejný graf, potom \textbf{cesta} mezi uzly  $u, v$ o délce $n$ je sled $(u=w_0, h_1, w_1, h_2, \dots, w_{n-1}, h_n, w_n = v$ mezi uzly $u, v$, takový, že platí $i \not= j \Rightarrow w_i \not= w_j, 0 \leq i, j \leq n$.
\end{mydef}

(v cestě jsou všechny uzly různé)

\begin{mydef}
Graf $G=(U, H)$ se nazývá \textbf{diskrétní}, resp. \textbf{úplný}, jestliže $H = \emptyset$, resp. $H=\{\{u, v\}, u, v \in U \land u \not= v\}$.
\end{mydef}

\begin{mydef}
Je-li $G=(U, H)$ obyčejný graf, kružnice v grafu $G$ o délce $n$ je sled $(w_0, h_1, w_1, h_2, \dots, w_{n-1}, h_n, w_n$ takový, že platí
$$ i \not= j \Rightarrow w_i \not=w_j, 0 \leq i,j \leq n -1 \land w_0 = w_n$$
\end{mydef}

\begin{veta}
Nechť $G=(U, H)$ obsahuje dvě různé kružnice
$C_1 = (u_0, g_1, u_1, g_2, \dots, u_{n-1}, g_n, u_n$ a
$C_2 = (v_0, h_1, v_1, h_2, \dots, v_{n-1}, h_n, v_n$,
kde $u_0 = v_0, u_1 = v_1, h_1 = g_1$. Potom tento podgraf obsahuje i kružnici $C_3$ neobsahující hranu $h_1 = g_1$.
\end{veta}

\begin{mydef}
Je-li $G=(U, H)$ obyčejný graf, řekneme, že je \textbf{souvislý}, když pro libovolné uzly $u, v \in U$ existuje sled $(u=w_0, h_1, w_1, h_2, \dots, w_{n-1}, h_n, w_n = v$.
\end{mydef}

\begin{mydef}
Jsou-li $G=(U, H)$ a $G'=(U', H')$ obyčejné grafy, řekneme, že $G'$ je \textbf{podgrafem grafu} $G$, když $U' \subseteq U \land H' \subseteq H$. Pokud navíc platí $(u, v \in U' \land \{u, v \} \in H) \Rightarrow \{u, v\} \in H'$, říkáme, že podgraf $G'$ je \textbf{indukovaný} (množinou uzlů $U'$). \textbf{Faktorem grafu} $G=(U, H)$ nazýváme takový jeho podgraf $G'=(U', H')$, pro který platí $U=U'$. 
\end{mydef}

\begin{mydef}
Jsou-li $G=(U, H)$ a $G'=(U', H')$ obyčejné grafy, řekneme, že $G'$ je \textbf{komponentou} grafu $G$, když $G'$ je souvislým indukovaným podgrafem grafu $G$ a pro libovolný obyčejný graf $G''=(U'', H'')$ platí: ($U' \subset U''$ a $G''$ je podgraf G) $\Rightarrow G''$ není souvislý.
\end{mydef}

\begin{mydef}
Je-li $G=(U, H)$ obyčejný graf a $h \in H$, pak řekneme, že hrana $h$ je \textbf{mostem}, když jejím odstraněním se zvýší počet komponent grafu.
\end{mydef}
(hrana je jedinou hranou mezi uzly $u, v$)

\begin{mydef}
Je-li $G = (u, H)$ obyčejný graf a $u \in U$, definujeme číslo $\text{deg}(u)$, tzv. \textbf{stupeň uzlu} $u$ jako počet hran incidentních s uzlem $u$.
\end{mydef}
Nechť $G=(U, H)$ je obyčejný graf, $|H|=m$. Snadno se dokáže, že platí $\sum\limits_{u \in U} \text{deg}(u) = 2 m$.

\begin{mydef}
Jsou-li $G_1=(U_1, H_1)$ a $G_2=(U_2, H_2)$ dva obyčejné grafy a $\varphi: U_1 \to U_2$ bijekce mezi množinami uzlů, řekneme, že $\varphi$ je \textbf{isomorfismus} $G_1$ na $G_2$, jestliže pro každé dva uzly $u, v \in H_1$ platí
$$ \{u, v\} \in H_1 \Leftrightarrow \{\varphi(u), \varphi(v)\} \in H_2$$
\end{mydef}

Isomorfismus sama na sebe se nazývá \textbf{automorfismus}.

\begin{mydef}
Obyčejný graf, jehož žádný podgraf není kružnice se nazývá \textbf{les}.
\end{mydef}

\begin{mydef}
Obyčejný \emph{souvislý} graf, jehož žádný podgraf není kružnicí, se nazývá \textbf{strom}.
\end{mydef}

\begin{veta}
Nechť $S=(U, H)$ je les, který má alespoň jednu hranu. Pak existují dva uzly $u, v \in U$ takové, že $\text{deg}(u) = \text{deg}(v) = 1$.
\end{veta}

\begin{veta}
Nechť $G=(U, H)$ obyčejný graf a $|U| = n, |H| = m$. Pak jsou následující podmínky ekvivalentní:
\begin{enumerate}[(a)]
	\item $G$ je strom
	\item $G$ je souvislý a $m = n-1$
	\item $G$ neobsahuje jako podgraf kružnici a $m=n -1$
	\item $G$ je souvislý a každá hrana je mostem
	\item mezi každou dvojicí různých uzlů v $G$ existuje jediná cesta
	\item $G$ neobsahuje kružnici a vznikne-li graf $G'$ přidáním libovolné hrany ke grafu $G$, $G'$ kružnici obsahuje.
	\item $G$ je souvislý, pro $n > 2$ je $G$ neúplný a vznikne-li graf $G'$ přidáním libovolné hrany ke grafu $G$, pak $G'$ obsahuje právě jednu kružnici.
\end{enumerate}
\end{veta}

\begin{mydef}
Je-li dán obyčejný graf $G=(U, H)$, pak jeho faktor $K = (U, H')$ nazveme \textbf{kostrou grafu} $G$, pokud je $K$ strom.
\end{mydef}

\begin{veta}
Nechť $G$ je obyčejný graf. $G$ je souvislý, právě když má kostru.
\end{veta}

\begin{veta}
Nechť $G=(U, H)$ je obyčejný graf a $|U|=n$. Pokud faktor $K=(U, H')$ grafu $G$ splňuje kterékoliv dvě z následujících podmínek, pak je \textbf{kostrou grafu}:
\begin{enumerate}
	\item $K$ je souvislý
	\item $|H'| = n-1$
	\item $K$ neobsahuje jako podgraf kružnici
\end{enumerate}
\end{veta}

\section{Oceněný graf}
\begin{mydef}
Nechť $G=(U, H)$ je obyčejný graf. Je-li navíc dáno zobrazení $c: H\to R$, potom trojici $G=(U, H, c)$ nazýváme \textbf{oceněným grafem}. Každé hraně $h$ grafu $G$ je tak přiřazeno reálné číslo $c(h)$, které se nazývá cenou hrany $h$. Je-li $G'=(U', H')$ podgraf grafu $G$, potom $c(G') = \sum\limits_{u \in H'} c(u)$ se nazývá cennou podgrafu $G'$.
\end{mydef}

\begin{mydef}
Nechť $G=(U, H, c)$ je obyčejný oceněný graf. Nechť $K=(U, H')$ je kostra grafu $G$. Řekneme, že $K$ je minimální kostra grafu $G$, jestliže platí $c(K) \leq c(L)$ pro každou kostru $L$ grafu $G$.
\end{mydef}

\begin{veta}
Nechť $G=(U, H, c)$ je obyčejný souvislý oceněný graf a nechť
$$C=(v, h_1, u_1, h_2, u_2, \dots, u_{p-1}, h_p, v), p \geq 3$$
je kružnice v grafu $G$. Jestliže platí $c(h_1) > c(h_i), 2 \leq i \leq p$, potom hrana $h_1$ není obsažena v žádní minimální kostře grafu $G$.
\end{veta}

Důsledek: Nechť $G=(U, H, c)$ je obyčejný souvislý oceněný graf a nechť
$$C=(v, h_1, u_1, h_2, u_2, \dots, u_{p-1}, h_p, v), p \geq 3$$
je kružnice v grafu $G$. Jestliže platí $c(h_1) \geq c(h_i), 2 \leq i \leq p$, potom existuje aspoň jedna minimální kostra, ve které není hrana $h_1$ obsažena.

(pokud hrany mohou mít stejné ceny. Pokud jsou všechny ceny hran rozdílné, existuje pouze jedna minimální kostra)

\paragraph{Kruskalův algoritmus}
Je dá oceněný obyčejný souvislý graf $G=(U, H, c)$, kde $|U| = n$ a $H = \{h_1, h_2, \dots, h_k\}$. Setřiďme hrany z $H$ do posloupnosti $S=(s_1, s_2, \dots, s_k)$ tak, že platí $c(s_i) \leq c(s_{j}$ pro $i<j$. Budeme nyní postupně vytvářet grafy $K_1=(U, Q_1), K_2=(U, Q_2), \dots K_{n-1} = (U, Q_{n-1})$ tak, aby platilo:
\begin{enumerate}[(a)]
	\item $Q_1 = \{s_1\}$
	\item Jestliže $Q_i = \{s_{j_1}, s_{j_2}, \dots, s_{j_i}\}$, kde $1 < i < n-1, c(s_{j_1}) \leq c(s_{j_2}) \leq \dots \leq c(s_{j_i})$, potom $Q_{i+1} = \{s_{j_1}, s_{j_2}, \dots, s_{j_i}, s_q\}$, kde $s_q$ je hrana z posloupnosti $S$ s nejmenším indexem $q$ taková, že $s_q \not= s_{j_k}, 1 \leq k \leq i$ a $K_{i+1}$ neobsahuje kružnici.
\end{enumerate}

\paragraph{Primův algoritmus}
Je-dán oceněný obyčejný souvislý graf $G=(U, H, c)$. Pro podgraf $K=(V, J)$ grafu $G$, který neobsahuje kružnici, označme $K^+ = (V^+, J^+)$ graf, který vznikne z grafu $K$ přidáním uzlu $u$ do $V$ a hrany $h$ do $J$ takové, že $h$ je incidentním uzlem $u$ a s nějakým uzlem ve $V$, nevytvoří v $K$ kružnici a přitom $h$ je hranou nejmenší ceny s takovouto vlastností. Sestrojíme postupně podgrafy $K_1, K_2, \dots, K_{n-1}$ následovně:
\begin{enumerate}[(a)]
	\item $K_1 = (\{u, v\}, \{\{u, v\}\})$ kde $c(\{u, v\}) \leq c(\{u, w\})$ pro všechna $w \in U$
	\item $K_{i+1} \overset{def}{=} K^+_i$ pro každé $i = 1, 2, \dots, n-2$
\end{enumerate}


\begin{veta}
Nechť $G = (U, H, c)$ je obyčejný oceněný souvislý graf a $\{u,v\} \in H$ hrana taková, že $c(\{u, v\}) < c(\{u, v\})$ pro každý uzel $w \in U$. Potom hrana $\{u, v\}$ leží v každé minimální kostře grafu $G$.
\end{veta}

\paragraph{Důsledek}: Nechť $G = (U, H, c)$ je obyčejný oceněný souvislý graf a $\{u, v \} \in H$ hrana taková, že $c(\{u, v\}) \leq c(\{u, w\})$ pro každý uzel $w \in U$. Potom existuje minimální kostra grafu $G$, ve které hrana $\{u, v\}$ leží.

\paragraph{Důsledek}: Nechť $G = (U, H, c)$ je obyčejný oceněný souvislý graf, $V \subseteq U, S = (V, H')$ je strom a nechť tento strom je podgrafem minimální kostry grafu $G$. Pak existuje minimální kostra grafu $G$, která obsahuje $S$ jako podgraf a navíc hranu $h$ s nejmenší cenou takovou, že $h = \{u, v\}, u \in V, v \in (U-V)$.

\paragraph{Maticová forma Primova algoritmu}
Pokud jsou ceny hran grafu $G=(U, H)$, kde $U=\{u_1, u_2, \dots, u_n\}$, zadány ve formě matice
$$
 \begin{pmatrix}
  c_{11} & c_{12} & \cdots & c_{1n} \\
  c_{21} & c_{22} & \cdots & c_{2n} \\
  \vdots  & \vdots  & \ddots & \vdots  \\
  c_{n1} & c_{n2} & \cdots & c_{nn} 
 \end{pmatrix}
$$

kde prvek na $i$-tém řádku a v $j$-tém sloupci označuje cenu hrany incidentní s uzly $u_i, u_j$, je možno Primův algoritmus vyjádřit v následující formě:
\begin{itemize}
	\item Krok 1: Vyškrtnou se všechny prvky v 1. sloupci a 1. řádek se označí.
	\item Krok 2: Pokud v označených řádcích neexistuje žádný nepodtržený prvek, algoritmus končí a podtržené prvky označují hrany v minimální kostře. Jinak se vybere minimální takový prvek.
	\item Je-li vybraný prvek $c_{ij}$, podtrhne se a označí se j-tý řádek a vymažou se nepodtržené prvky j-tého sloupce. Přechod ke kroku 2.
\end{itemize}

\begin{mydef}
Graf $G$ se nazývá \textbf{eulerovský}, existuje-li v něm uzavřený tah, který obsahuje každou hranu v $G$.
\end{mydef}

\begin{mydef}
Graf $G$ se nazývá \textbf{poloeulerovský}, existuje-li v něm tah, který obsahuje každou hranu v $G$.
\end{mydef}

\begin{veta}
Nechť $G$ je souvislý graf. potom je $G$ eulerovský, právě když každý jeho uzel má sudů stupeň.
\end{veta}

\paragraph{Důsledek}: Souvislý graf je poloeulerovský, právě když každý jeho uzel má sudý stupeň, nebo existují právě dva uzly lichého stupně.

\begin{mydef}
\textbf{Hamiltonovskou kružnicí grafu $G$} nazveme kružnici, která prochází každým uzlem grafu právě jednou. Graf nazveme hamiltonovským, má-li hamiltonovskou kružnici.
\end{mydef}

\begin{veta}
(Ore) Nechť $G$ je graf s $n$ uzly $n \geq 3$ a nechť platí $\text{deg}(u) + \text{deg}(v) \leq n$ pro každé dva uzly $u$ a $v$ grafu $G$, které nejsou spojeny hranou. Potom je graf $G$ hamiltonovský.
\end{veta}

\begin{veta}
(Dirac) Nechť $G$ je obyčejný graf s $n$ uzly a nechť platí $\text{deg}(u) \geq \frac{n}{2}$ pro každý uzel $u$. Potom je graf $G$ hamiltonovský.
\end{veta}

(poznámka: Domeček jedním tahem je hamiltonovský, ale nesplňuje Diracovu podmínku)

\subsection{Barvení uzlů}
Graf je \emph{obarvený}, když se každému uzlu přiřadí barva tak, že dvěma uzlům spojeným hranou jsou přiřazeny různé barvy.

Pokud je možno graf obarvit pomocí $k$ barev, aniž bychom nutně užili všechny z nich, nazývá \emph{k-obarvitelným}.

Nejmenší možná hodnata $k$ pro kterou je graf $G$ k-obarvitelným, se nazývá \emph{chromatické číslo} grafu $G$, formálně $\mathcal{X}(G)$.

\section{Typy grafů}
\begin{description}
	\item[$K_n$] úplný graf s $n$ uzly
	\item[$D_n$] diskrétní graf s $n$ uzly
	\item[$K$] bipartitní graf, tj graf, jehož množinu uzlů lze rozdělit na dvě disjunktní množiny $V_1, V_2$ tak, že každá jeho hrana spojuje některý uzel z množiny $V_1$ s některým uzlem množiny $V_2$. Jestliže je navíc každý uzel z množiny $V_1$ spojen hranou s každým uzlem z množiny $V_2$, pak se tento graf nazývá úplný bipartitní graf a značí se $K_{m,n}$, kde $m = |V_1|, n=|V_2|$.
\end{description}
Bipratitní graf neobsahuje kružnici liché délky.

Platí:
$$\mathcal{X}(G) = 1 \leftrightarrow G = D_n$$
$$\mathcal{X}(K_n) = n$$
$$\mathcal{X}(K) = 2$$

Kružnice je 2-obarvitelná, právě když má sudý počet uzlů.

Graf je 2-obarvitelný, když neobsahuje kružnici s lichým počtem uzlů.  Strom, který žádné kružnice nemá, je 2-obarvitelný.

\begin{mydef}
Graf $G$ se nazývá \textbf{planární (rovinný)}, když je možno jej nakreslit v rovině tak, aby se jeho hrany nekřížily. Části roviny vymezené hranami planárního grafu nakresleného v rovině bez křížení hran se nazývají \textbf{buňky} a hrany kolem nich jsou jejich \textbf{hranice}.
\end{mydef}

\begin{veta}
Má-li souvislý planární graf $n$ uzlů a $m$ hran a tvoří $p$ buněk, platí $n-m+p = 2$.
\end{veta}

\begin{veta}
Nechť $G$ je souvislý planární graf s $n \geq 3$ uzly a $m$ hranami. Potom $m \leq 3n - 6$.
\end{veta}

\begin{mydef}
Dva grafy $G_1$ a $G_2$ se nazývají \textbf{homeomorfní} (nebo shodné až na uzly stupně 2), je-li možno $G_1$ i $G_2$ získat z nějakého grafu $G_3$ postupným rozpůlením některých hran vložením nového uzlu.
\end{mydef}

\begin{veta}
Graf je planární, právě když neobsahuje podgraf homeomorfní s grafem $K_5$ ani podgraf homeomorfní s $K_{3,3}$.
\end{veta}

\begin{veta}
Každý planární graf je 5-obarvitelný.
\end{veta}

\begin{veta}
Každý planární graf je 4-obarvitelný.
\end{veta}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Orientované grafy} \label{cha:15}

1. semestr, MAT, \texttt{Grafy\_3\_141220.pdf}

(orientované sledy, souvislost a silná souvislost, turnaje, eulerovské a hamiltonovské grafy, Dijkstrův a Floyd-Warshallův algoritmus pro hledání cesty minimální délky)

\begin{mydef}
\textbf{Orientovaný graf} je dvojice $G=(U, H)$, kde $U$ je neprázdná konečná množina vrcholů nebo uzlů a $H=\{(u, v)|u, v \in U\}$ je konečná množina orientovaných hran.
\end{mydef}
(nebo také neprázdná konečná množina s binární relací)

\begin{mydef}
Nechť $G=(U, U)$ je orientovaný graf. Pro uzel $u \in U$ grafu $G$ definujeme čísla $\text{deg}_+(u) = |M|, \text{deg}_-(u) = |N|$, kde
$M = \{h \in H| \exists v \in U: h=(v, u)\}$ a
$N = \{h \in H| \exists v \in U: h=(u, v)\}$.

Číslo $\text{deg}_+(u)$ se rovná počtu hran, kteér vedou z nějakého uzlu do uzlu $u$, a nazývá se \textbf{vstupním stupněm uzlu $u$}. Číslo $\text{deg}_-(u)$ se rovná počtu hran, které vedou z uzlu $u$ do nějakého uzlu, a nazývá se \textbf{výstupním stupněm uzlu $u$}. Pokud platí $\text{deg}_-(u) = 0$, $u$ se nazývá koncový uzel, a pokud $\text{deg}_+(u) = 0$, $u$ se nazývá počáteční uzel grafu $G$.
\end{mydef}

Analogicky k obyčejným grafům definujeme (uzavřený) orientovaný sled, orientovaný tah, orientovanou cestu a orientovanou kružnici. Hrany v příslušných posloupnostech jsou přitom nahrazeny orientovanými hranami tak, aby směřovaly od předchozího k následujícímu uzlu.

\begin{mydef}
Máme-li zadán obyčejný graf $G=(U, H)$, je k němu možno definovat orientovaný graf $G'=(U', H')$ tak, že pro každou hranu $\{u, v\} \in H$ existují v $H'$ právě dvě hrany $h, h'$ takové, že $h=(u,v) \land h' = (v,u)$. Přitom v $H'$ žádné jiné hrany nejsou. Takovýto graf se nazývá \textbf{symetrickou orientací grafu $G$}. jinými slovy, hrana v obyčejném grafu mezi uzly $u$ a $v$ se nahradí oběma orientovanými hranami mezi těmito uzly v novém grafu.
\end{mydef}

\begin{mydef}
Máme-li zadán obyčejný graf $G=(U, H)$, je k němu možno definovat orientovaný graf $G'=(U', H')$ tak, že pro každou hranu $\{u, v\} \in H$ existuje v $H'$ jediná orientovaná hrana $h$ takové, že $h=(u, v)$ nebo $h = (v, u)$ a přitom $H'$ žádné jiné hrany neobsahuje. Tento graf se nazývá \textbf{orientací grafu $G$}.
\end{mydef}

\begin{mydef}
Máme-li zadán orientovaný graf $G=(U, H)$, potom k němu můžeme sestrojit jednoznačně obyčejný graf $G'=(U', H')$, který se nazývá \textbf{symetrizací grafu $G$}. Položíme
$H' = \{\{u, v\} | u, v \in U, u \not= v, \exists h \in H: h=(u, v) \lor h = (v, u)\}$
\end{mydef}
Jinými slovy, symetrizace vznikne zanedbáním šipek a smyček v původním grafu.

\begin{mydef}
Řekneme, že orientovaný graf $G=(U,H)$ je \textbf{souvislý}, jestliže jeho symetrizace $G=(U, H')$ je souvislý graf.
\end{mydef}

\begin{mydef}
Řekneme, že orientovaný graf $G=(U,H)$ je \textbf{silně souvislý}, jestliže pro libovolné dva uzly $u, v \in U$ existuje orientovaná cesta z uzlu $u$ do uzlu $v$.
\end{mydef}

\begin{mydef}
Orientovaný graf $T = (U, H)$ bez smyček se nazývá \textbf{turnajem}, když pro každou množinu uzlů $\{u,v\}, u, v \in U, u \not= v$ existuje právě jedna hrana $h \in H$ taková, že platí $h = (u, v) \lor h = (v,u)$.
\end{mydef}
V turnaji tedy existuje pro každou dvojici různých uzlů jediná orientovaná hrana jdoucí z jednoho uzlu do druhého.

\begin{veta}
Buď $T = (U, H)$ turnaj a $v \in U$ uzel s maximálním výstupním stupněm. Pak pro každý uzel $w \in U$ existuje orientovaná cesta z uzlu $v$ do uzlu $w$ délky nejvýše 2.
\end{veta}

\begin{mydef}
Orientovaný graf $G=(U, H)$ se nazývá eulerovský, jestliže v něm existuje uzavřený orientovaný tah obsahující všechny jeho hrany.
\end{mydef}

\begin{veta}
Souvislý orientovaný graf $G=(U, H)$ je eulerovský, právě tehdy když platí $\text{deg}_+(u) = \text{deg}_-(u)$ pro každý uzel $u \in U$.
\end{veta}

\begin{mydef}
\textbf{Orientovanou hamiltonovskou cestou v grafu $G$} nazveme orientovanou cestu, která prochází každým uzlem grafu $G$.

\textbf{Orientovanou hamiltonovskou kružnicí grafu $G$} nazveme orientovanou kružnici, která prochází každým uzlem grafu $G$.

\textbf{Orientovaný graf nazveme hamiltonovským}, má-li orientovanou hamiltonovskou kružnici.
\end{mydef}

\begin{veta}
V každém turnaji $T=(U, H)$ existuje orientovaná hamiltonovská cesta.
\end{veta}

\begin{veta}
Je-li $T_n$ silně souvislý turnaj s $n$ uzly, $n \geq 3$, potom $T_n$ obsahuje orientované kružnice o délkách $3, 4, \dots, n$.
\end{veta}

Důsledek: Turnaj $T$ s alespoň třemi uzly je hamiltonovský, právě když je silně souvislý.

Graf bude dále vždy znamenat orientovaný graf bez smyček, hrana orientovanou hranu a cesta bude vždy znamenat orientovanou cestu.
\begin{mydef}
Nechť $G=(U, H)$ je graf a každé hraně $h \in H$ nechť je přiřazeno reálné číslo $l(h)$. Potom tomuto číslu budeme říkat \textbf{délka hrany $h$}.

\textbf{Délka $l(p)$ sledu $p$ v grafu $G$} se definuje jako součet délek všech hran obsažených v sledu $p$. Je-li $p$ tvořena jediným uzlem, klademe $l(p) = 0$.
\end{mydef}

\begin{mydef}
Nechť je dán graf $G=(U, H)$ a $u, v \in U$. Pokud existuje mezi uzly $u$ a $v$ \textbf{cesta minimální délky}, definujeme číslo $d(u, v)$ jako délku této cestu. Pokud z uzlu $u$ do uzlu $v$ vůbec žádná cesta neexistuje, klademe $d(u, v) = \infty$.
\end{mydef}
Poznámka: Pro kružnice se zápornou délkou nemá pojem cesta minimální délky žádný význam.

\subsection{Dijkstrův algoritmus pro stanovení minimální cesty}
\begin{mydef}
\textbf{Horní odhad vzdálenosti uzlu $s$ a uzlu $v$} je číslo $D(v)$ takové, že platí $D(v) \geq d(s,v)$.

Pro každý uzel $v \in U$ bude symbol $\pi(v)$ označovat uzel, který \textbf{bezprostředně předchází uzlu $v$ v cestě minimální délky z uzlu $s$ do uzlu $v$} zkonstruované Dijkstrovým algoritmem. Pokud $v=s$ nebo pokud taková cesta dosud nebyla zkonstruována, položíme $\pi(v) = \emptyset$.
\end{mydef}

V grafu $G = (U, H)$, kde každé hraně $h$ je přiřazeno kladné reálné číslo $l(h)$ a kde je vyznačen výchozí uzel $s$, najděte ke každému uzlu $v \not= s$ cestu $p(s,v)$ minimální délky a tuto minimální délku $d(s, v)$.

\begin{enumerate}
	\item \textbf{Inicializace}: Pro každý uzel $u \in U$ položíme $\pi(u) = \emptyset, D(s) = 0, D(u) = \infty$, jestliže $u \not= s, S= \emptyset, Q = U$.
	\item \textbf{Test na ukončení algoritmu}: Pokud $S = U$, přechod na bod 5.
	\item \textbf{Nalezení uzlu s definitivní cestou}: Z množiny $Q$ přesuneme do množiny $S$ uzel $v$ s minimální hodnotou $D(v)$. Jestliže pro všechny $u \in Q$ platí $D(u) = \infty$, přechod na bod 5.
	\item \textbf{Zlepšení horních odhadů}: Pro každý uzel $w \in N(v) \cap Q$ takový, že $D(w) \geq D(v) + l((v, w))$ položíme $D(w) = D(v) + l((v, w))$ a $\pi(w) = v$. Přechod na bod 2.
	\item \textbf{Konstrukce výstupu}: Do uzlů, které zůstaly v množině $Q$ žádná cesta z uzlu $s$ neexistuje. Pro všechny ostatní uzly $v$ položíme $d(s, v) = D(v)$ a cestu minimální délky sestrojíme obrácením cesty $v \to \pi(v) \to \pi(\pi(v)) \to \dots \to s$.
\end{enumerate}

\begin{veta}
Dijkstrův algoritmus nalezne cestu minimální délky a vzdálenost z výchozího uzlu $s$ do každého jiného uzlu $v \in V$.
\end{veta}

\subsection{Floyd-Warshallův algoritmus}
Dijkstrův algoritmus nelze použít, pokud se v grafu vyskytují hrany se zápornou délkou. Floyd-Warshallův algoritmus při každém zadání délek hran nalezne cestu minimální délky z každého uzlu do každého jiného uzlu a pokud taková cesta, která by byla současně minimálním sledem, neexistuje kvůli kružnici se zápornou délkou, tuto kružnici odhalí.

Uvažujeme graf $G = (U, H), U = \{1, 2, \dots, n\}$ v němž jsou délky hran zadány maticí
A = $$
 \begin{pmatrix}
  a_{11} & a_{12} & \cdots & a_{1n} \\
  a_{21} & a_{22} & \cdots & a_{2n} \\
  \vdots & \vdots & \ddots & \vdots \\
  a_{n1} & a_{n2} & \cdots & a_{nn}
 \end{pmatrix}
$$
kde $a_{ij}$ značí délku hrany $(i, j)$ pro libovolné $i, j \in \{1, 2, \dots, n\}$. Dále budeme používat matici
P = $$
 \begin{pmatrix}
  p_{11} & p_{12} & \cdots & p_{1n} \\
  p_{21} & p_{22} & \cdots & p_{2n} \\
  \vdots & \vdots & \ddots & \vdots \\
  p_{n1} & p_{n2} & \cdots & p_{nn}
 \end{pmatrix}
$$
kde na začátku platí $p_{ij} = j$. Algoritmus má vždy $n$ iterací.

Začneme s maticí $A^0 = A, P^0 = P$ a v $i$-té iteraci vytvoříme matice $A^i, P^i$ pomocí $A^{i-1}, P^{i-1}$. Nakonec tedy dostaneme matice $A^n, P^n$. Prvky matic $A^j, P^j, j = 1, 2, \dots, n$ se vypočítají následujícím způsobem:
$$a_{ik}^j = a_{ik}^{j-1}, p_{ik}^j = p_{ik}^{j-1} \text{ jestliže } a_{ik}^{j-1} \leq a_{ij}^{j-1} + a_{jk}^{j-1}$$
$$a_{ik}^j = a_{ij}^{j-1} + a_{jk}^{j-1}, p_{ik}^j = p_{ij}^{j-1} \text{ jestliže } a_{ik}^{j-1} > a_{ij}^{j-1} + a_{jk}^{j-1}$$

Indukcí lze dokázat, že po skončení algoritmu má prvek $a_{ij}^n$ hodnotu minimální vzdálenosti z uzlu $i$ do uzlu $j$. Dá se též ověřit, že pokud $p_{ij}^n = k$, potom $(i,k)$ je první hrana v minimální cestě z uzlu $i$ do uzlu $j$, což se dá využít při konstrukci této trasy.

Existence kružnice se zápornou délkou je indikována pomocí záporného diagonálního prvku.





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Klasifikace gramatik, formálních jazyků a automatů přijímajících jazyky.} \label{cha:16}

1. semestr, TIN, \texttt{opora.pdf}, 2., 3. kapitola

\section{Jazyky}
\begin{mydef}
Abecedou rozumíme neprázdnou množinu prvků, které nazýváme \emph{symboly abecedy}.
\end{mydef}

\begin{mydef}
\emph{Řetězcem} (také slovem) nad danou abecedou rozumíme každou konečnou posloupnost symbolů abecedy. Prázdnou posloupnost symbolů, tj posloupnost, která neobsahuje žádný symbol, nazýváme \emph{prázdný řetězec}. Prázdný řetězec budeme označovat písmenem $\epsilon$.

Formálně lze definovat řetězec nad abecedou $\Sigma$ takto:
\begin{enumerate}[(1)]
	\item prázdný řetězec $\epsilon$ je řetězec nad abecedou $\Sigma$
	\item je-li $x$ řetězec nad $\Sigma$ a $a \in \Sigma$, pak $xa$ je řetězec nad $\Sigma$.
	\item $y$ je řetězec nad $\Sigma$, když a jen když lze $y$ získat aplikací pravidel 1 a 2.
\end{enumerate}
\end{mydef}

Velká řecká písmena pro abecedy, Malá latinská písmena ($a, b, c, \dots$) pro symboly, ($t, u, v, \dots$) pro řetězce.

\begin{mydef}
Nechť $x$ a $y$ jsou řetězce nad abecedou $\Sigma$. \emph{Konkatenací} (zřetězením) řetězce $x$ s řetězcem $y$ vznikne řetězec $xy$ přípojením řetězce $y$ za řetězec $x$. Operace konkatenace je zřejmě asociativní, tj. $x(yz) = (xy)z$, ne však komutativní $xy \not= yx$.
\end{mydef}

\begin{mydef}
Nechť $x = a_1 a_2 \dots a_n$ je řetězec nad abecedou $\Sigma, a_i \in \Sigma$ pro $i = 1, \dots, n$. \emph{Reverzí} (zrcadlovým obrazem) řetězce $x$ rozumíme řetězec $x^R = a_n a_{n-1} \dots a_2 a_1$; tj. symboly řetězce $x^R$ jsou vzhledem k řetězci $x$ zapsány v opačném pořadí.
\end{mydef}

\begin{mydef}
Nechť $w$ je řetězec nad abecedou $\Sigma$. Řetězec $z$ se nazývá \emph{řetězcem} řetězce $w$, jestliže existují řetězce $x$ a $y$ takové, že $w = xzy$.
Řetězec $x_1$ se nazývá \emph{prefixem} (předponou) řetězce $w$, jestliže existuje řetězec $y_1$ takový, že $w = x_1 y_1$. Analogicky řetězec $y_2$ se nazývá \emph{sufixem} (příponou) řetězce $w$, jestliže existuje řetězec $x_2$ takový, že $w = x_2 y_2$. Je-li $y_1 \not= \epsilon$, resp. $x_2 \not= \epsilon$, pak $x_1$ je \emph{vlastní prefix}, resp. $y_2$ je vlastní sufix řetězce $w$.
\end{mydef}

\begin{mydef}
\emph{Délka řetězce} je nezáporné celé číslo udávající počet symbolů řetězce. Délku řetězce $x$ značíme symbolicky $|x|$. Je-li $x = a_1 a_2 \dots a_n, a_i \in \Sigma$ pro $i = 1, \dots, n$, pak $|x| = n$. Délka prázdného řetězce je nulová, tj. $|\epsilon| = 0$.
\end{mydef}

$a^3 = aaa, \quad b^2 = bb, \quad a^0 = \epsilon$

\begin{mydef}
Nechť $\Sigma$ je abeceda. Označme symbolem $\Sigma^*$ množinu všech řetězců nad abecedou $\Sigma$ včetně řetězce prázdného, symbolem $\Sigma^+$ množinu všech řetězců nad $\Sigma$ vyjma řetězce prázdného, tj. $\Sigma^* = \Sigma^+ \cup \{\epsilon\}$. Množinu $L$, pro niž platí $L \subseteq \Sigma^*$ (případně $L \subseteq \Sigma^+$, pokud $\epsilon \not\in L$) nazýváme \emph{jazykem} $L$ nad abecedou $\Sigma$. Jazykem tedy může být libovolná podmnožina řetězců nad danou abecedou. Řetězec $x, x \in L$ nazýváme \emph{větou} (někdy také slovem) jazyka L.
\end{mydef}

\begin{mydef}
Nechť $L_1$ je jazyk nad abecedou $\Sigma_1$, $L_2$ jazyk nad abecedou $\Sigma_2$. \emph{Součinem} (konkatenací) jazyků $L_1$ a $L_2$ je jazyk $L_1 \cdot L_2$ nad abecedou $\Sigma_1 \cup \Sigma_2$, jenž je definován takto: $L_1 \cdot L_2 = \{ xy | x \in L_1, y \in L_2\}$.
\end{mydef}
Operace je definovaná prostřednictvím operace konkatenace řetězců a má také stejné vlastnosti: je asociativní a nekomutativní.

\begin{mydef}
Nechť $L$ je jazyk nad abecedou $\Sigma$. \emph{Iteraci} $L^*$ jazyka $L$ a \emph{pozitivní iteraci} $L^+$ jazyka $L$ definujeme takto:
$$L^0 = \{\epsilon\}$$
$$L^n = L \cdot L^{n-1}, \text{ pro } n \geq 1$$
$$L^* = \bigcup\limits_{n \geq 0} L^n, \quad L^+ = \bigcup\limits_{n \geq 1} L^n$$
\end{mydef}

\begin{veta}
Je-li $L$ jazyk, pak platí:
$$L^* = L^+ \cup \{\epsilon\}$$
$$L^+ = L \cdot L^* = L^* \cdot L$$
\end{veta}

\begin{mydef}
Algebraická struktura $\left< A, +, \cdot, 0, 1 \right>$ se nazývá polokruh s aditivním jednotkovým prvkem 0 a multiplikativním jednotkovým prvkem 1, jestliže:
\begin{enumerate}[(1)]
	\item $\left< A, +, 0 \right>$ je komutativní monoid
	\item $\left< A, \cdot, 1 \right>$ je monoid
	\item pro operaci $\cdot$ platí distributivní zákon vzhledem k $+$:
	$ a \cdot (b + c) = a \cdot b + a \cdot c$ pro $a, b, c \in A$.
\end{enumerate}
\end{mydef}

\begin{veta}
Algebra jazyků $\left< 2^{\Sigma^*}, \cup, \cdot, \emptyset, \{\epsilon\} \right>$, kde $\cup$ je sjednocení a $\cdot$ konkatenace jazyků tvoří polokruh.
\end{veta}

\section{Gramatika}
Nejznámější prostředek pro reprezentaci jazyka (konečné, nekonečné). Používá dvou konečných disjunktních abeced: Množina $N$ nonterminálních symbolů a množina $\Sigma$ terminálních symbolů.

\emph{Noterminální symboly}, krátce \emph{nonterminály}, mají roli pomocných proměnných označující určité syntaktické celky -- syntaktické kategorie.

Množina \emph{terminálních symbolů}, krátce \emph{terminálů} je identická s abecedou, nad níž je definován jazyk. Sjednocení obou množin, tj $N \cup \Sigma$, nazýváme \emph{slovníkem gramatiky}.

$a, b, c$ terminální symboly; $A, B, C, S$ nonterminální symboly; $U, V, Z$ terminální nebo nonterminální symboly; $\alpha, \beta$ řetězce terminálních a nonterminálních symbolů, $u,v,$ řetězce terminálních symbolů.

Gramatika představuje generativní systém. Jádrem gramatiky je konečná množina $P$ \emph{přepisovacích pravidel} (nazývaných také produkce). Každé přepisovací pravidlo má tvar uspořádané dvojce $(\alpha, \beta)$ řetězců stanovuje množinu substitucí řetězce $\beta$ namísto řetězce $\alpha$, který se vyskytuje jako podřetězec generovaného řetězce. Řetězec $\alpha$ obsahuje alespoň jeden nonterminální symbol.
$$P \subseteq (N \cup \Sigma)^* N (N \cup \Sigma)^* \times (N \cup \Sigma)^*$$

\begin{mydef}
Gramatika $G$ je čtveřice $G = (N, \Sigma, P, S)$, kde
\begin{itemize}
	\item $N$ je konečná množina nonterminálních symbolů
	\item $\Sigma$ je konečná množina terminálních symbolů
	\item $P$ je konečná podmnožina kartézského součinu $(N \cup \Sigma)^* N (N \cup \Sigma)^* \times (N \cup \Sigma)^*$
	\item $S \in N$ je výchozí (také počáteční) symbol gramatiky
\end{itemize}
\end{mydef}

Prvek $(\alpha, \beta)$ množiny $P$ nazýváme \emph{přepisovacím pravidlem} (krátce pravidlem) a budeme jej zapisovat ve tvaru $\alpha \to \beta$. Řetězec $\alpha$ reps. $\beta$ nazýváme levou resp. pravou stranou přepisovacího pravidla.

Obsahuje-li gramatika pravidla se stejnou levou stranou, můžeme zjednodušeně zapsat $\alpha \to \beta_1 | \beta_2 | \dots | \beta_n$.

\begin{mydef}
Nechť $G = (N, \Sigma, P, S)$ je gramatika a nechť $\lambda$ a $\mu$ jsou řetězce z $(N \cup \Sigma)^*$. Mezi řetězci $\lambda$ a $\mu$ platí binární relace $\underset{G}{\Rightarrow}$, nazývaná \emph{přímá defivace}, jestliže můžeme řetězce $\lambda$ a $\mu$ vyjádřit ve tvaru:
$$\lambda = \gamma \alpha \delta$$
$$\mu = \gamma \beta \delta$$
kde $\gamma$ a $\delta$ jsou libovolné řetězce z $(N \cup \Sigma)^*$ a $\alpha \to \beta$ je nějaké přepisovací pravidlo z $P$.

Platí-li mezi řetězci $\lambda$ a $\mu$ relace přímé derivace, pak píšeme $\lambda \underset{G}{\Rightarrow} \mu$ a říkáme, že řetězec $\mu$ lze přímo generovat z řetězce $\lambda$ v gramatice $G$. Je-li z kontextu zřejmé, že jde o derivaci v gramatice $G$, pak nemusíme specifikaci gramatiky pod symbolem $\Rightarrow$ uvádět.
\end{mydef}

\begin{mydef}
Nechť $G = (N, \Sigma, P, S)$ je gramatika a $\lambda$ a $\mu$ jsou řetězce z $(N \cup \Sigma)^*$. Mezi řetězci $\lambda$ a $\mu$ platí relace $\Rightarrow^+$ nazývaná \emph{derivace}, jestliže existuje taková posloupnost přímých derivací $\nu_{i-1} \Rightarrow \nu_i, i = 1, \dots, n, n \geq 1$ taková, že platí:
$$\lambda = \nu_0 \Rightarrow \nu_1 \Rightarrow \dots \Rightarrow \nu_{n-1} \Rightarrow \nu_n = \mu$$

Tuto posloupnost nazýváme \emph{derivací délky $n$}. Platí-li $\lambda \Rightarrow^+ \mu$, pak říkáme, že řetězec $\mu$ lze generovat z řetězce $\lambda$ v gramatice $G$. Relace $\Rightarrow^+$ je zřejmě tranzitivním uzávěrem relace přímé derivace $\Rightarrow$. Symbolem $\Rightarrow^n$ značíme $n$-tou mocninu relace $\Rightarrow$.
\end{mydef}

\begin{mydef}
Jestliže v gramatice $G$ platí pro řetězce $\lambda$ a $\mu$ relace $\lambda \Rightarrow^+ \mu$ nebo identita $\lambda = \mu$, pak píšeme $\lambda \Rightarrow^* \mu$. Relace $\Rightarrow^*$ je tranzitivním a reflexivním uzávěrem relace přímé derivace $\Rightarrow$.
\end{mydef}

\begin{mydef}
Nechť $G=(N, \Sigma, P, S)$ je gramatika. Řetězec $\alpha \in (N \cup \Sigma)^*$ nazýváme \emph{větnou formou}, jestliže platí $S \Rightarrow^* \alpha$, tj. řetězec $\alpha$ je generovaný z výchozího symbolu $S$.
Větná forma, která obsahuje pouze terminální symboly se nazývá \emph{věta}. Jazyk $L(G)$, generovaný gramatikou $G$, je definován množinou všech vět $L(G) = \{ w | S \Rightarrow^* w \land w \in \Sigma^*\}$.
\end{mydef}

\section{Chomského klasifikace gramatik}
\subsection{Typ 0: Neomezené}
Gramatika typu 0 obsahuje pravidla v nejobecnějším tvaru

$$\alpha \to \beta, \alpha \in (N \cup \Sigma)^* N (N \cup \Sigma)^*, \beta \in (N \cup \Sigma)^*$$

\subsection{Typ 1: Kontextové}
Gramatika typu 1 obsahuje pravidla ve tvaru

$$ \alpha A \beta \to \alpha \gamma \beta, A \in N, \alpha, \beta in (N \cup \Sigma)^*, \gamma \in (N \cup \Sigma)^+$$
nebo 
$$S \to \epsilon$$
pokud se $S$ neobjevuje na pravé straně žádného pravidla.

\subsection{Typ 2: Bezkontextové}
Gramatika typu 2 obsahuje pravidla tvaru

$A \to \gamma, A \in N, \gamma \in (N \cup \Sigma)^*$

\subsection{Typ 3: Lineární (pravé lineární)}
Gramatika typu 3 obsahuje pravidla tvaru

$A \to xB$ nebo $A \to x; A, B \in N, x \in \Sigma^*$

Regulární (pravé regulární)

$A \to aB$ nebo $A \to a; A, B \in N, a \in \Sigma$ nebo $S \to \epsilon$, pokud se $S$ neobjevuje na pravé straně žádného pravidla.


\begin{mydef}
Jazyk generovaný gramatikou typu $i$, $i = 0, 1, 2, 3$ nazýváme jazykem typu $i$. Podle názvu gramatik mluvíme také o jazycích \emph{rekurzivně vyčíslitelných $(i=0)$} a analogicky ke gramatikám jazycích \emph{kontextových $(i=1)$}, \emph{bezkontextových $(i=2)$} a \emph{regulárních $(i=3)$}.
\end{mydef}

\begin{veta}
Nechť $\mathcal{L}_i, i = 0, 1, 2, 3$ značí třídu všech jazyků typu $i$. Pak platí $\mathcal{L}_0 \supseteq \mathcal{L}_1 \supseteq \mathcal{L}_2 \supseteq \mathcal{L}_3$.
\end{veta}

\begin{veta}
Nechť $\mathcal{L}_i, i = 0, 1, 2, 3$ jsou třídy jazyků typu $i$. Pak platí $\mathcal{L}_0 \supset \mathcal{L}_1 \supset \mathcal{L}_2 \supset \mathcal{L}_3$.
\end{veta}












%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Vlastnosti formálních jazyků} \label{cha:17}

1. semestr, TIN, \texttt{opora.pdf}, kapitola 3.5, 4.13, 5.6, 5.7.4

(typické vlastnosti a jejich rozhodnutelnost)

\section{Vlastnosti regulárních jazyků}

Vlastnosti strukturální, uzávěrové, rozhodnutelné problémy.

\subsection{Strukturální vlastnosti regulárních jazyků}
\begin{veta}
Každý konečný jazyk je regulární.
\end{veta}

\subsubsection{Pumping lemma}
V každé dostatečně dlouhé větě každého regulárního jazyka jsme schopni najít poměrně krátkou sekvenci, kterou je možné vypustit, resp. zopakovat libovolný počet krát, přičemž stále dostáváme věty daného jazyka.

\begin{veta}
Nechť $L$ je nekonečný regulární jazyk. Pak existuje celočíselná konstanta $p > 0$ taková, že platí:

$$w \in L \land |w| \geq p \Rightarrow w = xyz \land 0 < |y| \leq p \land x y^i z \in L \text{ pro } i \geq 0$$
\end{veta}

Většinou k důkazu, že daný jazyk není regulární. Vyhodnocujeme všechny možnosti.

\subsubsection{Myhill-Nerodova věta}

ekvivalence je binární relace, která je reflexivní, symetrická a tranzitivní.

\begin{mydef}
Nechť $\Sigma$ je abeceda a $\sim$ je ekvivalence na $\Sigma^*$.
Ekvivalence $\sim$ je \emph{pravou kongruencí} (je zprava invariantní), pokud pro každé $u,v,w \in \Sigma^*$ platí

$$u \sim v \Rightarrow uw \sim vw$$
\end{mydef}

\begin{veta}
Ekvivalence $\sim$ na $\Sigma^*$ je pravá kongruence právě tehdy, když pro každé $u,v \in \Sigma^*, a \in \Sigma$ platí $u \sim v \Rightarrow ua \sim va$.
\end{veta}

\begin{mydef}
Nechť $L$ je libovolný jazyk (ne nutně regulární) jazyk nad abecedou $\Sigma$. Na množině $\Sigma^*$ definujeme relaci $\sim_L$ zvanou prefixová ekvivalence pro $L$ takto:
$$u \sim_L v \xLeftrightarrow{def} \forall w \in \Sigma^*: uw \in L \Leftrightarrow vw \in L$$
\end{mydef}

\begin{veta}
Nechť $L$ je jazyk nad $\Sigma$. Pak následující tvrzení jsou ekvivalentní:
\begin{enumerate}
	\item $L$ je jazyk přijímaný deterministickým konečným automatem
	\item $L$ je sjednocení některých tříd rozkladu určeného pravou kongruencí na $\Sigma^*$ s konečným indexem
	\item Relace $\sim_L$ má konečný index
\end{enumerate}
\end{veta}

Slouží opět pro dokazování, zda je jazyk regulární (resp. není).

\subsection{Uzávěrové vlastnosti regulárních jazyků}

\begin{veta}
Třída regulárních jazyků \emph{je uzavřena} (mino jiné) vzhledem k operacím $\cup$ sjednocení, $\cdot$ (konkatenace) a $^*$ (iterace).
\end{veta}
Důkaz z definice regulárních množina a ekvivalence regulárních množina a regulárních jazyků.

\begin{veta}
Třída regulárních jazyků tvoří množinovou \emph{Booleovu algebru}.
\end{veta}

\begin{veta}
Nechť $L \in \mathcal{L}_3$ a nechť $L^R = \{w^R | w \in L\}$. Pak $L^R \in \mathcal{L}_3$
\end{veta}

\subsection{Rozhodnutelné problémy regulárních jazyků}

neprázdnost $L \not= \emptyset$, náležitost $w \in L$ a ekvivalence $L(G_1) = L(G_2)$

\begin{veta}
Ve třídě $\mathcal{L}_3$ je rozhodnutelný problém \emph{neprázdnosti} jazyka i problém \emph{náležitosti} řetězce (do jazyka).
\end{veta}

\begin{veta}
Nechť $L_1 = L(G)$ a $L_2 = L(G_2)$ jsou dva jazyky generované regulárními gramatikami $G_1$ a $G_2$.
Pak je rozhodnutelný problém \emph{ekvivalence}, tj. $L(G_1) = L(G_2)$ nebo $L(G_1) \not= L(G_2)$.
\end{veta}
Podle relace nerozlišitelnosti stavů $\equiv$\$

\section{Vlastnosti bezkontextových jazyků}

\subsection{Strukturální vlastnosti bezkontextových jazyků}

\begin{veta}
Nechť $L$ je bezkontextový jazyk. Pak existuje konstanta $k > 0$ taková, že je-li $z \in L$ a $|z| \geq k$, pak lze $z$ napsat ve tvaru:
$$x = u v w x y, ex \not= \epsilon, |vwx| \leq k$$
a pro všechna $i \geq 0$ je $uv^iwx^iy \in L$
\end{veta}

\begin{lemma}
Jazyk $L = \{a^n b^n c^n | m \geq 1\}$ není bezkontextovým jazykem.
\end{lemma}
Důkaz: Nelze zvolit řetězce $v$ a $x$ tak, aby jejich iterací zůstal stejný počet symbolů $a, b, c$ a současně pořadí symbolů $a, b, c$ zůstalo nezměněno.

Výše zmíněný jazyk je typickým kontextovým jazykem.

\subsection{Uzávěrové vlastnosti}

\subsubsection{Substituce jazyků}
\begin{mydef}
Nechť $\mathcal{L}$ je třída jazyků a nechť $L \subseteq \Sigma^*$ je jazykem třídy $\mathcal{L}$. Dále nechť $\Sigma = \{a_1, a_2, \dots, a_n\}$ pro nějaké $n \in \mathbb{N}$ a nechť jazyky označené $L_{a_1}, L_{a_2}, \dots, L_{a_n}$ jsou rovněž jazyky třídy $\mathcal{L}$. Říkáme, že třída $\mathcal{L}$ je \emph{uzavřena vzhledem k substituci}, jestliže pro každý výběr jazyků $L, L_{a_1}, L_{a_2}, \dots, L_{a_n}$ ej také jazyk $\sigma_{L_{a_1}, L_{a_2}, \dots, L_{a_n}}(L)$
$$\sigma_{L_{a_1}, L_{a_2}, \dots, L_{a_n}}(L) = \{x_1 x_2 \dots x_m | b_1 b_2 \dots b_m \in L \land \forall i \in \{1, \dots, m\} : x_i \in L_{b_i}\} $$
ve třídě $\mathcal{L}$.
\end{mydef}

\subsubsection{Morfismus jazyků}

\begin{mydef}
Nechť $\Sigma$ a $\Delta$ jsou abecedy a $L \in \Sigma^*$ je jazyk nad abecedou $\Sigma$. Zobrazení $h: \Sigma^* \to \Delta^*$ nazýváme \emph{morfismem nad slovy}, platí-li $\forall w = a_1 a_2 \dots a_n \in \Sigma^* : H(w) = h(a_1) h(a_2) \dots h(a_n)$. \emph{Morfismus jazyka} $h(L)$ pak definujeme jako $h(L) = \{h(w) | w \in L\}$.
\end{mydef}
(zvláštní případ substituce, kde každý substituovaný jazyk má právě jednu větu)

\subsubsection{Uzavřenost}
\begin{veta}
Třída bezkontextových jazyků je uzavřena vůči substituci
\end{veta}

\begin{veta}
Bezkontextové jazyky jsou uzavřeny vzhledem k:
\begin{enumerate}
	\item sjednoceni
	\item konkatenaci
	\item iteraci
	\item pozitivní iteraci
	\item morfismu
\end{enumerate}
\end{veta}
(důkazy plynou ze důkazu substituce)

\begin{veta}
Bezkontextové jazyky jsou uzavřeny vzhledem k průniku s regulárními jazyky.
\end{veta}

\begin{mydef}
Je-li $h: \Sigma^* \to \Delta^*$ morfismus, pak definujeme \emph{inverzní morfismus nad slovy} z $\Delta^*$ jako $h^{-1}(w) = \{x \in \Sigma^* | h(x) = w\}$ a \emph{inverzní morfismus jazyka $L$} nad $\Delta$ jako $h^{-1}(L) = \{x \in \Sigma^* | h(x) \in L\}$.
\end{mydef}

\begin{veta}
Bezkontextové jazyky jsou uzavřeny vzhledem k inverznímu morfismu.
\end{veta}

\subsubsection{Neuzavřenost vůči průniku a doplňku}

\begin{veta}
Bezkontextové jazyky \emph{nejsou} uzavřeny vůči průniku a doplňku.
\end{veta}
Důkaz: Průnik $a^n b^n c^m$ a $a^n b^m c^m$ je opět známý kontextový jazyk $a^m b^m c^m$. Doplněk pak přes De-Morganovy zákony a přes neuzavřenost průniku.

\subsection{Rozhodnutelné a nerozhodnutelné problémy pro bezkontextové jazyky}

\begin{veta}
Následující problémy jsou \emph{rozhodnutelné}, tj. algoritmicky řešitelné:
\begin{enumerate}
	\item problém \emph{neprázdnosti jazyka} $L(G)$ pro libovolnou bezkontextovou gramatiku $G$.
	\item problém \emph{příslušnosti řetězce $w \in \Sigma^*$ do jazyka $L(G)$} pro libovolnou bezkontextovou gramatiku
	\item problém \emph{konečnosti jazyka $L(G)$} pro libovolnou bezkontextovou gramatiku $G$.
\end{enumerate}
\end{veta}
Důkazy: (1) Algoritmus pro získání nonterminálů generujících terminální řetezce. (2) průnik NZA s KA přijímajícím právě řetězec $w$ a ověření neprázdnosti. (3) Pumping lemma.

\begin{veta}
Následující problémy jsou \emph{nerozhodnutelné}, tj. nejsou algoritmicky řešitelné:
\begin{enumerate}
	\item problém \emph{ekvivalence bezkontextových gramatik}, tj. otázka zda $L(G_1) = L(G_2)$ pro dvě bezkontextové gramatiky $G_1, G_2$
	\item problém \emph{inkluze jazyků bezkontextových gramatik}, tj. otázka zda $L(G_1) \subseteq L(G_2)$ pro dvě bezkontextové gramatiky $G_1, G_2$.
\end{enumerate}
\end{veta}
Důkaz redukcí z Postova korespondenčního problému.

\subsection{Uzávěrové vlastnosti deterministických bezkontextových jazyků}

\begin{veta}
Deterministické bezkontextové jazyky jsou uzavřeny vůči průniku s regulárními jazyky a doplňku.
\end{veta}

\begin{veta}
Deterministické bezkontextové jazyky \emph{nejsou} uzavřeny vůči průniku a sjednocení.
\end{veta}

\begin{veta}
Deterministické bezkontextové jazyky \emph{nejsou} uzavřeny vůči konkatenaci a iteraci.
\end{veta}
Důkaz: Prefixy.

\subsection{Některé další zajímavé vlastnosti bezkontextových jazyků}

\begin{mydef}
Bezkontextová gramatika $G = (N, \Sigma, P, S)$ má vlastnost sebevložení, jestliže existují $A \in N$ a $ u,v \in \Sigma^+$ takové, že $A \Rightarrow^+ uAv$ a $A$ není zbytečný nonterminál. Bezkontextový jazyk má vlastnost sebevložení, jestliže každá gramatika, která jej generuje, má vlastnost sebevložení.
\end{mydef}

\begin{veta}
Bezkontextový jazyk má vlastnost sebevložení, právě tehdy když není regulární.
\end{veta}

\begin{mydef}
Označme $ZAV_n$  pro $n \geq 0$ jazyky stávající se ze všech vyvážených řetězců závorek $n$ typů. Tyto jazyky -- označované též jako Dyckovy jazyky -- jsou generovány gramatikami s pravidly tvaru:
$$S \to [^1 S ]^1 | [^2 S ]^2 | \dots | [^n S ]^n | SS | \epsilon $$
\end{mydef}

\begin{veta}
(Chomsky-Scutzenberger) Každý bezkontextový jazyk je morfismem průniku nějakého jazyka závorek a nějaké regulární množiny. Jinými slovy, pro každý $L \in \mathcal{L}_2$ existují $n \geq 0$, regulární množina $R$ a morfismus $h$ takový, že $L = h( ZAV_n \cap R)$.
\end{veta}

\begin{mydef}
Mějme abecedu $\Sigma = \{a_1, a_2, \dots, a_n\}$. \emph{Parikova funkce} je funkce $\psi: \Sigma^* \to \mathbb{N}^k$ definovaná pro $w \in \Sigma^*$ jako $\psi(w) = (\#a_1(w), \#a_2(w), \dots, \#a_n(w))$, kde $\#a_i(w)$ udává počet výskytů symbolu $a_i$ ve $w$.
\end{mydef}

\begin{mydef}
Podmnožinu množiny vektorů $\mathbb{N}^k$ nazveme \emph{lineární množinou}, je-li dána bází $u_0 \in \mathbb{N}^k$ a periodami $u_1, \dots, u_m \in \mathbb{N}^k$ jako $\{u_0 + a_1 u_1 + \dots + a_m u_m | a_1, \dots, a_m \in \mathbb{N}\}$. Podmnožinu $\mathbb{N}^k$ nazveme \emph{semilineární množinou}, je-li sjednocením konečného množství lineárních množin.
\end{mydef}

\begin{veta}
(Parikh) Pro libovolný bezkontextový jazyk $L, \psi(L)$ je semilineární množina.
\end{veta}
Nebo: Komutativní obraz každého bezkontextového jazyka odpovídá nějakému regulárnímu jazyku.

\section{Vlastnosti jazyků rekurzivních a rekurzivně vyčíslitelných}

\subsection{Uzavřenost vůči $\cup, \cap, \cdot, *$}

\begin{veta}
Třídy rekurzivních a rekurzivně vyčíslitelných jazyků jsou uzavřeny vůči operacím $\cup, \cap, \cdot$ a $*$.
\end{veta}
Důkazy:
\begin{itemize}
	\item $\cup$: Nedeterministický přechody ($\Delta/\Delta$) do původních počátečních stavů z nového počátečního stavu.
	\item $\cap$ Třípáskový: Na první je vstup, na simuluje první TS, na třetí simuluje dtuhý TS.
	\item $\cdot$ Třípáskový NTS okopíruje nedeterministicky zvolený prefix vstupu na druhou pásku, kde simuluje první TS, zbytek na třetí pásku, kde simuluje druhý TS
	\item $*$ Zobecněním předchozího, dvoupáskový NTS.
\end{itemize}
Jsou-li stroje úplné, pak stroje vybudované podle předchozích pravidel jsou také \emph{úplné}, což dokazuje uzavřenost vůči uvedeným operacím také u rekurzivních jazyků.

\subsection{(Ne)uzavřenost vůči komplementu}

\begin{veta}
Třída rekurzivních jazyků je uzavřena vůči komplementu.
\end{veta}
Důkaz: Výměna $q_F$ a stavu $q_\text{REJECT}$.

Třída rekurzivně vyčíslitelných jazyků není uzavřena vůči komplementu!

\begin{veta}
Jsou-li jazyky $L$ i $\overline{L}$ rekurzivně vyčíslitelné, pak jsou oba rekurzivní.
\end{veta}

\section{Vlastnosti kontextových jazyků}
\begin{veta}
Třída kontextových jazyků je uzavřena vůči operacím $\cup, \cap, \cdot, *$ a komplementu.
\end{veta}
Důkaz podobně jako u rekurzivně spočetných. Komplement složitější (LOA je nedeterministický).

\begin{veta}
\end{veta}











%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Konečné automaty} \label{cha:18}

1. semestr, TIN, \texttt{opora.pdf}, 3. kapitola 1. a 2. sekce

(jazyky přijímané jazyky KA, varianty KA, minimalizace KA)

\subsection{Jazyky přijímané konečnými automaty a deterministický konečný automat}

\subsubsection{Konečný automat}
\begin{mydef}
Konečný automat (KA) je 5-tice $M = (Q, \Sigma, \delta, q_0, F)$, kde
\begin{enumerate}[(1)]
	\item $Q$ je konečná množina stavů
	\item $\Sigma$ je konečná vstupní abeceda
	\item $\delta$ je zobrazení $Q \times \Sigma \to 2^Q$, které nazýváme \emph{funkcí přechodu} ($2^Q$ je množina podmnožin množiny $Q$).
	\item $q_0 \in Q$ je počáteční stav
	\item $F \subseteq Q$ je množina koncových stavů
\end{enumerate}

Je-li $\forall q \in Q \forall a \in \Sigma: |\delta(q, a)| \leq 1$, pak $M$ nazýváme \emph{deterministickým konečným automatem} (zkráceně DKA), v případě, že $\exists q \in Q \exists a \in \Sigma : | \delta(q, a)| > 1$ pak \emph{nedeterministickým konečným automatem (NKA)}.

\emph{Deterministický konečný automat} často také definujeme jako 5-tici $M = (Q, \Sigma, \delta, q_0, F)$, kde $\delta$ je \emph{parciální} přechodová funkce tvaru $\delta: Q \times \Sigma \to Q$. Je-li přechodová funkce $\delta$ totální, pak $M$ nazýváme \emph{úplně definovaným deterministickým konečným automatem}.
\end{mydef}

\begin{lemma}
Ke každému DKA $M$ existuje \uv{ekvivalentní} úplně definovaný DKA $M'$.
\end{lemma}
(nový nekoncový SINK stav, do kterého povedou všechny chybějící přechody.)

\begin{mydef}
Je-li $M = (Q, \Sigma, \delta, q_0, F)$ konečný automat, pak dvojici $C = (q, w)$ z $Q \times \Sigma^*$ nazýváme konfigurací automatu $M$. Konfigurace tvaru $(q_0, w)$ je počáteční konfigurace, konfigurace tvaru $(q, \epsilon), q \in F$ je koncová konfigurace.
Přechod automatu $M$ je reprezentován binární relací $\vdash_M$ na množině konfigurací $C$.
Pro všechna $q, q' \in Q$ a $w, w' \in \Sigma^*$ definujeme, že platí $(q, w) \vdash_M (q', w')$ tehdy a jen tehdy když $w = aw'$ pro nějaké $a \in \Sigma$ a $q' \in \delta(q, a)$ (tj. $\delta(q, a) = Q_j, Q_j \in 2^Q, q' \in Q_j$).
Označíme symbolem $\vdash_M^k$, $k \geq 0$ k-tou mocninu ($C \vdash^0 C'$ právě když $C = C'$), symbolem $\vdash_M^+$ tranzitivní uzávěr a symbolem $\vdash_M^*$ tranzitivní a reflexivní uzávěr relace $\vdash_M$.
Bude-li zřejmé, že jde o automat $M$, pak uvedené relace zapíšeme pouze jako $\vdash, \vdash^k, \vdash^+, \vdash^*$.
\end{mydef}

\begin{mydef}
Říkáme, že vstupní řetězec $w$ je \emph{přijímán} konečným automatem $M$, jestliže $(q_0, w) \vdash^* (q, \epsilon), q \in F$. Jazyk přijímaný konečným automatem $M$ označujeme symbolem $L(M)$ a definujeme ho jako množinu všech řetězců přijímaných automatem $M$:
$L(M) = \{w | (q_0, w) \vdash^* (q, \epsilon) \land q \in F\}$
\end{mydef}

\begin{veta}
Každý \emph{nedeterministický} konečný automat $M$ lze převést na \emph{deterministický} konečný automat $M'$ tak, že $L(M) = L(M')$.
\end{veta}

\begin{alg}
Převod nedeterministického KA na ekvivalentní DKA\\
Vstup: NKA $M = (Q, \Sigma, \delta, q_0, F)$\\
Výstup: DKA $M = (Q', \Sigma, \delta', q_0', F')$\\
Metoda:
\begin{enumerate}
	\item Polož $Q' = 2^Q \backslash \{0\}$
	\item Polož $q_0' = \{q_0\}$
	\item Polož $F' = \{S | S \in 2^Q \land S \cap F \not= \emptyset\}$
	\item Pro všechna $S \in 2^Q \backslash \{\emptyset\}$ a pro všechna $a \in \Sigma$ polož:
	\begin{itemize}
		\item $\delta'(S, a) = \bigcup_{q \in S} \delta(q, a)$, je-li $\bigcup_{q \in S} \delta(q, a) \not= \emptyset$
		\item Jinak $\delta'(S, a)$ není definována.
	\end{itemize}
\end{enumerate}
\end{alg}

\subsection{Lineární a regulární gramatiky}

\begin{mydef}
\begin{itemize}
	\item Gramatika $G = (N, \Sigma, P, S)$ s pravidly tvaru:
	$A \to xB, \quad A, B \in N, x \in \Sigma^*$ nebo
	$A \to x, \quad x \in \Sigma^*$

	respektive tvaru
	$A \to Bx, \quad A, B \in N, x \in \Sigma^*$ nebo
	$A \to x, \quad x \in \Sigma^*$
	se nazývá \emph{pravá lineární}, resp. \emph{levá lineární} gramatika.
	\item Gramatika $G = (N, \Sigma, P, S)$ s pravidly tvaru:
	$A \to aB, \quad A, B \in N, a \in \Sigma$,
	$A \to a, \quad a \in \Sigma$, případně
	$S \to \epsilon$ (pokud se $S$ neobjevuje na pravá straně žádného pravidla)

	respektive tvaru
	$A \to Ba, \quad A, B \in N, a \in \Sigma$,
	$A \to a, \quad a \in \Sigma$, případně
	$S \to \epsilon$ (pokud se $S$ neobjevuje na pravá straně žádného pravidla)
	se nazývá \emph{pravá regulární}, resp. \emph{levá regulární} gramatika. Souhrnně \emph{regulární}.
\end{itemize}
\end{mydef}

\emph{Lineární gramatika} je gramatika s pravidly tvaru $A \to xBy$.
\begin{itemize}
	\item $\mathcal{L}_{PL}$ všechny jazyky generované pravými lineárními gramatikami
	\item $\mathcal{L}_{LL}$ všechny jazyky generované levými lineárními gramatikami
	\item $\mathcal{L}_{L}$ všechny jazyky generované lineárními gramatikami
\end{itemize}
$\mathcal{L}_{PL} = \mathcal{L}_{LL}$ a $\mathcal{L}_{PL} \subset \mathcal{L}_{L}$.

\begin{veta}
Každá pravá lineární gramatika $G = (N, \Sigma, P, S)$ (pravidla typu $A \to xB$ nebo $A \to x$, kde $A, B \in N, x \in \Sigma^*$), může být transformována na (pravou regulární) gramatiku $G' = (N', \Sigma, P', S')$, která obsahuje pravidla $A \to aB$ nebo $A \to \epsilon$, přičemž $L(G) = L(G')$.
\end{veta}

\begin{veta}
Každý jazyk typu 3 lze generovat pravou regulární gramatikou.
\end{veta}

\begin{veta}
Každý jazyk typu 3 může být generován levou lineární gramatikou.
\end{veta}

\begin{veta}
Každý jazyk typu 3 lze generovat levou regulární gramatikou.
\end{veta}

\subsection{Ekvivalence třídy $\mathcal{L}_3$ a třídy jazyků přijímaných konečnými automaty}

$\mathcal{L}_M$ třída jazyků přijímaných konečnými automaty.

\begin{veta}
Nechť $L$ je jazyk typu 3. Pak existuje konečný automat $M$ takový, že $L = L(M)$, tj. $\mathcal{L}_3 \subseteq \mathcal{L}_M$.
\end{veta}

\begin{veta}
Nechť $L = L(M)$ pro nějaký konečný automat $M$. Pak existuje gramatika $G$ typu 3 taková, že $L = L(G)$, tj. $\mathcal{L}_M \subseteq \mathcal{L}_3$.
\end{veta}

\begin{veta}
Třída jazyků, jež jsou přijímány konečnými automaty je totožná s třídou jazyků typu 3, Chomského hierarchie.
\end{veta}

\begin{alg}
Konstrukce nedeterministického KA k pravé regulární gramatice\\
Vstup: Pravá regulární gramatika  $G = (N, \Sigma, P, S)$, jejíž pravidla mají tvar $A \to aB$ a $A \to a$, kde $A,B \in N$ a $a \in \Sigma$, případně $S \to \epsilon$ za předpokladu, že $S$ se nevyskytuje na pravé straně žádného pravidla.\\
Výstup: NKA $M = (Q, \Sigma, \delta, q_0, F)$, pro který je $L(M) = L(G)$\\
Metoda:
\begin{enumerate}
	\item Polož $Q = N \cup \{q_F\}$
	\item Množina vstupních symbolů automatu $M$ je identická s množinou terminálů gramatiky $G$
	\item Funkci přechodů $\delta$ definujeme takto:
	\begin{enumerate}
		\item Je-li $A \to aB$ pravidlo z $P$, pak $\delta(A, a)$ obsahuje stav $B$.
		\item Je-li $A \to a$ pravidlo z $P$, pak $\delta(A, a)$ obsahuje stav $q_F$.
	\end{enumerate}
	\item $q_0 = S$
	\item Je-li $S \to \epsilon$ pravidlo z $P$, pak $F = \{S, q_F\}$ v opačném případě $F = \{q_F\}$.
\end{enumerate}
\end{alg}

\begin{veta}
Nechť $G$ je pravá regulární gramatika a $M$ je konečný automat z předchozího algoritmu. Pak $L(M) = L(G)$.
\end{veta}

\begin{alg}
Konstrukce nedeterministického KA k levé regulární gramatice \\
Vstup: Levá regulární gramatika  $G = (N, \Sigma, P, S)$, jejíž pravidla mají tvar $A \to Ba$ a $A \to a$, kde $A,B \in N$ a $a \in \Sigma$, případně $S \to \epsilon$ za předpokladu, že $S$ se nevyskytuje na pravé straně žádného pravidla.\\
Výstup: NKA $M = (Q, \Sigma, \delta, q_0, F)$, pro který je $L(M) = L(G)$\\
Metoda:
\begin{enumerate}
	\item Polož $Q = N \cup \{q_0\}$
	\item Množina vstupních symbolů automatu $M$ je identická s množinou terminálů gramatiky $G$
	\item Funkci přechodů $\delta$ definujeme takto:
	\begin{enumerate}
		\item Je-li $A \to Ba$ pravidlo z $P$, pak $\delta(B, a)$ obsahuje stav $A$.
		\item Je-li $A \to a$ pravidlo z $P$, pak $\delta(q_0, a)$ obsahuje stav $A$.
	\end{enumerate}
	\item $q_0$ je počáteční stav automatu $M$
	\item Je-li $S \to \epsilon$ pravidlo z $P$, pak $F = \{S, q_0\}$ v opačném případě $F = \{S\}$.
\end{enumerate}
\end{alg}

\begin{veta}
Nechť $G$ je pravá regulární gramatika a $M$ je konečný automat z předchozího algoritmu. Pak $L(M) = L(G)$.
\end{veta}

\section{Minimalizace deterministického konečného automatu}

\begin{mydef}
Deterministický konečný automat $M = (Q, \Sigma, \delta, q_0, F)$ nazýváme \emph{úplný deterministický konečný automat}, pokud pro všechna $q \in Q$ a všechna $a \in \Sigma$ platí, že $\delta(q, a) \in Q$, tj. $\delta$ je totální funkcí na $Q \times \Sigma$.
\end{mydef}

\begin{mydef}
Nechť $M=(Q, \Sigma, \delta, q_0, F)$ je konečný automat. Stav $q \in Q$ nazveme \emph{dosažitelný}, pokud existuje $w \in \Sigma^*$ takové, že $(q_0, w) \underset{M}{\overset{*}{\vdash}} (q, \epsilon)$.
Stav je nedosažitelný, pokud není dosažitelný.
\end{mydef}

\begin{alg}
Eliminace nedosažitelných stavů \\
Vstup: Deterministická KA $M = (Q, \Sigma, \delta, q_0, F)$\\
Výstup: Deterministický KA $M'$ bez nedosažitelných stavů, $L(M) = L(M')$\\
Metoda:
\begin{enumerate}
	\item $i := 0$
	\item $S_I := \{q_0\}$
	\item \texttt{repeat}
	\begin{enumerate}
		\item $S_{i+1} := S_i \cup \{q | \exists p \in S_i \exists a \in \Sigma: \delta(p, a) = q \}$
		\item $i := i + 1$
	\end{enumerate}
	\item \texttt{until} $S_i = S_{i-1}$
	\item $M' := (S_i, \Sigma, \delta_{S_i}, q_0, F \cap S_i)$.
\end{enumerate}
\end{alg}

\begin{mydef}
Nechť $M = (Q, \Sigma, \delta, q_0, F)$ je úplný DKA. Říkáme, že řetězec $w \in \Sigma^*$ rozlišuje stavy z $Q$, jestliže
$(q_1, w) \underset{M}{\overset{*}{\vdash}} (q_3, \epsilon) \land (q_2, w) \underset{M}{\overset{*}{\vdash}} (q_4, \epsilon)$ pro nějaké $q_3, q_4$  a právě jeden ze stavů $q_3, q_4$ je v $F$. Říkáme, že stavy $q_1, q_2 \in Q$ jsou k-nerozlišitelné a píšeme $q_1 \overset{k}{\equiv} q_2$, právě když neexistuje $w \in \Sigma^*, |w| \leq k$, který rozlišuje $q_1$ a $q_2$. Stavy jsou nerozlišitelné, značíme $q_1 \equiv q_2$, jsou-li pro každé $k \geq 0$, $k$-nerozlišitelné.
\end{mydef}

\begin{mydef}
Úplně definovaný DKA nazýváme \emph{redukovaný}, jestliže žádný stav $Q$ není nedostupný a žádné dva stavy nejsou nerozlišitelné.
\end{mydef}

\begin{veta}
Nechť $M=(Q,\Sigma,\delta,q_0,F)$ je úplný DKA a $|Q| = n, n \geq 2$. Platí $\forall q_1, q_2 \in Q: q_1 \equiv q_2 \Leftrightarrow q_1 \overset{n-2}{\equiv} q_2$.
\end{veta}

\begin{alg}
Převod na redukovaná deterministický konečný automat\\
Vstup: Úplně definovaný DKA $M = (Q, \Sigma, \delta, q_0, F)$\\
Výstup: Redukovaný DKA $M'$ bez nedosažitelných stavů, $L(M) = L(M')$\\
Metoda:
\begin{enumerate}
	\item Odstraň nedosažitelné stavy využitím předchozího algoritmu
	\item $i := 0$
	\item $\overset{0}{\equiv} := \{(p, q)|p \in F \Leftrightarrow q \in F\}$
	\item \texttt{repeat}
	\begin{enumerate}
		\item $\overset{i+1}{\equiv} := \{(p, q)|p \overset{i}{\equiv} q \land \forall a \in \Sigma: \delta(p,a) \overset{i}{\equiv} \delta(q, a)\}$
		\item $i := i + 1$
	\end{enumerate}
	\item \texttt{until} $\overset{i+1}{\equiv} = \overset{i}{\equiv}$
	\item $Q' := Q/\overset{i}{\equiv}$
	\item $\forall p,q \in Q \forall a \in \Sigma: \delta'([p], a) = [q] \Leftrightarrow \delta(p,a) = q$
	\item $q_0' = [q_0]$
	\item $F' = \{[q] | q \in F\}$
\end{enumerate}
(výraz $[x]$ značí ekvivalenční třídu určenou prvkem $x$)
\end{alg}







%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Regulární množiny, regulární výrazy a rovnice nad regulárními výrazy.} \label{cha:19}
1. semestr, TIN, \texttt{opora.pdf}, 3. kapitola 3. sekce

\section{Regulární množiny}

\begin{mydef}
Nechť $\Sigma$ je konečná abeceda. \emph{Regulární množinu} nad abecedou $\Sigma$ definujeme rekurzivně takto:
\begin{enumerate}
	\item $\emptyset$ (prázdná množina) je regulární množina nad $\Sigma$
	\item $\{ \epsilon \}$ (množina obsahující pouze prázdný řetězec) je regulární množina nad $\Sigma$
	\item $\{ a \}$ pro všechna $a \in \Sigma$ je regulární množina nad $\Sigma$
	\item Jsou-li $P$ a $Q$ regulární množiny nad $\Sigma$, pak také $P \cup Q, P \cdot Q$ a $P^*$ jsou regulární množiny nad $\Sigma$.
	\item regulárními množinami jsou právě ty množiny, které lze získat aplikací 1 -- 4.
\end{enumerate}
\end{mydef}
Nejmenší třída jazyků, uzavřená vzhledem k operacím sjednocení, součinu a iterace.

\begin{veta}
Nechť $\Sigma$ je konečná abeceda. Pak $\emptyset, \{\epsilon\}, \{a\}$ (pro všechna $a \in \Sigma$ jsou jazyky typu 3 nad abecedou $\Sigma$.
\end{veta}

\begin{veta}
Nechť $L_1$ a $L_2$ jsou jazyky typu 3 nad abecedou $\Sigma$. Pak $L_1 \cup L_2$, $L_1 \cdot L_2$, $L_1^*$ jsou jazyky typu 3 nad abecedou $\Sigma$.
\end{veta}

\section{Regulární výrazy}

Notace pro reprezentaci regulárních množin.

\begin{mydef}
Regulární výrazy nad $\Sigma$ a regulární množiny, které označují, jsou rekurzivně definovány takto:
\begin{enumerate}
	\item $\emptyset$ je regulární výraz označující regulární množinu $\emptyset$
	\item $\epsilon$ je regulární výraz označující regulární množinu $\{ \epsilon \}$
	\item $a$ je regulární výraz označující regulární množinu $\{ a \}$ pro všechna $a \in \Sigma$
	\item Jsou-li $p$ a $q$ regulární výrazy označující regulární množiny $P$ a $Q$, pak
	\begin{enumerate}
		\item $(p+q)$ je regulární výraz označující regulární množinu $P \cup Q$
		\item $(pq)$ je regulární výraz označující regulární množinu $P \cdot Q$
		\item $(p*)$ je regulární výraz označující regulární množinu $P^*$
	\end{enumerate}
	\item Žádní jiné regulární výrazy na $\Sigma$ neexistují
\end{enumerate}
\end{mydef}

Regulární výraz $p^+$ značí regulární výraz $pp^*$; Abychom minimalizovali počet závorek, stanovujeme priority operátorů $^*$ a $^+$ (iterace -- nejvyšší priorita), $\cdot$ (konkatenace), $+$ (alternativa).

\begin{mydef}
Kleeneho algebra sestává z neprázdné množiny se dvěma význačnými konstantami $0$ a $1$, dvěma binárními operacemi $+$ a $\cdot$ a unární operací $^*$, které splňují následující axiomy:

\begin{subequations}
\begin{align*}
	& a + (b + c) = (a + b) + c		& \text{ asociativita } + 				\quad & [A.1] \\
	& a + b = b + a					& \text{ komutativita } +				\quad & [A.2] \\
	& a + a = a						& \text{ idempotence } + 				\quad & [A.3] \\
	& a + 0 = a						& 0 \text{ je identitou pro } + 		\quad & [A.4] \\
	& a(bc) = (ab)c					& \text{ asociativita } \cdot 			\quad & [A.5] \\
	& a1 = 1a = a					& 1 \text{ je identitou pro } \cdot		\quad & [A.6] \\
	& a0 = 0a = 0					& 0 \text{ je anihilátorem pro } \cdot	\quad & [A.7] \\
	& a(b + c) = ab + ac			& \text{ distributivita zleva }			\quad & [A.8] \\
	& (a + b)c = ac + bc			& \text{ distributivita zprava }		\quad & [A.9] \\
	& 1 + aa^* = a^*				&										\quad & [A.10] \\
	& 1 + a^*a = a^*				&										\quad & [A.11] \\
	& b + ac \leq c \Rightarrow a^*b \leq c &								\quad & [A.12] \\
	& b + ca \leq c \Rightarrow ba^* \leq c &								\quad & [A.13] \\
\end{align*}
\end{subequations}
(poslední dva axiomy reprezentují $\leq$ uspořádání definované takto: $a \leq b \xLeftrightarrow{def} a+b=b$.
\end{mydef}

Některé teorémy Kleeneho algebry:
\begin{subequations}
\begin{align*}
	& 0^* = 1						& \\
	& 1 + a^* = a^*					& \\
	& a^* = a + a^*					& \\
	& a^* a^* = a^*					& \\
	& a^{*^*} = a^*					& \\
	& (a^*b)^*a* = (a + b)^*		& \text{ pravidlo \uv{vynořování} }		\quad & [R.16] \\
	& a (ba)^* = (ab)^* a			& \text{ pravidlo posuvu }				\quad & [R.14] \\
	& a^* = (aa)^* + a (aa)^*		& \\
\end{align*}
\end{subequations}

\section{Rovnice nad regulárními výrazy}

\begin{mydef}
Rovnice, jejímiž složkami jsou koeficienty a neznámí, které reprezentují (dané a hledaní) regulární výrazy, nazýváme \emph{rovnicemi nad regulárními výrazy}.
\end{mydef}

Nemusí existovat jediné řešení, obvykle hledáme nejmenší řešení, nejmenší pevný bod.

\begin{veta}
Nejmenším pevným bodem rovnice $X = pX + q$ je $X = p^*q$
\end{veta}

\section{Soustavy rovnic nad regulárními výrazy}

\begin{mydef}
Soustava rovnic nad regulárními výrazy je ve \emph{standardním tvaru} vzhledem k neznámým $\Delta = \{X_1, X_2, \dots, X_n\}$, má-li soustava tvar

$$\bigwedge_{i \in \{1, \dots, n} X_i = \alpha_{i0} + \alpha_{i1}X_1 + \alpha_{i2}X_2 + \dots + \alpha_{in}X_n$$

kde $\alpha_{ij}$ jsou regulární výrazy nad nějakou abecedou $\Sigma, \Sigma \cap \Delta = \emptyset$.
\end{mydef}

\begin{veta}
Je-li soustava rovnic nad regulárními výrazy ve standardním tvaru, pak existuje její minimální pevný bod a algoritmus k jeho nalezení.
\end{veta}
Algoritmus: Vyjadřujeme hodnotu jednotlivých proměnných pomocí řešení rovnice $X=pX + q$ jako regulární výraz s proměnnými, jejichž počet se postupně snižuje:
Z rovnice pro $X_n$ vyjádříme např. $X_n$ jako regulární výraz nad $\Sigma$ a $X_1, \dots, X_{n-1}$.
Dosadíme za $X_n$ do rovnice $X_{n-1}$ a postup opakujeme.
Jsou přitom možné (ale ne nutné) různé optimalizace tohoto pořadí.

\begin{veta}
Každý jazyk generovaný gramatikou typu 3 je regulární množinou $\mathcal{L}_3 \subseteq \mathcal{L}_R$.
\end{veta}
Vytvoříme soustavu rovnic nad regulárními výrazy s proměnnými $X_1, \dots, X_n$ ve standardním tvaru popisující množinu řetězců přijímaných ze stavu $Q_i$. Koncové stavy přijímají $\epsilon$.

Regulární přechodový graf je zobecněním konečného automatu s regulárními výrazy na hranách.

\section{Převod regulárních výrazů na konečné automaty}

\begin{mydef}
\emph{Rozšířený konečný automat} (RKA) je pětice $M=(Q, \Sigma, \delta, q_0, F)$, kde:
\begin{enumerate}
	\item $Q$ je konečná množina stavů
	\item $\Sigma$ konečná vstupní abeceda
	\item $\delta$ je zobrazení $Q \times (\Sigma \cup \{\epsilon\}) \to 2^Q$
	\item $q_0 \in Q$ je počáteční stav
	\item $F \subseteq Q$ je množina koncových stavů
\end{enumerate}
\end{mydef}

\begin{mydef}
Klíčovou funkci v algoritmu převodu RKA na DKA má výpočet funkce, která k danému stavu určí množinu všech stavů, jež jsou dostupné po $\epsilon$ hranách diagramu přechodů funkce $\delta$. Označme tuto funkci $\epsilon$-uzávěr:
$$\epsilon\text{-uzávěr}(q) = \{p | \exists w \in \Sigma^*: (q, w) \overset{*}{\vdash} (p, w)\}$$
Funkci $\epsilon$-uzávěr zobecníme tak, aby argumentem mohla být množina $T \in Q$:
$$\epsilon\text{-uzávěr}(q) = \bigcup\limits_{s \in T} \epsilon\text{-uzávěr}(s)$$
\end{mydef}

\begin{alg}
Převod rozšířeného konečného automatu na deterministický konečný automat\\
Vstup: Rozšířený konečný automat $M = (Q, \Sigma, \delta, q_0, F)$\\
Výstup: Deterministický konečný automat $M = (Q', \Sigma, \delta', q_0', F')$, $L(M) = L(M')$\\
Metoda:
\begin{enumerate}
	\item $Q := 2^Q \backslash \{\emptyset\}$
	\item $q' := \epsilon\text{-uzávěr}(q_0)$
	\item $\delta': Q' \times \Sigma \to Q'$ je vypočtena takto:
	\begin{enumerate}
		\item Nechť $\forall T \in Q', a \in \Sigma: \overline{\delta}(T, a) = \bigcup_{q \in T}(q, a)$
		\item Pak pro každé $T \in Q', a \in \Sigma$:
		\begin{enumerate}
			\item pokud $\overline{\delta}(T, a) \not= \emptyset$, pak $\delta'(T, a) = \epsilon\text{-uzávěr}(\overline{\delta}(T, a))$
			\item jinak $\delta'(T, a)$ není definována
		\end{enumerate}
	\end{enumerate}
	\item $F' := \{S | S \ in Q' \land S \cap F \not= \emptyset\}$
\end{enumerate}
\end{alg}

\begin{alg}
Převod regulárního výrazu na rozšířený konečný automat\\
Vstup: Regulární výraz $r$ popisující regulární množinu $R$ nad $\Sigma$\\
Výstup: Rozšířený konečný automat $M$, takový, že $L(M) = R$\\
Metoda:
\begin{enumerate}
	\item Rozložíme $r$ na jeho primitivní složky podle rekurzivní definice regulární množiny/výrazu
	\begin{enumerate}
		\item Pro výraz $\epsilon$ zkonstruujeme automat 
\begin{tikzpicture}[shorten >=1pt,node distance=1.5cm,on grid,auto]
   \node[state,initial] (s)   {$s$};
   \node[state,accepting](f) [right=of s] {$f$};
   \path[->] (s) edge  node {$\epsilon$} (f);
\end{tikzpicture}
		\item Pro výraz $a$, $a \in \Sigma$ zkonstruujeme automat
\begin{tikzpicture}[shorten >=1pt,node distance=1.5cm,on grid,auto]
   \node[state,initial] (s)   {$s$};
   \node[state,accepting](f) [right=of s] {$f$};
   \path[->] (s) edge  node {$a$} (f);
\end{tikzpicture}
		\item Pro výraz $\emptyset$ zkonstruujeme automat
\begin{tikzpicture}[shorten >=1pt,node distance=1.5cm,on grid,auto]
   \node[state,initial] (s)   {$s$};
   \node[state,accepting](f) [right=of s] {$f$};
\end{tikzpicture}
		\item Nechť $N_1$ je automat přijímající jazyk specifikovaný výrazem $r_1$ a $N_2$ je automat přijímající jazyk specifikovaný výrazem $r_2$.
		\begin{enumerate}
			\item Pro výraz $r_1 + r_2$ zkonstruujeme automat
\begin{tikzpicture}[shorten >=1pt,node distance=1.5cm,on grid,auto]
	\node[state,initial] (s)   {$s$};
	\node[state] (n1) [above right=of s]  {};
	\node[state] (n2) [right=of s]  {};
	\node[state] (n3) [right=of n1]  {};
	\node[state] (n4) [right=of n2]  {};
	\node[state,accepting](f) [right=of n4] {$f$};
	\path[->]
		(s) edge  node {$\epsilon$} (n1)
		(s) edge  node {$\epsilon$} (n2)
		(n3) edge  node {$\epsilon$} (f)
		(n4) edge  node {$\epsilon$} (f)
		;
	\node [draw=red, fit= (n1) (n3)] {$N_1$};
	\node [draw=blue, fit= (n2) (n4)] {$N_2$};
\end{tikzpicture}
			\item Pro výraz $r_1 r_2$ zkonstruujeme automat
\begin{tikzpicture}[shorten >=1pt,node distance=1.5cm,on grid,auto]
	\node[state,initial] (n1) {};
	\node[state] (n2) [right=of n1]  {};
	\node[state,accepting] (n3) [right=of n2]  {};
	\node [draw=red, fit= (n1) (n2)] {$N_1$};
	\node [draw=blue, fit= (n2) (n3)] {$N_2$};
\end{tikzpicture}
			\item Pro výraz $r_1^*$ zkonstruujeme automat
\begin{tikzpicture}[shorten >=1pt,node distance=1.5cm,on grid,auto]
	\node[state,initial] (s)   {$s$};
	\node[state] (n1) [right=of s]  {};
	\node[state] (n2) [right=of n1]  {};
	\node[state,accepting](f) [right=of n2] {$f$};
	\path[->]
		(s) edge  node {$\epsilon$} (n1)
		(s) edge [bend right,above] node {$\epsilon$} (f)
		(n2) edge [bend right,below] node {$\epsilon$} (n1)
		(n2) edge  node {$\epsilon$} (f)
		;
	\node (N) [draw=red, fit= (n1) (n2)] {};
	\node [yshift=2.0ex] at (N.south) {$N_1$};
\end{tikzpicture}
		\end{enumerate}
	\end{enumerate}
\end{enumerate}
\end{alg}

Konečné automaty, gramatiky typu 3 a regulární výrazy mají ekvivalentní vyjadřovací sílu.





























%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Transformace a normální formy bezkontextových gramatik.} \label{cha:20}
1. semestr, TIN, \texttt{opora.pdf}, 4. kapitola, sekce 1. - 8.

\begin{mydef}
Bezkontextová gramatika $G$ je čtveříce $G = (N, \Sigma, P, S)$
\begin{enumerate}
	\item $N$ je konečná množina nonterminálních symbolů
	\item $\Sigma$ je konečná množina terminálních symbolů
	\item $P$ je konečná množina přepisovacích pravidel tvaru $A \to \alpha, A \in N$ a $\alpha \in (N \cup \Sigma)$.
	\item $S$ je výchozí symbol gramatiky.
\end{enumerate}
\end{mydef}

\section{Derivační strom}
Strom je orientovaný acyklický graf s těmito vlastnostmi:
\begin{enumerate}
	\item Existuje jediný uzel, tzv. \emph{kořen stromu}, do něhož nevstupuje žádná hrana
	\item Do všech ostatních uzlů vstupuje právě jedna hrana.
\end{enumerate}
Uzly z nichž žádná hrana nevystupuje, se nazývají \emph{koncové uzly stromu} (listy).

\begin{mydef}
Nechť $\delta$ je věta nebo větná forma generovaná v gramatice $G=(N,\Sigma,P,S)$ a nechť $S=\nu_0 \Rightarrow \nu_1 \Rightarrow \dots \Rightarrow \nu_k = \delta$ její derivace v $G$. Derivační strom příslušející této derivaci je strom s těmito vlastnostmi:
\begin{enumerate}
	\item Uzly derivačního stromu jsou (ohodnoceny) symboly z množiny $N \cup \Sigma$; kořen stromu je označen výchozím symbolem $S$.
	\item Přímé derivací $\nu_{i-1} \Rightarrow \nu_i, i \in 1,2 \dots, k$, kde
	
	$\nu_{i-1} = \mu A \lambda, \mu, \lambda \in (N \cup \Sigma)^*, A \in N\\
	\nu_i = \mu \alpha \lambda \\
	A \to \alpha, \alpha = X_1, \dots X_n \text{ je pravidlo z } P$
	
	odpovídá právě $n$ hran $(A, X_j), j =  1, \dots, n$ vycházejících z uzlu $A$ jež jsou uspořádány zleva doprava v pořadí $(A, X_1), (A, X_2), \dots, (A, X_n)$.
	
	\item Označení koncových uzlů derivačního stromu vytváří zleva doprava větnou formu nebo větu $\delta$.
\end{enumerate}
\end{mydef}

\begin{mydef}
Nechť $S = \alpha_1 \Rightarrow \alpha_2 \Rightarrow \dots \Rightarrow \alpha_n = \alpha$ je derivace větné formy $\alpha$. Jestliže byl v každém řetězci $\alpha_i, i = 1, \dots, n-1$ přepsán nelevější (nejpravější) nonterminál, pak tuto derivaci nazýváme levou (pravou) derivací větné formy $\alpha$.
\end{mydef}

\section{Fráze větné formy}
\begin{mydef}
Nechť $G = (N, \Sigma, P, S)$ je gramatika a nechť řetězec $\lambda = \alpha \beta \gamma$ je větná forma. Podřetězec $\beta$ se nazývá \emph{frází větné formy} $\lambda$, vzhledem k nonterminálu $A$ z $N$, jestliže platí:
$$S \Rightarrow^* \alpha A \gamma$$
$$A \Rightarrow^+ \alpha \beta$$
Podřetězec $\beta$ je \emph{jednoduchou frází větné formy} $\lambda$, jestliže platí
$$S \Rightarrow^* \alpha A \gamma$$
$$A \Rightarrow \alpha \beta$$
\end{mydef}

Nejlevější jednoduchá fráze se nazývá \emph{l-fráze}.

\section{Víceznačnost gramatik}

\begin{mydef}
Nechť $G$ je gramatika. Říkáme, že věta $w$ generovaná gramatikou $G$ je víceznačná, existují-li aspoň dvě různé derivační stromy s koncovými uzly tvořící větu $w$.
\emph{Gramatika $G$ je víceznačná}, jestliže generuje alespoň jednu víceznačnou větu. V opačném případě mluvíme o jednoznačné gramatice.
\end{mydef}

Jazyky, které nelze generovat jednoznačnou gramatikou se nazývají jazyky s \emph{inherentní víceznačností}.

Pro bezkontextové gramatiky je dokázáno, že problém, zda daná gramatika je nebo není víceznačná, je nerozhodnutelný, tj. neexistuje algoritmus, který by v konečném čase odhalil víceznačnost každé bezkontextové gramatiky.

Gramatika s pravidlem $A \to A$ je zřejmě víceznačná. Tot pravidlo můžeme vypustit, aniž bychom změnili jazyk generovaný takto zredukovanou gramatikou.

Nejednoznačná gramatika podmíněných příkazů: \texttt{if (x) if (y) S else S}. Nežádoucí interpretace bývá zajištěna dodatečným sémantickým pravidlem.

\section{Rozklad věty}
Konstrukci derivace či derivačního stromu pro danou větu nebo větnou formu nazýváme \emph{rozkladem} nebo \emph{syntaktickou analýzou} této věty nebo větné formy. Pro gram, který provádí rozklad vět určitého jazyka se nazývá \emph{syntaktický analyzátor} (parser).

\begin{itemize}
	\item Syntaktická analýza shora dolů (od výchozího symbolu gramatiky)
	\item Syntaktická analýza zdola nahoru (od koncových uzlů)
\end{itemize}

Hledání prvního podřetězce věty (v dalších krocích větných forem), nazývaného \emph{l-fráze}. Problém: Které pravidlo použít? Jak určit začátek a konec l-fráze? Možnosti:
\begin{itemize}
	\item Syntaktická analýza s návratem: Náhodný výběr některého z pravidel a návrat, pokud alternativa nebyla správná. 
	\item Syntaktická analýza bez návratu (Deterministické gramatiky): které dokáží na základě kontextu zpracovávaného řetězce určit správnou alternativu v každém kroku analýzy.
\end{itemize}

\section{Transformace bezkontextových gramatik}

\begin{mydef}
Říkáme, že gramatiky $G_1$ a $G_2$ jsou ekvivalentní, jestliže platí $L(G_1) = L(G_2)$, tj. jestliže jimi generované jazyky jsou totožné.
\end{mydef}

\begin{mydef}
Nechť $G=(N,\Sigma,P,S)$ je gramatika. Říkáme, že symbol $X \in (N \cup \Sigma)$ je v gramatice $G$ zbytečný, jestliže neexistuje derivace tvaru $S \Rightarrow^* w X y \Rightarrow^* wxy$, kde řetězce $w, x, y \in \Sigma^*$.
\end{mydef}

\begin{alg}
Je $L(G)$ neprázdný?\\
Vstup: Gramatika $G = (N, \Sigma, P, S)$\\
Výstup: ANO je-li $L(G) \not= \emptyset$, NE v opačném případě.\\
Metoda:
\begin{enumerate}
	\item $N_0 = \emptyset, i = 1$
	\item $N_1 = \{A | A \to \alpha \in P \land \alpha \in (N_{i-1} \cup \Sigma)^*\}$
	\item Je-li $N_i \not= N_{i-1}$, polož $i = i + 1$ a vrať se ke kroku 2.
	\item Je-li $N_i = N_{n-1}$ polož $N_t = N_i$
	\item Jestliže výchozí symbol $S$ je v $N_t$, pak je výstup ANO, jinak NE
\end{enumerate}
\end{alg}
Algoritmus skončí po max. $n+1$ krocích, kde $n$ je počet nonterminálů.

\begin{veta}
Předchozí algoritmus má výstup ANO, právě když $S \Rightarrow^* w$ pro nějaké $w \in \Sigma^*$.
\end{veta}

\begin{mydef}
Říkáme, že symbol $X \in (N \cup \Sigma)$ je \emph{nedostupný} v gramatice $G = (N, \Sigma, T, S)$, jestliže $X$ se nemůže objevit v žádné větné formě.
\end{mydef}

\begin{alg}
Odstranění nedostupných symbolů\\
Vstup: Gramatika $G = (N, \Sigma, P, S)$\\
Výstup: Gramatika $G' = (N', \Sigma', P', S')$, pro kterou platí:
\begin{itemize}
	\item $L(G) = L(G')$
	\item Pro všechna $X \in (X' \cup \Sigma')$ existují řetězce $\alpha, \beta \in (N' \cup \Sigma')^*$ tak, že $S \Rightarrow^* \alpha X \beta \in G'$.
\end{itemize}
Metoda:
\begin{enumerate}
	\item Položíme $V_0 = \{S\}$ a $i = 1$
	\item Konstruujeme $V_1 = \{X | A \to \alpha X \beta \in P \land A \in V_{i-1}\} \cup V_{i-1}$
	\item Je-li $V_i \not= V_{i-1}$, polož $i = i + 1$ a vrať se ke kroku 2.
	\item Je-li $V_i = N_{n-1}$, pak:
	\begin{itemize}
		\item $N' = V_i \cap N$
		\item $\Sigma' = V_i \cap \Sigma$
		\item $P' \subseteq P$ obsahuje ta pravidla, která jsou tvořena pouze symboly z $V_i$.
	\end{itemize}
\end{enumerate}
\end{alg}

\begin{alg}
Odstranění zbytečných symbolů\\
Vstup: Gramatika $G = (N, \Sigma, P, S)$ generující neprázdný jazyk\\
Výstup: Gramatika $G' = (N', \Sigma', P', S')$, pro kterou platí:
\begin{itemize}
	\item $L(G) = L(G')$
	\item Žádný symbol z $X \in (X' \cup \Sigma')$ není zbytečný
\end{itemize}
Metoda:
\begin{enumerate}
	\item Na gramatiky $G$ aplikuj předchozí algoritmus 1 a získej množinu $N_t$ obsahující symboly generující věty jazyka.\\
	Polož $\overline{G} = (N_t \cup \{S\}, \Sigma, P_1, S)$, kde $P_1$ obsahuje pravidla tvořená pouze symboly z $N_t \cup \Sigma$.
	\item Algoritmus 2 odstraňující nedostupné symboly aplikuj na gramatiku $\overline{G}$. Výsledkem je gramatika $G' = (N', \Sigma', P', S)$, která neobsahuje zbytečné symboly.
\end{enumerate}
\end{alg}

\begin{veta}
Gramatika $G'$ z předchozího algoritmu je ekvivalentní gramatice  $G$ a nemá zbytečné symboly.
\end{veta}

\begin{mydef}
Říkáme, že gramatika $G = (N, \Sigma, P, S)$ je \emph{gramatikou bez $\epsilon$-pravidel}, jestliže buď $P$ neobsahuje žádné $\epsilon$-pravidlo, nebo v případě $\epsilon \in L(G)$, existuje jediné $\epsilon$-pravidlo tvaru $S \to \epsilon$ a výchozí symbol $S$ se nevyskytuje na pravé straně žádného pravidla z $P$.
\end{mydef}

\begin{alg}
Transformace na gramatiku bez $\epsilon$-pravidel\\
Vstup: Gramatika $G = (N, \Sigma, P, S)$ generující neprázdný jazyk\\
Výstup: Ekvivalentní gramatika $G' = (N', \Sigma', P', S')$ bez $\epsilon$-pravidel\\
Metoda:
\begin{enumerate}
	\item Sestroj $N_\epsilon = \{ A | A \in N \land A \Rightarrow^* \epsilon \}$. Konstrukce analogická konstrukci $N_t$ v prvním algoritmu.
	\item Nechť $P'$ je množina pravidel, kterou konstruujeme takto:
	\begin{enumerate}
		\item Jestliže $A \to \alpha_0 B_1 \alpha_1 B_2 \dots B_k \alpha_k \in P, k \geq 0$ a každé $B_i \in N_\epsilon, 1 \leq i \leq k$, avšak žádný ze symbolů řetězců $\alpha_j$ není v $N_\epsilon, 0 \leq j \leq k$, pak k $P'$ přidej všechna nová pravidla tvaru
		$$A \to \alpha_0 X_1 \alpha_1 X_2 \dots X_k \alpha_k$$
		kde $X_i$ je buď $B_i$ nebo $\epsilon$. Nepřidávej $\epsilon$-pravidlo $A \to \epsilon$, které se objeví, jsou-li všechna $\alpha_i = \epsilon$.
		\item Jestliže $S \in N_\epsilon$ pak k $P'$ přidej pravidla
		$$S' \to \epsilon | S $$
		kde $S'$ je nový výchozí symbol. Poté polož $N' = N \cup \{S'\}$. Jestliže $S \not\in N_\epsilon$, pak $N' = N$ a $S' = S$
	\end{enumerate}
	\item Výsledná gramatika má tvar $G' = (N', \Sigma', P', S')$
\end{enumerate}
\end{alg}

\begin{veta}
Předchozí algoritmus převádí vstupní gramatiku $G$ na ekvivalentní gramatiku $G'$ bez $\epsilon$-pravidel.
\end{veta}

\begin{mydef}
Přepisovací pravidlo $A \to B, A,B \in N$ se nazývá jednoduché pravidlo.
\end{mydef}

\begin{alg}
Odstranění jednoduchých pravidel\\
Vstup: Gramatika $G = (N, \Sigma, P, S)$ bez $\epsilon$-pravidel\\
Výstup: Ekvivalentní gramatika $G' = (N, \Sigma, P', S)$ bez jednoduchých pravidel\\
Metoda:
\begin{enumerate}
	\item Pro každé $A \in N$ sestroj $N_A = \{ B | A \Rightarrow^* B \}$ takto:
	\begin{enumerate}
		\item $N_0 = \{A\}, i = 1$
		\item $N_1 = \{C | B \to C \in P \land B \in N_{i-1}\}$
		\item Jestliže $N_i \not= N_{i-1}$ polož $i = i + 1$ a opakuj krok b)
		\item V opačném případě je $N_A = N_i$.
	\end{enumerate}
	\item Sestroj $P'$ takto: Jestliže $B \to \alpha \in P$ a není jednoduchým pravidlem, pak pro všechna $A$ pro něž platí $B \in N_A$ přidej k $P'$ pravidla $A \to \alpha$
	\item Výsledná gramatika je $G' = (N, \Sigma, P', S)$
\end{enumerate}
\end{alg}

\begin{veta}
Předchozí algoritmus převádí vstupní gramatiku $G$ na ekvivalentní gramatiku $G'$ bez jednoduchých pravidel.
\end{veta}

\begin{mydef}
Říkáme, že $G$ je \emph{gramatika bez cyklů}, jestliže v ní neexistuje derivace tvaru $A \Rightarrow^+ A$ pro žádné $A \in N$. Jestliže $G$ je gramatika bez cyklů a bez $\epsilon$-pravidel a nemá žádné zbytečné symboly, pak říkáme, že $G$ je \emph{vlastní gramatika}.
\end{mydef}

\begin{veta}
Je-li $L$ bezkontextový jazyk, pak existuje jeho vlastní gramatika $G$ taková, že $L = L(G)$.
\end{veta}

Gramatika, která obsahuje cykly je víceznačná a nemůže být použita v konstrukci deterministického syntaktického analyzátoru.

\begin{mydef}
Nechť $G=(N, \Sigma, P, S)$. Přepisovací pravidlo z $P$ se nazývá \emph{rekurzivní zleva (rekurzivní zprava)}, jestliže je tvaru $A \to A \alpha (A \to \alpha A), A \in N, \alpha \in (N \cup \Sigma)^*$. Jestliže v $G$ existuje derivace $A \Rightarrow^+ \alpha A \beta$ pro nějaké $A \in N$, říkáme, že gramatika $G$ je rekurzivní. Je-li $\alpha = \epsilon$, pak mluvíme o \emph{gramatice rekurzivní zleva}, je-li $\beta = \epsilon$, pak říkáme, že $G$ je \emph{rekurzivní zprava}.
\end{mydef}

(je-li jazyk $L(G)$ nekonečný, pak $G$ musí být rekurzivní.)

\begin{mydef}
Pravidlo $A \to \alpha$, s levou stranou tvořenou nonterminálem $A$, budeme nazývat $A$-pravidlo.
\end{mydef}

\begin{veta}
Nechť $G = (N, \Sigma, P, S)$ je gramatika a nechť $A \to A \alpha_1 | A \alpha_2 | \dots | A \alpha_m | \beta_1 | \beta_2 | \dots | \beta_n$ jsou všechna $A$-pravidla. Žádný z řetězců $\beta_i$ nezačíná nonterminálem $A$. Gramatika $G' = (N \cup \{A'\}, \Sigma, P', S)$ kde $P'$ obsahuje namísto uvedených pravidel pravidla
$$A \to \beta_1 | \beta_2 | \dots | \beta_n | \beta_1 A' | \beta_2 A' | \dots | \beta_n A' $$
$$A' \to \alpha_1 | \alpha_2 | \dots | \alpha_n | \alpha_1 A' | \alpha_2 A' | \dots | \alpha_n A' $$
je ekvivalentní s gramatikou $G$, tj. $L(G) = L(G')$.
\end{veta}
(náhrada pravidel rekurzivních zleva, pravidly rekurzivními zprava.)

\begin{veta}
Nechť $G = (N, \Sigma, P, S)$ je gramatika. $A \to \alpha B \beta, B \in N, \alpha, \beta \in (N \cup \Sigma)^*$ je pravidlo z $P$ a $B \to \gamma_1 | \gamma_2 | \dots | \gamma_n$ jsou všechna $B$-pravidla v P. Nechť $G = (N, \Sigma, P', S)$, kde
$$P' = P - \{A \to \alpha B \beta\} \cup \{A \to \alpha \gamma_1 \beta | \alpha \gamma_2 \beta | \dots | \alpha \gamma_n \beta\}$$
Pak $L(G) = L(G')$.
\end{veta}

\begin{alg}
Odstranění levé rekurze\\
Vstup: Vlastní gramatika $G = (N, \Sigma, P, S)$\\
Výstup: Gramatika $G'$ bez levé rekurze\\
Metoda:
\begin{enumerate}
	\item Nechť $N = \{A_1, A_2, \dots, A_n\}$. Gramatiku budeme transformovat tak, že je-li $A_i \to \alpha$ pravidlo, pak $\alpha$ začíná buď terminálem, nebo nonterminálem $A_j, j > i$. K tomuto účelu položíme $i = 1$.
	\item Nechť $A_i \to A_i \alpha | \dots | A_i \alpha_m | \beta_1 | \dots | \beta_p$ jsou všechna $A_I$-pravidla a nechť žádné $\beta_i$ nezačíná nonterminálem $A_k$, je-li $k \leq i$.

	Nahraď všechna $A_i$-pravidla těmito pravidly:
	$$A_i \to \beta_1 | \dots | \beta_p | \beta_1 A'_i | \dots | \beta_p A'_i$$
	$$A'_i \to \alpha_1 | \dots | \alpha_m | \alpha_1 A'_i | \dots | \alpha_m A'_i$$
	kde $A'_i$ je nový nonterminál. Takto všechna $A_i$-pravidla začínají buď terminálem, nebo nonterminálem $A_k, k > i$.
	\item Je-li $i = n$, pak jsme získali výslednou gramatiku $G'$. V opačném případě polož $i = i +1$ a $j = 1$.
	\item Každé pravidlo tvaru $A_i \to A_j \alpha$ nahraď pravidly $A_i \to \beta_1 \alpha | \dots | \beta_p \alpha$ kde $A_j \to \beta_1 | \dots | \beta_p$ jsou všechna $A_j$-pravidla. Po této transformaci budou všechna $A_j$-pravidla začínat buď terminálem, nebo nonterminálem $A_k, k > j$, takže také všechna $A_i$ -pravidla budou mít tuto vlastnost.
	\item Je-li $j = i - 1$, pak přejdi ke kroku (2). Jinak $j = j +1 $ a opakuj krok (4).
\end{enumerate}
\end{alg}

\begin{mydef}
Každý bezkontextový jazyk lze generovat gramatikou bez levé rekurze.
\end{mydef}

\section{Chomského normální forma}

\begin{mydef}
Gramatika $G = (N, \Sigma, P, S)$ je v \emph{Chomského normální formě} (CNF), jestliže každé pravidlo z $P$ má jeden z těchto tvarů:
\begin{enumerate}
	\item $A \to BC, A, B, C \in N$ nebo
	\item $A \to a, a \in \Sigma$ nebo
	\item Je-li $\epsilon \in L(G)$, pak $S \to \epsilon$ je pravidlo z $P$ a výchozí symbol $S$ se neobjeví na pravé straně žádného pravidla.
\end{enumerate}
\end{mydef}

\begin{alg}
Převod do Chomského normální formy\\
Vstup: Vlastní gramatika $G = (N, \Sigma, P, S)$\\
Výstup: Gramatika $G' = (N', \Sigma, P', S')$ v CNF taková, že $L(G) = L(G')$\\
Metoda:
\begin{enumerate}
	\item Množina pravidel $P'$ obsahuje všechna pravidla $A \to a$ z $P$.
	\item Množina pravidel $P'$ obsahuje všechna pravidla $A \to BC$ z $P$.
	\item Je-li pravidlo $S \to \epsilon$ v $P$, pak $S \to \epsilon$ je také v $P'$.
	\item Pro každé pravidlo tvaru $A \to X_1 \dots X_k$, kde $k > 2$ z $P$ přidej k $P'$ tuto množinu pravidel. Symbolem $X'_i$ značíme nonterminál $X_i$, je-li  $X_i \in N$, nebo nový nonterminál, je-li $X_i \in \Sigma$:
	\begin{align*}
		A								&\to X'_1 \left<X_2 \dots X_k \right> \\
		\left<X_2 \dots X_k \right>		&\to X'_2 \left<X_3 \dots X_k \right> \\
										& \hdots \\
		\left<X_{k-1} \dots X_k \right>	&\to X'_{k-1} X'_k \\
	\end{align*}
	kde každý symbol $\left<X_i \dots X_k \right>$ značí nový nonterminální symbol.
	\item Pro každé pravidlo tvaru $A \to X_1 X_2$, kde nějaký ze symbolů $X_1$ nebo $X_2$ leží v $\Sigma$ přidej k $P'$ pravidlo $A \to X'_1 X'_2$, kde $X'_i$ značíme nonterminál $X_i$, je-li $X_i \in N$, nebo nový nonterminál, je-li $X_i \in \Sigma$.
	\item Pro každý nový nonterminál tvaru $a'$ přidej k $P'$ pravidlo $a' \to a$. Výsledná gramatika je $G' = (N', \Sigma, P', S')$; Množina $N'$ obsahuje všechny nonterminály tvaru $\left<X_i \dots X_k \right>$ a $a'$.
\end{enumerate}
\end{alg}

\begin{veta}
Nechť $L$ je bezkontextový jazyk. Pak existuje bezkontextová gramatika $G$ v CNF taková, že $L = L(G)$
\end{veta}

Počet derivací v CNF pro libovolný řetězec je vždy lichý.

\section{Geribachové normální forma}

\begin{mydef}
Gramatika $G = (N, \Sigma, P, S)$ je v Greibachové normální formě (GNF), je-li $G$ gramatikou bez $\epsilon$-pravidel a jestliže každé pravidlo (s výjimkou případného pravidla $S \to \epsilon$) má tvar $a \to a \alpha$, kde $a \in \Sigma, \alpha \in N^*$.
\end{mydef}

\begin{lemma}
Nechť $G = (N, \Sigma, P, S)$ je gramatika bez levé rekurze. Pak existuje lineární uspořádání $<$ definované na množině nonterminálních symbolů $N$ takové, že $A \to B\alpha$ v P, paj $A < B$.
\end{lemma}

\begin{alg}
Převod do Greibachové normální formy\\
Vstup: Vlastní gramatika bez levé rekurze $G = (N, \Sigma, P, S)$\\
Výstup: Ekvivalentní gramatika $G'$ v GNF\\
Metoda:
\begin{enumerate}
	\item Podle předchozí lemmy vytvoř lineární uspořádání $<$ na $N$ takové, že každé $A$-pravidlo začíná buď terminálem, nebo nějakým nonterminálem $B$ takovým, že $A < B$. Nechť
	$$N = \{A_1, A_2, \dots, A_n\} \text{ a } A_1 < A_2 < \dots < A_n$$
	\item Polož $i = n -1$
	\item Je-li $i = 0$ přejdi k bodu (5), je-li $i \not=0$ nahraď každé pravidlo tvaru $A_i \to A_j \alpha$, kde $j > i$ pravidly $A_i \to \beta_1 \alpha | \dots \beta_m \alpha$, kde $A_j \to \beta_1 | \dots | \beta_m$ jsou všechna $A_j$-pravidla. (každý z řetězců $\beta_1, \dots, \beta_m$ začíná terminálem.)
	\item Polož $i = i - 1$ a opakuj krok (3)
	\item V tomto okamžiku všechna pravidla (s výjimkou pravidla $S \to \epsilon$) začínají terminálním symbolem. V každém pravidle $A \to aX_1 \dots X_k$ nahraď ty symboly $X_j$, které jsou terminálními symboly, novými nonterminálem $X'_j$.
	\item Pro všechna $X'_k$ z bodu (5) přidej pravidla $X'_j \to X_j$
\end{enumerate}
\end{alg}

\begin{veta}
Nechť $L$ je bezkontextový jazyk. Pak existuje gramatika $G$ v GNF taková, že $L(G) = L$.
\end{veta}

Nevýhodou je velké množství nových pravidel nebo nonterminálů.




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Zásobníkové automaty} \label{cha:21}
1. semestr, TIN, \texttt{opora.pdf}, 4. kapitola, sekce 9. - 12.

(jazyky přijímané ZA, varianty ZA)

\section{Základní definice zásobníkových automatů}
\begin{mydef}
\emph{Zásobníkový automat} $P$ je sedmice
$$P = (Q, \Sigma, \Gamma, \delta, q_0, Z_0, F)$$
kde
\begin{enumerate}
	\item $Q$ je konečná množina stavových symbolů reprezentujících vnitřní stavy řídicí jednotky.
	\item $\Sigma$ je konečná vstupní abeceda; jejími prvky jsou vstupní symboly.
	\item $\Gamma$ je konečná abeceda zásobníkových symbolů
	\item $\delta$ je zobrazení množiny $Q \times (\Sigma \cup \{\epsilon\}) \times \Gamma$ do konečné množiny podmnožin množiny $Q \times \Gamma^*$ popisující funkci přechodů
	\item $q_0 \in Q$ je počáteční stav řídicí jednotky
	\item $Z_0 \in \Gamma$ je symbol, který je na počátku uložen do zásobníku -- tzn. \emph{startovací symbol} zásobníku.
	\item $F \in Q$ je množina koncových stavů.
\end{enumerate}
\end{mydef}

\begin{mydef}
\emph{Konfigurací} zásobníkového automatu $P$ nazveme trojici
$$(q, w, \alpha) \in Q \times \Sigma^* \times \Gamma^*$$
kde
\begin{enumerate}
	\item $q$ je přítomný stav řídicí jednotky
	\item $w$ je doposud nepřečtená část vstupního řetězce; první symbol řetězce $w$ je pod čtecí hlavou. Je-li $w = \epsilon$, pak byly všechny symboly ze vstupní pásky přečteny.
	\item $\alpha$ je obsah zásobníku. Pokud nebude uvedeno jinak, budeme zásobník reprezentovat řetězcem, jehož nejlevější symbol koresponduje s vrcholem zásobníku. Je-li $\alpha = \epsilon$, pak je zásobník prázdny.
\end{enumerate}
\end{mydef}

\begin{mydef}
\emph{Přechod} zásobníkového automatu $P$ budeme reprezentovat binární relací $\vdash_P$ (nebo $\vdash$, bude-li zřejmé, že jde o automat $P$), která je definována na množině konfigurací zásobníkového automatu $P$. Relace
$$(q, w, \beta) \vdash (q', w', \beta')$$
platí pro $q, q' \in Q, w, w' \in \Sigma^*, \beta, \beta' \in \Gamma^*$, jestliže $w = aw'$ pro nějaké $a \in (\Sigma \cup \{\epsilon\}), \beta = Z \alpha$ a $\beta' = \gamma \alpha$ pro nějaké $Z \in \Gamma, a, \gamma \in \Gamma^*$ a $\delta(q, a, Z)$ obsahuje prvek $(q', \gamma)$.
\end{mydef}

Relace $\vdash^i, \vdash^+, \vdash^*$ jsou definovány obvyklém způsobem.

\emph{Počáteční konfigurace} zásobníkového automatu má tvar $(q_0, w, Z_0)$ pro $w \in \Sigma^*$, tj. automat je v počátečním stavu $q_0$, na vstupní pásce je řetězec $w$ a v zásobníku je startovací symbol $Z_0$. \emph{Koncová konfigurace} má tvar $(q, \epsilon, \alpha)$, kde $q \in F$ je koncový stav a $\alpha \in \Gamma^*$.

\begin{mydef}
Platí-li pro řetězec $w \in \Sigma^*$ relace $(q_0, w, Z_0) \vdash^* (q, \epsilon, \alpha)$ pro nějaké $q \in F$ a $\alpha \in \Gamma^*$, pak říkáme, že řetězec $w$ je přijímán zásobníkovým automatem $P$. Množinu $L(P)$ všech řetězců přijímaných zásobníkovým automatem $P$, který nazýváme
\emph{jazykem přijímaným zásobníkovým automatem}.
\end{mydef}

\section{Varianty zásobníkových automatů}

\begin{mydef}
\emph{Rozšířeným zásobníkovým automatem} rozumíme sedmici
$$P = (Q, \Sigma, \Gamma, \delta, q_0, Z_0, F)$$
kde $\delta$ je zobrazení z konečné podmnožiny $Q \times (\Sigma \cup \{\epsilon\}) \times \Gamma^*$ do množiny podmnožin množiny $Q \times \Gamma^*$. Ostatní symboly mají stejný význam jako v základní definici.

Podobně, relace přechodu $\vdash$ je definovaná jako \emph{nejmenší} relace taková, že $(q, aw, \alpha \gamma) \vdash (q', w, \beta \gamma)$ platí jestliže $\delta(q, a, \alpha)$ obsahuje $(q', \beta)$ pro $q, q' \in Q, a \in \Sigma \cup \{\epsilon\}$ a $\alpha, \beta, \gamma \in \Gamma^*$. Tato relace odpovídá přechodu, v němž je vrcholový řetězec odstraněn a nahrazen řetězcem $\beta$ (v základní definici je pouze znak abecedy -- $\alpha \in \Gamma^*$).
\end{mydef}

Jazyk definovaný automatem $P$ je
$$L(P) = \{w | (q_0, w, Z_0) \vdash^* (q, \epsilon, \alpha), q \in F, \alpha \in \Gamma^*\}$$

Rozšířený zásobníkový automat může, na rozdíl od základní definice provádět přechody, i když je zásobník prázdný.

\begin{veta}
Nechť $P = (Q, \Sigma, \Gamma, \delta, q_0, Z_0, F)$ je rozšířený zásobníkový automat. Pak existuje zásobníkový automat $P_1$ takový, že $L(P_1) = L(P)$.
\end{veta}

\begin{mydef}
Nechť $P = (Q, \Sigma, \Gamma, \delta, q_0, Z_0, F)$ je zásobníkový nebo rozšířený zásobníkový automat. Řetězec $w$ je přijímán s \emph{vyprázdněním zásobníku}, jestliže platí $(q_0, w, Z_0) \vdash^* (q, \epsilon, \epsilon), q \in Q$. Označme $L_\epsilon(P)$ množinu všech řetězců, které jsou přijímány zásobníkovým automatem $P$ s vyprázdněním zásobníku.
\end{mydef}

\begin{veta}
Nechť $L$ je jazyk přijímaný zásobníkovým automatem $P = (Q, \Sigma, \Gamma, \delta, q_0, Z_0, F), L = L(P)$. Lze zkonstruovat zásobníkový automat $P'$ takový, že $L_\epsilon(P) = L$.
\end{veta}
Stav vyprazdňující zásobník a znak dna zásobníku, který je odebrán pouze v tomto stavu.

\begin{veta}
Nechť $P = (Q, \Sigma, \Gamma, \delta, q_0, Z_0, \emptyset)$ je zásobníkový automat přijímající vyprázdněním zásobníku. Lze zkonstruovat zásobníkový automat $P'$ takový, že $L(P') = L_\epsilon(P)$.
\end{veta}
Speciální symbol na dně zásobníku. Po jeho odstranění přechází automat do nového koncového stavu.

\section{Ekvivalence bezkontextových jazyků a jazyků přijímaných zásobníkovými automaty}

\begin{veta}
Nechť $G = (N, \Sigma, P, S)$ je bezkontextová gramatika. Z gramatiky $G$ můžeme zkonstruovat zásobníkový automat $R$ takový, že $L_\epsilon(R) = L(G)$.
\end{veta}

Zásobníkový automat $R = (\{q\}, \Sigma, N \cup \Sigma, \delta, S, \emptyset\}$. Pravidla $A \to \alpha$ převedeme na $(q, \alpha \in \delta(q, \epsilon, A)$. Pravidla $\delta(q, a, a) = \{(q, \epsilon)\}$ pro všechna $a \in \Sigma$.

\begin{veta}
Nechť $G = (N, \Sigma, P, S)$ je bezkontextová gramatika. Rozšířený zásobníkový automat $R = (\{q,r\}, \Sigma, N \cup \Sigma \cup \{\$\}, \delta, q, \$, \{r\})$, kde zobrazení $\delta$ je definováno takto:
\begin{enumerate}
	\item $\delta(q, a, \epsilon) = \{(q, a)\}$ pro všechna $a \in \Sigma$.
	\item Je-li $A \to \alpha$ pravidlo v $P$, pak $\delta(q, \emptyset, \alpha)$ obsahuje $(q, A)$.
	\item $\delta(q, \epsilon, S\$) = \{(r, \epsilon)\}$.
\end{enumerate}
přijímá jazyk $L(G)$, tj. $L(R) = L(G)$.
\end{veta}

Syntaktická analýza zdola nahoru (na zásobník ukládáme symboly na vstupu a když tvoří $l$-frázi, redukujeme je na "levé strany" pravidel až ke kořenu. Když je na zásobníku výchozí symbol, přejdeme do koncového stavu.

\begin{veta}
Nechť $R = (Q, \Sigma, \Gamma, \delta, q_0, Z_0, F)$ je zásobníkový automat. Pak existuje bezkontextová gramatika $G$, pro kterou platí $L(G) = L(R)$.
\end{veta}
Levá derivace terminálního řetězce $w$ bude přímo korespondovat s posloupností přechodů $R$. Nonterminální symboly tvaru $[qZr], q,r \in Q, Z \in \Gamma$.

\section{Deterministický zásobníkový automat}

\begin{mydef}
Zásobníkový automat $P = (Q, \Sigma, \Gamma, \delta, q_0, Z_0, F)$ nazýváme deterministickým zásobníkovým automatem, jestliže pro každé $q \in Q$ a $Z \in \Gamma$ platí buď pro každé $a \in \Sigma$ obsahuje $\delta(q, a, Z)$ nanejvýš jeden prvek a $\gamma(q, \epsilon, Z) = \emptyset$, nebo $\delta(q, a, Z) = \emptyset$ pro všechna $a \in \Sigma$ a $\delta(q, \epsilon, Z)$ obsahuje nanejvýš jeden prvek.
\end{mydef}

\begin{mydef}
Jazyk $L$ se nazývá \emph{deterministický bezkontextový jazyk}, jestliže existuje deterministický zásobníkový automat $P$ takový, že $L(P) = L$.
\end{mydef}

\begin{mydef}
Zásobníkový automat $P = (Q, \Sigma, \Gamma, \delta, q_0, z_0, F)$ nazýváme \emph{deterministický} RZA (DRZA), jestliže platí:
\begin{enumerate}
	\item $\forall q \in Q \forall x \in \Sigma \cup \{\epsilon\} \forall \gamma \in \Gamma: |\delta(q, a, \gamma) \leq 1$
	\item Je-li $\delta(q, a, \alpha) \not= \emptyset, \delta(q, a, \beta) \not= \emptyset$ a $\alpha \not='\beta$, pak ani $\alpha$ není předponou $\beta$, ani $\beta$ není předponu $\alpha$.
	\item Je-li $\delta(q, a, \alpha) \not= \emptyset, \delta(q, \epsilon, \beta) \not= \emptyset$, pak ani $\alpha$ není předponou $\beta$, ani $\beta$ není předponu $\alpha$.
\end{enumerate}
\end{mydef}

\begin{veta}
Deterministické rozšířené zásobníkové automaty mají ekvivalentní vyjadřovací sílu jako deterministické zásobníkové automaty.
\end{veta}

\begin{veta}
Deterministické zásobníkové automaty mají striktně menší vyjadřovací sílu než nedeterministické zásobníkové automaty.
\end{veta}







%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Turingovy stroje} \label{cha:22}
1. semestr, TIN, \texttt{opora.pdf}, 5. kapitola

(jazyky přijímané TS, varianty TS, lineárně omezené automaty, univerzální TS)

\section{Základní koncepce Turingových strojů}
\subsection{Churchova teze}
\emph{Churchova (Church-Turingova) teze: Turingovy stroj (a jim ekvivalentní systémy) definují svou výpočetní silou to, co intuitivně považujeme za efektivně vyčíslitelné.}

Není teorém. Ale Turingovy stroje jsou velmi robustní -- úpravy nemění jejich výpočetní sílu (determinismus, počet pásek), odlišné výpočetní modely s odpovídající silou ($\lambda$-kalkul, Minského stroje) a neexistuje žádný výpočetní proces, který bychom označili za efektivně vyčíslitelný a který by nebylo možné realizovat na Turingově stroji.

\subsection{Turingův stroj}

\begin{mydef}
Turingův stroj (TS) je šestice tvaru $M = (Q, \Sigma, \Gamma, \delta, q_0, q_F)$, kde:
\begin{enumerate}
	\item $Q$ je konečná množina vnitřních (řídicích) stavů
	\item $\Sigma$ je konečná množina symbolů nazývaná vstupní abeceda $\Delta \not= \Sigma$.
	\item $\Gamma$ je konečná množina symbolů $\Sigma \subset \Gamma, \Delta \in \Gamma$, nazývané pásková abeceda
	\item parciální funkce $\delta: (Q \ \{q_F\}) \times \Gamma \to Q \times (\Gamma \cup \{L,R\})$, kde $L, R \not\in \Gamma$, je přechodová funkce.
	\item $q_0$ je počáteční stav $q_0 \in Q$
	\item $q_F$ je koncový stav $q_F \in Q$
\end{enumerate}
\end{mydef}

\subsection{Konfigurace Turingova stroje}
Symbol $\Delta$ značí tzv. \emph{blank} (prázdný symbol), který se vyskytuje na místech pásky, která ještě nebyla použita (může ale být na pásku zapsán i později).

\emph{Konfigurace pásky} je dvojice sestávající z nekonečného řetězce reprezentujícího obsah pásky a pozici hlavy v tomto řetězci -- přesně jde o prvek množiny $\{\gamma \Delta^\omega | \gamma \in \Gamma^*\} \times \mathbb{N}\}$. Konfiguraci pásky zapisujeme jako $\Delta x y z \underline{x} \Delta x \Delta \Delta \dots$ (podtržení značí pozici hlavy).

\emph{Konfigurace stroje} je pak dána stavem řízení a konfigurací pásky -- formálně se jedná o prvek množiny $Q \times \{\gamma \Delta^* | \gamma \in \Gamma^*\} \times \mathbb{N}$.

\subsection{Přechodová relace TS}
Pro libovolný řetězec $\gamma \in \Gamma^\omega$ a číslo $n \in \mathbb{N}$ označíme $\gamma_n$ n-tý symbol daného řetězce a označíme $s_b^n(\gamma)$ řetězec, který vznikne z $\gamma$ záměnou $\gamma_n$ za $b$.

\emph{Krok výpočtu} TS M definujeme jako nejmenší binární relaci $\underset{M}{\vdash}$ takovou, že $\forall q_1, q_2 \in Q \forall \gamma \in \Gamma^\omega \forall n \in \mathbb{N} \forall b \in \Gamma$:
\begin{itemize}
	\item $(q_1, \gamma, n) \underset{M}{\vdash} (q_2, \gamma, n+1)$ pro $\gamma(q_1, \gamma_n) = (q_2, R)$ --operace \emph{posuvu doprava}
	\item $(q_1, \gamma, n) \underset{M}{\vdash} (q_2, \gamma, n-1)$ pro $\gamma(q_1, \gamma_n) = (q_2, L)$ --operace \emph{posuvu doleva}
	\item $(q_1, \gamma, n) \underset{M}{\vdash} (q_2, s_b^n(\gamma), n)$ pro $\gamma(q_1, \gamma_n) = (q_2, b)$ --operace \emph{zápisu} $b$ při $\gamma_n$ pod hlavou
\end{itemize}

\subsection{Výpočet TS}
\emph{Výpočet TS} $M$ začínající z konfigurace $K_0$ je posloupnost konfigurací $K_0, K_1, K_2, \dots$, ve které $K_i \underset{M}{\vdash} K_{i+1}$ pro všechna $i \geq 0$ taková, že $K_{i+1}$ je v dané posloupnost, a která je buď
\begin{itemize}
	\item \emph{nekonečná}
	\item \emph{konečná} s koncovou konfigurací $(q, \gamma, n)$, přičemž rozlišujeme následující \emph{typy zastavení} TS:
	\begin{enumerate}
		\item \emph{normální} -- přechodem do koncového stavu, tj. $q = q_F$ a 
		\item \emph{abnormální}:
		\begin{enumerate}
			\item pro $(q, \gamma_n)$ není $\delta$ definována, nebo
			\item hlava je na nejlevější pozici pásky a dojde k posunu doleva, tj $\delta(q, \gamma_n) = (q', L)$ pro nějaké $q' \in Q$.
		\end{enumerate}
	\end{enumerate}
\end{itemize}

\subsection{Alternativní reprezentace TS}
Alternativně může být TS definován s množinou koncových stavů místo jednoho. Také může být definována dvojice $q_{accept}$ a $q_{reject}$ namísto $q_F$, na prvním poličku pásky může být znak "konec pásky, z něhož není možný posun doleva, definice $\delta$ jako totální funkce, nebo přepis a posun hlavy je spojen do jedné operace.

\subsection{Grafická reprezentace TS}

Grafická reprezentace přechodu ($x$ -- co se čte, $s$ -- zápis/L/R):
\begin{tikzpicture}[shorten >=1pt,node distance=1.5cm,on grid,auto]
	\node[state] (p)   {$p$};
	\node[state] (q) [right=of s]  {$q$};
	\path[->] (p) edge  node {$x/s$} (q);
\end{tikzpicture}

Grafická reprezentace počátečního a koncového stavu:
\begin{tikzpicture}[shorten >=1pt,node distance=1.5cm,on grid,auto]
	\node[state,initial] (p)   {$p$};
	\node[state,accepting] (qf) [right=of s]  {$q_F$};
\end{tikzpicture}

\subsection{Modulární konstrukce TS}
Konstrukce z jednodušších celků (\uv{podprogramů}). Př. Posun hlavy doprava, nalezení výskytu symbolu $x$ vpravo od aktuální pozice hlavy.

\subsection{Kompozitní diagram TS}
Předpokládáme, že všechny komponenty mají stejnou vstupní abecedu $\Sigma$ i páskovou abecedu $\Gamma$.

\emph{Bezpodmínečné předání řízení} graficky značíme šipkou mezi příslušnými komponentami $A \to B$. Znamená předání řízení z koncového stavu $q_F^A$ stroje $A$ do počátečního stavu $q_0^B$ stroje $B$.
Formálně to znamená, že ve výsledném TS, který zahrnuje všechny stavy a přechody obou komponent, stav $a_F^A$ ztrácí status koncového stavu, $q_0^B$ ztrácí status počátečního symbolu a jsou doplněný přechody tak, že $\forall x \in \Gamma: \delta(g_F^A, x) = q_0^B, x)$. S ohledem na determinismus platí, žez jedné komponenty může být řízení bezpodmínečně předáno nanejvýš jedné komponentě.

\emph{Sekvenci strojů} $A \to B \to C$ často zkracujeme na $ABC$. Příchozí šipky mohou směřovat ke kterémukoliv ze strojů, odchozí musí být spojena s poslední komponentou v sekvenci.

\emph{Podmíněné předání řízení} umožňuje na úrovni kompozitního diagramu dosáhnout větvení výpočtu. Graficky je podmíněné předání řízení značeno  šipkou se seznamem čárkou oddělených symbolů z páskové abecedy. Nelze kombinovat podmíněné a nepodmíněné předání řízení u deterministických TS.

Při podmíněném předání řízení je možné použít také větve pokrývající všechny \emph{ostatní symboly}, jež nejsou pokryty běžným podmíněným předáním řízení. K tomuto účelu použijeme šipku, která obsahuje seznam všech symbolů, přes které se podmíněné předání řízení z dané komponenty, uvozený symbolem negace $\neg$.

Pro zjednodušení konstrukce strojů, ve kterých se stejným způsobem zpracovává několik různých symbolů se používá tzv. \emph{parametrová konvence}, Jedná se o podmíněné předání řízení zapsané jako $\xrightarrow{x_1, \dots x_n} \} \xrightarrow{\omega}$, kde $x_1, \dots, x_n \in \Gamma, n \geq 2, \omega \not\in \Gamma \cup \{L, R\}$. Při předání řízené tímto způsobem nabývá $\omega$ hodnoty toho symbolu z množiny $x_1, \dots, x_n$, který je aktuálně pod čtecí hlavou. Parametrová konvence je vlastně jakousi analogií k použití maker.

\subsection{Základní stavební bloky TS}
Uvažujme $\Gamma = \{x, y, \Delta\}$, mezi \emph{základní stavební bloky TS} obvykle patří následující stroje:
\begin{enumerate}
	\item Stroje $L, R, x$:

\begin{tikzpicture}[shorten >=1pt,node distance=3cm,on grid,auto]
	\node[state,initial,initial text={L:}] (p)   {};
	\node[state] (q) [right=of s]  {};
	\path[->]
		(p) edge [bend left,above]	  node{$x/L$} (q)
		(p) edge 					  node{$y/L$} (q)
		(p) edge [bend right,below]	  node{$\Delta/L$} (q)
	;
\end{tikzpicture}
\begin{tikzpicture}[shorten >=1pt,node distance=3cm,on grid,auto]
	\node[state,initial,initial text={R:}] (p)   {};
	\node[state] (q) [right=of s]  {};
	\path[->]
		(p) edge [bend left,above]	  node{$x/R$} (q)
		(p) edge 					  node{$y/R$} (q)
		(p) edge [bend right,below]	  node{$\Delta/R$} (q)
	;
\end{tikzpicture}
\begin{tikzpicture}[shorten >=1pt,node distance=3cm,on grid,auto]
	\node[state,initial,initial text={x:}] (p)   {};
	\node[state] (q) [right=of s]  {};
	\path[->]
		(p) edge [bend left,above]	  node{$x/x$} (q)
		(p) edge 					  node{$y/x$} (q)
		(p) edge [bend right,below]	  node{$\Delta/x$} (q)
	;
\end{tikzpicture}
	\item Stroje $L_x, R_x, L_{\neg x}, R_{\neg x}$ pro posun doprava/doleva dokud nenarazíme na znak $x$/$y$ (dokud nenarazíme na jiný znak než $x$/$y$).
	\item Stroje $S_R$ a $S_L$ pro posuv obsahu pásky: Stroj $S_R$ posune řetězec neblankových symbolů nacházejících se vlevo od aktuální pozice hlavy o jeden symbol doprava.
\end{enumerate}

Příklady: Kopírovací stroj, Generování řetězců, dekrement kladného čísla zapsaného ve dvojkové soustavě.


\section{Turingovy stroje jako akceptory jazyků}

\begin{mydef}
\begin{enumerate}
	\item Řetězec $w \in \Sigma^*$ je přijat TS $M = (Q, \Sigma, \Gamma, \delta, q_O, q_F)$, jestliže $M$ při aktivaci z \emph{počáteční konfigurace pásky} $\underline{\Delta} w \Delta \dots$ a počátečního stavu $q_0$ zastaví přechodem do koncového stavu $q_F$, tj. $(q_0, \Delta w \Delta^\omega, 0) \overset{*}{\underset{M}{\vdash}} (q_F, \gamma, n)$ pro nějaké $\gamma \in \Gamma^*$ a $n \in \mathbb{N}$.
	\item Množinu $L(M) = \{ w | w \text{ je přijat TS } M\} \subseteq \Sigma^*$ nazýváme jazyk přijímaný TS M.
\end{enumerate}
\end{mydef}

\section{Modifikace TS}
\subsection{Přijímání zvláštní konfigurací pásky}
Můžeme \emph{přijetí řetězce TS} definovat tak, že TS začíná s konfigurací pásky $\underline{\Delta} w \Delta \dots$ a zastaví s konfigurací pásky $\underline{\Delta} Y \Delta \dots, Y \in \Gamma \backslash \Sigma$ ($Y$ značí Yes).

\begin{veta}
Máme-li TS $M$, který přijímá $L(M)$ přechodem do $q_F$, můžeme vždy sestrojit stroj $M''$, který bude přijímat $L(M)$ zastavením s konfigurací pásky $\underline{\Delta} Y \Delta \dots$.
\end{veta}
(a naopak) Lze na ně pohlížet jako na výpočetní mechanismy implementující funkci $\Sigma^* \to \Gamma^*$ na pásce.

\subsection{Vícepáskové Turingovy stroje}
Vícepáskový TS disponuje $k$ jednosměrně nekonečnými páskami, z nichž každá je vybavena vlastní čtecí/zapisovací hlavou a je připojena ke společní konečně stavové jednotce. V jednom kroku stroj nejdříve na každé pásce zvlášť přečte symbol, posune hlavu nebo přepíše symbol a poté se v závislosti na čtených symbolech změní stav řídicí jednotky.

Formálně $k$ pásek s páskovými abecedami $\Gamma^*_1, \Gamma^*_2, \dots, \Gamma^*_k$ a $k$ odpovídajících hlav s přechodovou funkcí tvaru:
$$\delta(Q \backslash \{q_F\}) \times \Gamma_1 \times \Gamma_2 \times \dots \times \Gamma_k \to Q \times \bigcup\limits_{u \in \{1, \dots, k\}} \{i\} \times (\Gamma_i \cup \{L, R\})$$
kde $i$ značí pásku, na kterou se zapisuje (na které se posouvá hlava).

(Jazyk $x^ny^nz^n$: Čteme všechna $x$ na první pásce a zapisujeme $X$ na druhou. Poté čteme $y$ a přepisujeme $X$ na druhé pásce pomocí $Y$ (odzadu). Poslední sekvenci $z$ opět kontrolujeme, jestli sedá počet $Y$ na druhé pásce s počtem $z$ na první.

\begin{veta}
Pro každý $k$-páskový TS $M$ existuje jednopáskový TS $M'$ takový, že $L(M) = L(M')$.
\end{veta}
Důkaz: Přidáme další pásky označující pozice hlavy na jednotlivých páskách a 

Zvětšení paměťových možností TS nerozšiřuje jejich schopnosti přijímat jazyky.

\subsection{Nedeterministické Turingovy stroje}

\begin{mydef}
Nedeterministický TS je šestice $M = (Q, \Sigma, \Gamma, \delta, q_0, q_F)$, kde význam jednotlivých složek je shodná s deterministickým TS až na $\delta$, jež má tvar:
$$\delta: (Q \backslash \{q_F\}) \times \Gamma \to 2^{Q \times (\Gamma \cup \{L,R\})}$$
\end{mydef}

\begin{mydef}
Jazyk $L(M)$ NTS $M = (Q, \Sigma, \Gamma, \delta, q_0, q_F)$ je množina řetězců $w \in \Sigma^*$ takových, že $M$ při aktivaci z $q_0$ při počátečním obsahu pásky $\underline{\Delta} w \Delta \dots$ může zastavit přechodem do $q_F$.
\end{mydef}

Příklad: Jazyk $L = \{ww^r\}$ s uhádnutím středu.

\begin{veta}
Pro každý NTS $M$ existuje DTS $M'$ takový, že $L(M) = L(M')$.
\end{veta}

Zavedením nedeterminismu do TS se nezvyšují jejich schopnost přijímat jazyky.

\section{Jazyky rekurzivně vyčíslitelné a jazyky rekurzivní}
\subsection{Rekurzivní vyčíslitelnost a rekurzivnost}
\begin{mydef}
Jazyk $L \subseteq \Sigma^*$ se nazývá
\begin{itemize}
	\item \emph{rekurzívně vyčíslitelný}, jestliže $L = L(M)$ pro nějaký TS $M$
	\item \emph{rekurzivní}, jestliže $L = L(M)$ pro nějaký úplný TS $M$
\end{itemize}
Je-li $M$ úplný Turingův stroj, pak říkáme, že M \emph{rozhoduje jazyk} L(M).
\end{mydef}

Ke každému rekurzívnímu jazyku existuje TS, který ho rozhoduje, tj. zastaví pro každé vstupní slovo -- tento TS lze samozřejmě upravit tak, aby pro každý řetězec z daného jazyka zastavil s páskou $\underline{\Delta} Y \Delta \dots$, a jinak zastavil s páskou $\underline{\Delta} N \Delta \dots$.

TS přijímající rekurzivně vyčíslitelný jazyk $L$ zastaví pro každé $w \in L$, ovšem pro $w \not\in L$ může zastavit, ale také může donekonečna cyklit.

\subsection{Rozhodovací problémy}

\emph{Rozhodovací problém} (decision problem) $P$ může být chápán jako funkce $f_P$ s oborem hodnot $\{true, false\}$. Rozhodovací problém je obvykle specifikován:
\begin{itemize}
	\item definičním oborem $A_P$ reprezentujícím množinu možných instancí problému (možných vstupů) a
	\item podmnožinou $B_P \subseteq A_P, B_P = \{p | f_P(p) = true\}$ instancí, pro které je hodnot $f_P$ rovna \emph{true}.
\end{itemize}
V teorii formálních jazyků používáme ke kódování jednotlivých instancí problémů řetězce nad vhodnou abecedou $\Sigma$. Pak je rozhodovací problém $P$ přirozeně specifikován jazykem $L_p = \{ w \in \Sigma^* | w = \text{code}(p), p \in B_P\}$, kde $\text{code}:  A_P \to \Sigma^*$ je injektivní funkce, které přiřazuje instancím problém příslušný řetězec (nezávisle na $f_P$).

\subsection{Rozhodování problémů TS}
\begin{mydef}
Nechť $P$ je problém specifikovaný jazykem $L_P$ nad $\Sigma$. Problém $P$ nazveme:
\begin{itemize}
	\item rozhodnutelný, pokud $L_P$ je rekurzivní jazyk, tj. existuje TS, který $L_P$ rozhoduje (přijme každý řetězec $w \in L_P$ a zamítne každý řetězec $w \in \Sigma \backslash L_P$)
	\item nerozhodnutelný, když není rozhodnutelný a 
	\item částečně rozhodnutelný, jestliže $L_P$ je rekurzivně vyčíslitelný jazyk, tj. existuje TS, který přijme každý řetězec $w \in L_P$ a každý řetězec $w \in \Sigma \backslash L_P$ zamítne, nebo je jeho výpočet na něm nekonečný.
\end{itemize}
\end{mydef}

\section{TS a jazyky typu 0}
\subsection{Jazyky přijímané TS jsou typu 0}
\emph{Konfigurace TS} je dána (1) stavem řízení, (2) obsahem pásky a (3) pozicí hlavy. Můžeme zkombinovat do jediného řetězce $[\Delta x q y z \Delta \dots ]$, kde $q$ je stav a $y$ je pozice hlavy.

\begin{veta}
Každý jazyk přijímaný TS (tj. každý rekurzívně vyčíslitelný jazyk) je jazykem typu 0.
\end{veta}

\subsection{Jazyky typu 0 jsou přijímány TS}
\begin{veta}
Každý jazyk typu 0 je přijímán nějaký TS (tj. je rekurzivně vyčíslitelný).
\end{veta}
Důkaz: Provádíme simulaci derivací na druhé pásce TS

\subsection{Jazyky typu 0 = jazyky přijímané TS}
\begin{veta}
Třída jazyků přijímaných TS (neboli jazyků rekurzivně vyčíslitelných) je shodná s třídou jazyků typu 0.
\end{veta}

\section{Lineárně omezené automaty}
gramatiky typu 1 -- kontextové gramatiky

\subsection{Lineárně omezené automaty}
\emph{Lineárně omezený automat} (LOA) je \emph{nedeterministický} TS, který nikdy neopustí tu část pásky, na níž je zapsán jeho výstup.

Není známo, zde deterministický LOA je či není striktně slabší než LOA.

\subsection{LOA a kontextové jazyky}
\begin{veta}
Třída jazyků, kterou lze generovat kontextovými gramatikami, odpovídá třídě jazyků, které lze přijímat LOA.
\end{veta}
Pravidla kontextové gramatiky $\alpha \to \beta$, kde $|\alpha| \leq |\beta|$, nebo $S \to \epsilon$.

\subsection{Kontextové a rekurzivní jazyky}
\begin{veta}
Každý kontextová jazyk je rekurzivní.
\end{veta}

\begin{veta}
\emph{Ne} každý rekurzivní jazyk je kontextový.
\end{veta}

U kontextových jazyků
\begin{itemize}
	\item lze rozhodnout členství věty do jazyka (rekurzívnost)
	\item nelze rozhodovat inkluzi jazyků (neplatí ani pro bezkontextové jazyky)
\end{itemize}
\emph{Nelze rozhodovat prázdnost jazyka} (redukce z Postova problému přiřazení).
\begin{veta}
\end{veta}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Nerozhodnutelnost} \label{cha:23}
1. semestr, TIN, \texttt{opora.pdf}, 6. kapitola

(problém zastavení TS, princip diagonalizace a redukce, Postův korespondenční problém)

\section{Jazyky mimo třídu 0}
(algoritmicky neřešitelné problémy)

\subsection{Existence jazyků mimo třídu 0}
\begin{veta}
Pro každou abecedu $\Sigma$ existuje jazyk nad $\Sigma$, který není typu 0.
\end{veta}

\begin{lemma}
Pro neprázdnou a konečnou množinu $\Sigma$ je množina $2^{\Sigma^*}$ nespočetná.
\end{lemma}
Důkaz: Diagonalizace:
\begin{itemize}
	\item Předpokládejme, že $2^{\Sigma^*}$ je spočetná. Pak dle definice spočetnosti existuje bijekce $f: \mathbb{N} \leftrightarrow 2^{\Sigma^*}$
	\item Uspořádejme $\Sigma^*$ do nějaké posloupnosti $w_1, w_2, w_3, \dots$, např. $\epsilon, x, y, xx, xy, yx, yy, xxx, \dots$ pro $\Sigma = \{x, y\}$. Nyní můžeme $f$ zobrazit \emph{nekonečnou maticí}:
	$$\begin{matrix}
				& w_0		& w_1		& w_2		& \dots	& w_i		& \dots \\
	L_0 = f(O)	& a_{00}	& a_{01}	& a_{02}	& \dots	& a_{0i}	& \dots \\
	L_1 = f(1)	& a_{10}	& a_{11}	& a_{12}	& \dots	& a_{1i}	& \dots \\
	L_2 = f(2)	& a_{10}	& a_{21}	& a_{22}	& \dots	& a_{2i}	& \dots \\
	\dots
	\end{matrix} \text{, kde } a_ij = 
	\begin{cases}
		0 \text{ jestliže } w_j \not\in L_i \\
		1 \text{ jestliže } w_j \in L_i
	\end{cases}$$
	\item Uvažujme jazyk $\overline{L} = \{w_i | a_{ii} = 0\}$. $\overline{L}$ se liší od každého jazyka $L_i = f(i), i = \mathbb{N}$:
	\begin{itemize}
		\item je-li $a_{ii} = 0$, pak $w_i$ patří do jazyka
		\item je-li $a_{ii} = 1$, pak $w_i$ nepatří do jazyka
	\end{itemize}
	\item Současně ale $\overline{L} \in 2^{\Sigma^*}, f$ tudíž není surjektivní, což je spor.
\end{itemize}

\section{Problém zastavení}
\subsection{Kódování TS}
\emph{Kódovací systém} pro TS zahrnuje (1) kódování stavů (tak, aby byly odlišeny všechny stavy včetně $q_0, q_F$), (2) symbolů z $\Gamma$ a (3) přechodové funkce $\delta$. \emph{Kódování stavů}: Množinu stavů $Q$ uspořádáme do posloupnosti $q_0, q_F, q, p, \dots, t$. Stav $q_j$ zakódujeme jako $0^j$, přičemž indexujeme (např. od nuly.

\emph{Kódování symbolů} a příkazů $L/R$: Předpokládáme, že $\Gamma = \Sigma \cup \{\Delta\}$. Uspořádáme $\Sigma$ do posloupnosti $a_1, a_2, \dots, a_n$ a zvolíme tyto kódy: $\Delta \to \epsilon, L \to 0, R \to 00, a_i \to 0^{i+2}$.

\emph{Přechod} $\delta(p, x) = (q, y)$, kde $y \in \Gamma \cup \{L,R\}$, reprezentujeme čtveřicí $(p, x, q, y)$ a kódujeme zřetězením kódů $p, x, q, y$ při použití 1 jako oddělovač, tj. jako $\left<p\right>1\left<y\right>1\left<q\right>1\left<y\right>$, kde $\left<\_\right>$ značí kód $\_$.

Celý TS kódujeme jako posloupnost kódů přechodů oddělených a ohraničených 1.

\subsection{Univerzální TS}
Programovatelný stroj, který umožňuje ve vstupním řetězci specifikovat konkrétní TS (tj. program) i data, nad nimiž má tento stroj pracovat.

TS, který má být simulován budeme kódovat jak bylo uvedeno výše, vstupní řetězec budeme kódovat jako posloupnost příslušného kódu symbolů oddělených a ohraničených 1. Kód stroje a vstupního řetězce oddělíme např. $\#$.

Univerzální TS, který zpracuje toto zadání, můžeme navrhnout jako třípáskový stroj, který
\begin{itemize}
	\item má na 1. psáce zadání (později výstup
	\item 2. pásku používá k simulaci pracovní pásky původního stroje
	\item na 3. pásce má zaznamenán aktuální stav simulovaného stroje a aktuální pozici hlavy (pozice hlavy $i$ je kována jako $0^i$).
\end{itemize}

Univerzální stroj pracuje takto:
\begin{enumerate}
	\item Stroj zkontroluje, zda vstup odpovídá zadání. Pokud ne, abnormálně zastaví.
	\item Přepíše $w$ na 2. pásku, na 3. pásku umístí kód $q_0$ a za něj poznačí, že hlava se nachází na levém okraji pásky
	\item Na druhé pásce vyhledá aktuální symbol pod hlavou simulovaného stroje a na 1. pásce vyhledá přechod proveditelný  ze stavy zapsaného na začátku 3. pásky pro tento vstupní symbol. Pokud žádný přechod není možný, stroj abnormálně zastaví.
	\item Stroj povede na 2. a 3. pásce změny odpovídající simulovanému přechodu (přepis aktuálního symbolu, změna pozice hlavy, změna řídícího symbolu stavu).
	\item Pokud nebyl dosažen stav $q_F$ simulovaného stroje, přejdeme na bod 3. Jinak stroj vymaže první pásku, umístí na ni obsah 2. pásky a zastaví normálně (přechodem do koncového stavu).
\end{enumerate}
Víme, že uvedený strom můžeme převést na jednopáskový univerzální TS, který budeme dále značit jako $T_U$.

\subsection{Problém zastavení TS}

\begin{veta}
Problém zastavení TS (Halting Problem), kdy nás zajímá, zda daný TS $M$ pro daný vstupní řetězec $w$ zastaví, není rozhodnutelná, ale je částečně rozhodnutelný.
\end{veta}
Odpovídá rozhodování jazyka $HP = \{\left<M\right>\#\left<w\right> | M \text{ zastaví při } w\}$, kde $\left<M\right>$ je kód TS $M$ a $\left<w\right>$ je kód $w$.

Částečnou rozhodnutelnost dokážeme pomocí modifikace, která převede abnormální zastavení na přechod do $q_F$.

Nerozhodnutelnost ukážeme pomocí diagonalizace.

Komplement problému zastavení není ani částečně rozhodnutelný a jazyk
$$co-HP = \{\left<M\right>\#\left<w\right> | M \text{ nezastaví při } w\}$$
je příkladem jazyku, který není ani rekurzivně vyčíslitelný.

\section{Redukce}
\subsection{Důkaz nerozhodnutelnost redukcí}
Technika \emph{redukce} patří spolu s diagonalizací k nejpoužívanějším technikám důkazu, že problém není rozhodnutelná (částečně rozhodnutelný), neboli že jazyk není rekurzivní (rekurzivně vyčíslitelný):
\begin{itemize}
	\item víme, že jazyk $A$ není rekurzivní (rekurzivně vyčíslitelný)
	\item zkoumáme jazyk $B$
	\item ukážeme, že $A$ lze úplným TS převést (redukovat) na $B$
	\item to ale znamená, že $B$ rovněž není rekurzivní (rekurzivně vyčíslitelný) -- jinak by šlo použít úplná TS (ne-úplný TS) přijímající $B$ a příslušné redukce k sestavení úplného TS (ne-úplného TS) přijímajícího $A$., což by byl spor.
\end{itemize}

\begin{mydef}
Nechť $A, B$ jsou jazyky $A \subseteq \Sigma^*, B \subseteq \in \Psi^*$. Redukce jazyka $A$ na jazyk $B$ je rekurzivně vyčíslitelná funkce $\sigma: \Sigma^* \to \Psi^*$ taková, že $w \in A \Leftrightarrow \sigma(w) \in B$.
\end{mydef}

Existuje-li redukce jazyka $A$ na $B$, říkáme, že $A$ je redukovatelná na $B$, což značíme $A \leq B$.

\begin{veta}
Nechť $A \leq B$.
\begin{enumerate}
	\item Není-li jazyk $A$ rekurzivně vyčíslitelný, pak ani jazyk $B$ není rekurzivně vyčíslitelný.
	\item Není-li jazyk $A$ rekurzivní, pak ani jazyk $B$ není rekurzivní.
	\item Je-li jazyk $B$ rekurzivně vyčíslitelný, pak i jazyk $A$ je rekurzivně vyčíslitelný.
	\item Je-li jazyk $B$ rekurzivní, pak i jazyk $A$ je rekurzivní.
\end{enumerate}
\end{veta}

\section{Problém náležitost a další problémy}

\subsection{Problém náležitosti pro $\mathcal{L}_0$}
\begin{veta}
Problém náležitosti (Membership probem) řetězce $w$ do jazyka $L$ typu 0 \emph{není rozhodnutelný}, ale je \emph{částečně rozhodnutelný}.
\end{veta}
Částečná rozhodnutelnost: Univerzání TS, který bude simulovat $M$.

Nerozhodnutelnost: redukcí z problému zastavení.

Komplement problému náležitosti není ani částečně rozhodnutelný.

\subsection{Další problémy}

Konstrukce úplného TS: Rozhodnutelné
\begin{itemize}
	\item Daný TS má alespoň 2005 stavů
	\item Daný TS učiní více než 2005 kroků na vstupu $\epsilon$
	\item Daný TS učiní více než 2005 kroků na nějakém vstupu
\end{itemize}

Konstrukce (ne-úplného) TS: Částečně rozhodnutelné:
\begin{itemize}
	\item Jazyk daného TS je neprázdný
	\item Jazyk daného TS obsahuje alespoň 2005 slov
\end{itemize}

Důkaz redukcí: Nerozhodnutelné:
\begin{itemize}
	\item Jazyk daného TS je prázdný
	\item Jazyk daného TS obsahuje nanejvýš 2005 slov
	\item Jazyk daného TS je konečný (regulární, bezkontextový, kontextový, rekurzivní)
\end{itemize}

\section{Postův korespondenční problém}
jako problém zastavení, důležité východisko redukce pro dokazování nerozhodnutelnosti mnoha problémů.

\subsection{Postův korespondenční problém}
\begin{mydef}
\begin{itemize}
	\item \emph{Postův systém} nad abecedou $\Sigma$ je dán neprázdným seznamem $S$ dvojic neprázdných řetězců nad $\Sigma, S = \left<(\alpha_1, \beta_1), \dots,\alpha_k, \beta_k)\right>, \alpha_i, \beta_i \in \Sigma^+, k \geq 1$.
	\item Řešením \emph{Postova systému} je každá neprázdná posloupnost přirozených čísel $I = \left<i_1, i_2, \dots, i_m\right>, 1 \leq i_j \leq k, m \geq 1$, taková, že
	$$\alpha_{i_1}\alpha_{i_2}\dots\alpha_{i_m} = \beta_{i_1}\beta_{i_2}\dots\beta_{i_n}$$
	(Pozor: $m$ není omezení délky a indexy se mohou opakovat!)
	\item Postův problém (PCP) zní: Existuje pro daný Postův problém řešení?
\end{itemize}
\end{mydef}

\subsection{Nerozhodnutelnost PCP}
\begin{veta}
Postův korespondenční problém je nerozhodnutelný
\end{veta}
Plyne z nerozhodnosti iniciálního PCP, u kterého požadujeme, aby řešení začínalo vždy jedničkou. To dále redukcí z problému náležitosti TS.

\subsection{Nerozhodnutelnost redukcí z PCP}
Problém prázdnosti jazyka dané kontextové gramatiky není ani částečně rozhodnutelný.
\begin{itemize}
	\item Použijeme redukci komplementu PCP. Redukce přiřadí seznamu $S = (\alpha_1, \beta_1), \dots, (\alpha_1, \beta_1)$, definujícímu instanci PCP, kontextovou gramatiku G takovou, že PCP založený na S nemá řešení právě tehdy, když $L(G) = \emptyset$.
	\item Uvažujeme jazyky $L_\alpha, L_\beta$ nad $\Sigma \cup \{\#, 1, \dots, k\}$ (předp. $\Sigma \cap \{\#, 1, \dots, k\} = \emptyset$):
	$$L_\alpha = \{\alpha_{i_1}, \dots \alpha_{i_m} \# i_m, \dots i_1 | 1 \leq i_j \leq k, j = 1, \dots, m, m \geq 1\} $$
	$$L_\alpha = \{\beta_{i_1}, \dots \beta_{i_m} \# i_m, \dots i_1 | 1 \leq i_j \leq k, j = 1, \dots, m, m \geq 1\} $$
	\item Je zřejmé, že $L_\alpha, L_\beta$ jsou kontextové jazyky (dokonce bezkontextové deterministické), tudíž $L_\alpha \cap L_\beta$ je také kontextový a můžeme tedy efektivně sestavit gramatiku $G$, která tento jazyk generuje (např. konstrukcí LOA).
	\item $L_\alpha \cap L_\beta$ zřejmě obsahuje právě řetězce $u\#v$, kde $v$ odpovídá inverzi řešení dané instance PCP.
	\item Hledaná redukce tedy přiřadí dané instanci PCP gramatiku G.
\end{itemize}

\subsection{Souhrn některých vlastností jazyků}

\begin{tabular}{l |c|c|c|c|c|c|}
											&Reg&DCF& CF& CS&Rec&RE \\ \hline
	$w \in L(G)$?							& R & R & R & R & R & N \\ \hline
	$L(G)$ prázdný? konečný?				& R & R & R & N & N & N \\ \hline
	$L(G) = \Sigma$							& R & R & N & N & N & N \\ \hline
	$L(G) = R, R \in \mathcal{L}_3$			& R & R & N & N & N & N \\ \hline
	$L(G_1) = L(G_2)$						& R & R & N & N & N & N \\ \hline
	$L(G_1) \subseteq L(G_2)$				& R & N & N & N & N & N \\ \hline
	$L(G_1) \in \mathcal{L}_3$				& A & R & N & N & N & N \\ \hline
	$L(G_1) \cap L(G_2)$ je stejného typu?	& A & N & N & A & A & A \\ \hline
	$L(G_1) \cup L(G_2)$ je stejného typu?	& A & N & A & A & A & A \\ \hline
	Komplement $L(G)$ je stejného typu?		& A & A & N & A & A & N \\ \hline
	$L(G_1) \cdot L(G_2)$ je stejného typu?	& A & N & A & A & A & A \\ \hline
	$L(G)^*$ je stejného typu?				& A & N & A & A & A & A \\ \hline
	Je $G$ víceznačná?						& R & N & N & N & N & N \\ \hline
\end{tabular}

\section{Riceova věta}
\subsection{Riceova věta -- první část}
\begin{veta}
Každá netriviální vlastnost rekurzivně vyčíslitelných jazyků je nerozhodnutelná.
\end{veta}

\begin{mydef}
Budiž dána abeceda $\Sigma$. Vlastnost rekurzivně vyčíslitelných množin je zobrazení $P : \{ \text{ rekurzivně vyčíslitelné podmnožiny množiny } \Sigma^* \} \to \{\perp, \top\}$, kde $\top$, resp. $\perp$ reprezentují pravdy resp. nepravdu.
\end{mydef}

\begin{mydef}
Vlastnost rekurzivně vyčíslitelných množin je netriviální, pokud není vždy (pro všechny r.v. množiny) pravdivá ani vždy nepravdivá.
\end{mydef}

\subsection{Riceova věta -- druhá část}
\begin{mydef}
Vlastnost P r.v. množin nazveme monotónní, pokud každé r.v. množiny A, B takové, že $A \subseteq B$, platí $P(A) \Rightarrow P(B)$.
\end{mydef}

\begin{veta}
Každá netriviální nemonotónní vlastnost rekurzivně vyčíslitelných jazyků není ani částečně rozhodnutelná.
\end{veta}

\section{Alternativy Turingova stroje}
\subsection{Automaty s jednou frontou}
Stroj s konečným řízením, (neomezenou) FIFO frontou a přechody, které dovolují načíst ze začátku fronty a zapsat na konec fronty symboly z frontové abecedy $\Gamma$. (Rotace fronty)

\subsection{Zásobníkové automaty s dvěma a více frontami}
(pomocí dvou zásobníků můžeme implementovat frontu)

\subsection{Automaty s čítači (pro dva a více čítačů) a operacemi +1, -1 a test na 0}
(pomocí čtyř čítačů je možné simulovat dva zásobníky)

Dále také $\lambda$-kalkul či parciálně-rekurzivní funkce.




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Parciální rekurzivní funkce.} \label{cha:24}
1. semestr, TIN, \texttt{opora.pdf}, kapitola 6.8

\section{Základy teorie rekurzivních funkcí}

identifikace funkcí, které jsou \uv{spočitatelné}, tj. vyčíslitelné v obecném smyslu (bez ohledu na konkrétní výpočetní systém).

Pouze funkce tvaru $f: \mathbb{N}^m \to \mathbb{N}^n$, kde $\mathbb{N} = \{1, 2, \dots\}, m,n \in \mathbb{N}$. n-tici $(x_1, x_2, \dots, x_n) \in \mathbb{N}$ budeme označovat jako $\overline{x}$.
\begin{itemize}
	\item Totální funkce nad množinou X -- definičním oborem je celá X (např sčítání)
	\item Striktně parciální funkce nad množinou X -- alespoň pro jeden prvek $x \in X$ není definována funkční hodnota (např. dělení).
\end{itemize}

\subsection{Počáteční funkce}
Stavební kameny vyšších funkcí
\begin{enumerate}
	\item \emph{Nulová funkce} (zero function): $\xi() = 0$ zobrazuje prázdnou n-tici $\mapsto 0$
	\item \emph{Funkce následníka} (successor function): $\sigma: \mathbb{N} \to \mathbb{N} \quad \sigma(x) = x + 1$
	\item \emph{Projekce} (projection): $\pi_k^n: \mathbb{N}^n \to \mathbb{N}$. Vybírá z n-tice k-tou složku: $\pi_2^3(7,6,4) = 6$.
	
	$\pi_0^n: \mathbb{N}^n \to \mathbb{N}^0$, tj. $\pi_0^3(1,2, 3) = ()$
\end{enumerate}

\subsection{Primitivně rekurzivní funkce}
Funkce tvořené z počátečních pomocí těchto tří způsobů:
\begin{enumerate}
	\item \emph{Kombinace}: Kombinací dvou funkcí $f: \mathbb{N}^k \to \mathbb{N}^m$ a $g: \mathbb{N}^k \to \mathbb{N}^n$ získáme funkci, pro kterou
	$f \times g: \mathbb{N}^k \to \mathbb{N}^{m+n}$, tedy $f \times g(\overline{x}) = (f(\overline{x}), g(\overline{x})), \overline{x} \in \mathbb{N}^k$
	\item \emph{Kompozice} dvou funkcí $f: \mathbb{N}^k \to \mathbb{N}^m$ a $g: \mathbb{N}^m \to \mathbb{N}^n$ je funkce, pro kterou
	$g \circ f : \mathbb{N}^k \to \mathbb{N}^n$, tedy $g \circ f(\overline{x}) = g(f(\overline{x})), \overline{x} \in \mathbb{N}^k$
	\item \emph{Primitivní rekurze} je technika, která umožňuje vytvořit funkci $f: \mathbb{N}^{k+1} \to \mathbb{N}^m$ na základě jiných dvou funkcí $g: \mathbb{N}^k \to \mathbb{N}^m$ a $h: \mathbb{N}^{k+m+1} \to \mathbb{N}^n$ rovnicemi
	$$f(\overline{x}, 0) = g(\overline{x})$$
	$$f(\overline{x}, y+1) = h(\overline{x}, y, f(\overline{x}, y)), \overline{x} \in \mathbb{N}^k$$
\end{enumerate}

\begin{mydef}
Třída primitivních rekurzivních funkcí obsahuje všechny funkce, které mohou být z počátečních funkcí vytvořeny:
\begin{enumerate}
	\item kombinací
	\item kompozicí a 
	\item primitivní rekurzí.
\end{enumerate}
\end{mydef}

\begin{veta}
Každá primitivně rekurzivní funkce je totální funkce.
\end{veta}

\subsection{Příklady primitivně rekurzivních funkcí}

\emph{Konstantní funkce}: Zavedeme funkci $\kappa_m^n$, která libovolné n-tici $\overline{x} \in \mathbb{N}^n$ přiřadí konstantní hodnotu $m \in \mathbb{N}$.
$$\kappa_m^0 = \underbrace{\sigma \circ \sigma \circ \dots \circ \sigma}_\text{m-krát}$$
Pro $n > 0$ je $\kappa_m^n$ funkce rekurivně primitivní:
$$\kappa_m^n(\overline{x}, 0) = \kappa_m^{n-1}(\overline{x})$$
$$\kappa_m^n(\overline{x}, y+1) = \pi_{n+1}^{n+1}(\overline{x}, y, \kappa_m^n(\overline{x}, y))$$

\emph{Funkce násobení}
$$\text{mult}(x, 0) = \kappa_0^1(x)$$
$$\text{mult}(x, y+1) = \text{plus}(x, \text{mult}(x, y))$$

\emph{Funkce předchůdce}
$$\text{pred}(0) = \xi()$$
$$\text{pred}(y+1) = \pi_1^2(y, \text{pred}(y))$$

\emph{Funkce monus}
$$\text{monus}(x, 0) = \pi_1^1(x)$$
$$\text{monus}(x, y+1) = \text{pred}(\text{monus}(x, y))$$

\begin{mydef}
$\text{eq}(x, y) = 1 \overset{\cdot}{-} ((y\overset{\cdot}{-}x) + (x\overset{\cdot}{-}y)$ nebo formálněji $eq \equiv \text{monus} \circ (\text{plus} \circ ((\text{monus} \circ (\pi_2^2 \times \pi_1^2)) \times \text{monus} \circ (\pi_1^2 \times \pi_2^2))))$
\end{mydef}

\subsection{Funkce mimo primitivně rekurzivní funkce}
Funkce, které jsou vyčíslitelní a nejsou primitivně rekurzivními. Jsou to všechny striktně parciální funkce.

Např. Ackermanova funkce:
$$A(0, y) = y + 1$$
$$A(x+1, 0) = A(x, 1)$$
$$A(x+1, y+1) = A(x, A(x+1,y))$$

\begin{veta}
Existuje totální funkce z $\mathbb{N}$ do $\mathbb{N}$, která není primitivně rekurzivní.
\end{veta}

\begin{mydef}
Třída totálních vyčíslitelných funkcí se nazývá $\pi$-rekurzivní funkce
\end{mydef}

Funkce: Počáteční $\subseteq$
primitivně rekurzivní $\subseteq$
$\pi$-rekurzivní $\subseteq$
vyčíslitelné $\subseteq$

\subsection{Parciální rekurzivní funkce}
Minimalizace: Vytvoření funkce $f: \mathbb{N}^n \to \mathbb{N}$ z jiné funkce $g: \mathbb{N}^{n+1} \to \mathbb{N}$ předpisem, v němž $f(\overline{x})$ je nejmenší $y$ takové, že
$$g(\overline{x}, y) = 0$$
$$g(\overline{x}, z) \text{je definována pro } \forall z < y, z \in \mathbb{N}$$
Tuto konstrukci zapisujeme notací
$$f(\overline{x}) = \mu y [g(\overline{x}, y) = 0]$$
Funkce definovaná minimalizací je skutečně vyčíslitelná. Výpočet hodnoty $f(\overline{x})$ zahrnuje výpočet $g(\overline{x}, 0), g(\overline{x}, 1), \dots$ tak dlouho, dokud nedostaneme
\begin{itemize}
	\item $g(\overline{x}, y) = 0$ \dots potom $f(\overline{x}) = y$
	\item $g(\overline{x}, z) $ je nedefinována \dots potom $f(\overline{x})$ je nedefinována
\end{itemize}

\begin{mydef}
Třída parciálně rekurzivních funkcí je třída parciálních funkcí, které mohou být vytvořeny z počátečních funkcí aplikací
\begin{enumerate}
	\item kombinace,
	\item kompozice,
	\item primitivní rekurze a
	\item minimalizace.
\end{enumerate}
\end{mydef}

\section{Vztah vyčíslitelných funkcí a Turingových strojů}

\subsection{Turingovsky vyčíslitelné funkce}

\begin{mydef}
Turingův stroj $M=(Q, \Sigma, \Gamma, \delta, q_0, q_F)$ vyčísluje (počítá) parciální funkci $f: \Sigma^{*m} \to \Sigma_1^{*n}, \Sigma_1 \in \Gamma, \Delta \not\in \Sigma_1$, jestliže pro každé $(w_1, w_2, \dots w_m) \in \Sigma^{*m}$ a odpovídá konfiguraci $\underline{\Delta} w_1 \Delta w_2 \Delta \dots \Delta w_m \Delta \Delta \Delta$ stroj $M$:
\begin{enumerate}
	\item v případě, že $f(w_1, \dots, w_m)$ je definována, pak $M$ zastaví a páska obsahuje $\underline{\Delta} v_1 \Delta v_2 \Delta \dots \Delta v_n \Delta \Delta \Delta$, kde $(v_1, v_2, \dots v_n) = f(w_1, w_2, \dots, w_m)$
	\item v případě, že $f(w_1, \dots, w_m)$ není definována, $M$ cykluje (nikdy nezastaví), nebo zastaví abnormálně.
\end{enumerate}
\end{mydef}
(funkce Turingovsky vyčíslitelná)

\subsection{Turinovská vyčíslitelnost parciálně rekurzivních funkcí}

\begin{veta}
Každá parciálně rekurzivní funkce je Turingovsky vyčíslitelná.
\end{veta}

\subsection{Reprezentace Turingova stroje parciálně rekurzivními funkcemi}
\begin{veta}
Každý výpočetní proces prováděný Turingovým strojem je procesem vyčíslení nějaké parciálně rekurzivní funkce.
\end{veta}
Pokud budeme interpretovat obsah pásky (vstup, po zastavení stroje) jako desítkové číslo, můžeme TS považovat za funkci $f: \mathbb{N} \to \mathbb{N}$.

Pomocí parciálně rekurzivních funkcí lze vyjádřit součásti a události TS:
\begin{itemize}
	\item \emph{mov} = 2 jestliže $\delta(p, q) = (*, R)$, 1 jestliže $\delta(p, x) = (*, L)$, 0 jinak.
	\item \emph{sym} = y jestliže $\delta(p, x) = (*, y)$, x jinak
	\item \emph{state} = q jestliže $\delta(p, x) = (q, *)$, k jestliže $p=0$ nebo $\delta(p, x)$ není definována
	\item \emph{cursym}
\end{itemize}
Konfigurace TS: $(w, p, n)$, kde $w$ je obsah pásky, $p$ je přítomný stav, $n$ je pozice hlavy.
$$\text{cursym}(w, p, n) = quo(w, b^{n-1}) \overset{\cdot}{-} mult(b, quo(w, b))$$















%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Časová a paměťová složitost} \label{cha:25}
1. semestr, TIN, \texttt{opora.pdf}, 7. kapitola

(třídy složitosti, úplnost, SAT problém)

Aplikace TS pro popis a klasifikaci časové a paměťové složitosti.

\section{Základní pojmy složitosti}
\subsection{Složitost algoritmů}
Každý algoritmus je implementovatelný jistým TS.

Dvě třídy:
\begin{enumerate}
	\item problém, jež nejsou \emph{algoritmicky ani částečně rozhodnutelné} (funkce algoritmicky nevyčíslitelné)
	\item Problém \emph{algoritmicky alespoň částečně rozhodnutelné} (funkce algoritmicky vyčíslitelné)
\end{enumerate}

Zabýváme se částečně rozhodnutelnými v souvislosti s jejich \emph{složitostí} rozhodování (vyčíslování). Cílem \emph{vyjádřit (kvantifikovat) požadované zdroje (čas, prostor) jako funkci závisející na délce vstupního řetězce}.

\subsection{Různé případy při analýze složitosti}
Složitost je funkcí $\text{Compl}_M: \mathbb{N} \to \mathbb{N}$. Je více možností:
\begin{enumerate}
	\item Analýza složitosti \emph{nejhoršího případu}
	\item Analýza složitosti \emph{nejlepšího případu}
	\item Analýza složitosti \emph{průměrného případu}
\end{enumerate}
\emph{Průměrná složitost algoritmu} je definována následovně: Jestliže algoritmus TS vede k $m$ různým výpočtům (případům) s cenou $c_1, c_2, \dots, c_m$, jež nastávají s pravděpodobností $p_1, p_2, \dots, p_m$, pak \emph{průměrná složitost algoritmu} je dána jako $\sum_{i=1}^n p_i c_i$.

\subsection{Složitost výpočtu TS}
\begin{itemize}
	\item \emph{Časová složitost} -- počet kroků (přechodů) TS provedených od počátku do konce výpočtu.
	\item \emph{Prostorová (paměťová) složitost} -- počet \uv{buněk} pásky TS požadovaný pro daný výpočet.
\end{itemize}

\begin{lemma}
Je-li časová složitost prováděného TS rovna $n$, pak prostorová složitost tohoto výpočtu není větší než $n+1$.
\end{lemma}

\begin{mydef}
Řekněme, že $k$-páskový DTS (resp. NTS) M přijímá jazyk $L$ nad abecedou $\Sigma$ v čase $T_M: \mathbb{N} \to \mathbb{N}$, jestliže $L = L(M)$ a $M$ přijme (resp. může přijmout) každé $w \in L$ v nanejvýš $T_M(|w|)$ krocích.
\end{mydef}

\begin{mydef}
Řekneme, že $k$-páskový DTS (resp. NTS) M přijímá jazyk $L$ nad abecedou $\Sigma$ v prostoru $S_M: \mathbb{N} \to\mathbb{N}$, jestliže $L = L(M)$ a $M$ přijme (resp. může přijmout) každé $w \in L$ při použití nanejvýš $S_M(|w|)$ buněk pásky.
\end{mydef}
(Do prostorové složitosti nepočítáme buňky pásky, na nichž je zapsán vstup, pokud nebudou během výpočtu přepsány)

\subsection{Složitost a cena atomických operací}
U TS předpokládáme \emph{uniformní cenové kritérium}, kdy každá operace má stejnou cenu.
Může být logaritmické cenové kritérium, kdy pro operaci manipulující operand o velikosti $i > 0$ přiřadíme cenu $\lfloor \lg i \rfloor + 1$.

\subsection{Složitost výpočtu na TS a v jiných prostředích}
pro modely blízké počítačům je výpočetní složitost polynomiálně vázaná se složitostí výpočtu na TS.
\begin{itemize}
	\item RAM stroje mají paměť s náhodným přístupem, instrukce typu LOAD, STORE, ADD, SUB, MULT, DIV, vsup, výstup, nepodmíněný skok a podmíněný skok, HALT. Program součástí řízení stroje, u RASP v paměti stejně jako operandy.
	\item Funkce $f_1(n), f_2(n): \mathbb{N} \to \mathbb{N}$ jsou polynomiálně vázané, existují-li polynomu $p_1(x)$ a $p_2(x)$ takové, že pro všechny hodnoty $n$ je $f_1(n) \leq p_1(f_2)n))$ a $f_2(n) \leq p_2(f_1(n))$.
	\item Logaritmické cenové kritérium se uplatní u možnosti násobení dvou čísel
\end{itemize}

\subsection{Asymptotická omezení složitosti}
Přesné informace o složitosti jsou většinou zbytečné, o skutečném prostoru/čase výpočtu vypovídá málo.

\begin{mydef}
Nechť $\mathcal{F}$ je množina funkcí $f: \mathbb{N} \to \mathbb{N}$. Pro danou funkci $f \to \mathcal{F}$ definujeme množiny funkcí $O(f(n)), \Omega(f(n)), \Theta(f(n))$ takto:
\begin{itemize}
	\item Asymptotické horní omezení funkce $f(n)$ je množina $O(f(n)) = \{g(n) \in \mathcal{F} | \exists c \in \mathbb{R}^+, \exists n_0 \in \mathbb{N} \forall n \in \mathbb{N}: n \geq n_0 \Rightarrow 0 \leq g(n) \leq c \cdot f(n)\}$
	\item Asymptotické dolní omezení funkce $f(n)$ je množina $\Omega(f(n)) = \{g(n) \in \mathcal{F} | \exists c \in \mathbb{R}^+, \exists n_0 \in \mathbb{N} \forall n \in \mathbb{N}: n \geq n_0 \Rightarrow 0 \leq c \cdot f(n) \leq g(n)\}$
	\item Asymptotické oboustranné omezení funkce $f(n)$ je množina $\Theta(f(n)) = \{g(n) \in \mathcal{F} | \exists c_1, c_2 \in \mathbb{R}^+, \exists n_0 \in \mathbb{N} \forall n \in \mathbb{N}: n \geq n_0 \Rightarrow 0 \leq c_1 \cdot f(n) \leq g(n) \leq c_2 \cdot f(n)\}$
\end{itemize}
\end{mydef}

\section{Třídy složitosti}
\subsection{Třídy složitosti}

\begin{mydef}
Mějme dány funkce $t, s : \mathbb{N} \to \mathbb{N}$ a nechť $T_M$, resp. $S_M$, značí časovou, resp. prostorovou složitost TS M. Definujeme následující časové a prostorové třídy složitosti deterministických a nedeterministických TS:
\begin{itemize}
	\item DTime$[t(n)] = \{L | \exists $ k-páskový DTS M: $L = L(M)$ a $T_M \in O(t(n))\}$
	\item NTime$[t(n)] = \{L | \exists $ k-páskový NTS M: $L = L(M)$ a $T_M \in O(t(n))\}$
	\item DSpace$[s(n)] = \{L | \exists $ k-páskový DTS M: $L = L(M)$ a $S_M \in O(s(n))\}$
	\item NSpace$[s(n)] = \{L | \exists $ k-páskový NTS M: $L = L(M)$ a $S_M \in O(s(n))\}$
\end{itemize}
\end{mydef}

\subsection{Časově/prostorově konstruovatelné funkce}

Třídy složitosti obvykle budujeme nad tzv. časově/prostorově konstruovatelnými funkcemi: Intuitivní hierarchická struktura tříd složitosti.

\begin{mydef}
Funkci $t: \mathbb{N} \to \mathbb{N}$ nazveme časově konstruovatelnou (space constructible), jestliže existuje vícepáskový TS, jenž pro libovolný vstup $w$ zastaví s využitím přesně $t(|w|)$ buněk pásky.
\end{mydef}

\begin{mydef}
Funkci $s: \mathbb{N} \to \mathbb{N}$ nazveme prostorově konstruovatelnou (time constructible), jestliže existuje vícepáskový TS, jenž pro libovolný vstup $w$ zastaví s využitím přesně $s(|w|)$ krocích.
\end{mydef}

\begin{itemize}
	\item časově konstruovatelné funkce: $f(n) = n \log{n}, f(n) = n \sqrt{n}$
	\item časově nekonstruovatelné funkce: $f(n) = c, f(n) = \log{n}, f(n) = n^3$
	\item prostorově konstruovatelné funkce: $f(n) = \log{n}, f(n) = n^2$
	\item prostorově nekonstruovatelné funkce: $f(n) = c, f(n) = \log{\log{n}}$
\end{itemize}

\subsection{Nejběžněji užívané třídy složitosti}

Deterministický/nedeterministický polynomiální čas:
$$P = \bigcup\limits_{k=0}^\infty DTime(n^k) \quad \quad
NP = \bigcup\limits_{k=0}^\infty NTime(n^k)$$

Deterministický/nedeterministický polynomiální prostor:
$$PSPACE = \bigcup\limits_{k=0}^\infty DSpace(n^k)
\quad \equiv \quad
NPSPACE = \bigcup\limits_{k=0}^\infty NSpace(n^k)$$

Problémy z PSPACE se většinou neřeší v polynomiálním prostoru -- zvyšují se nároky na prostor výměnou za snížení časových nároků.

\subsection{Třídy pod a nad polynomiální složitostí}
Deterministický/nedeterministický logaritmický prostor:
$$LOGSPACE = \bigcup\limits_{k=0}^\infty DSpace(k \lg{n})
\quad \quad
NLOGSPACE = \bigcup\limits_{k=0}^\infty NSpace(k \lg{n})$$

Deterministický/nedeterministický exponenciální čas:
$$EXP = \bigcup\limits_{k=0}^\infty DTime(2^{n^k}) \quad \quad
NEXP = \bigcup\limits_{k=0}^\infty NTime(2^{n^k})$$

Deterministický/nedeterministický exponenciální prostor:
$$EXPSPACE = \bigcup\limits_{k=0}^\infty DSpace(2^{n^k})
\quad \equiv \quad
NEXPSPACE = \bigcup\limits_{k=0}^\infty NSpace(2^{n^k})$$

\subsection{Třídy nad exponenciální složitostí}

Deterministický/nedeterministický exponenciální čas:
$$k-EXP = \bigcup\limits_{l=0}^\infty DTime(2^{2^{\vdots^{2^{n^l}}}})
\quad \quad
k-NEXP = \bigcup\limits_{l=0}^\infty NTime(2^{2^{\vdots^{2^{n^l}}}})$$

Deterministický/nedeterministický exponenciální prostor:
$$k-EXPSPACE = \bigcup\limits_{l=0}^\infty DSpace(2^{2^{\vdots^{2^{n^l}}}})
\quad \equiv \quad
k-NEXPSPACE = \bigcup\limits_{l=0}^\infty NSpace(2^{2^{\vdots^{2^{n^l}}}})$$

\subsection{Vrchol hierarchie tříd složitosti}
Na vrcholu hierarchie tříd složitosti se pak hovoří o obecných třídch jazyků (funkcí):
\begin{itemize}
	\item Třída primitivně rekurzivních funkcí (PR) -- implementovaných pomocí zanořených cyklů s pevným počtem opakování.
	\item Třída $\mu$-rekurzivních funkcí (R) -- implementovaných pomocí zanořených cyklů s předem neurčeným počtem opakování.
	\item Třída $\mu$-rekurzivně vyčíslitelných funkcí (RE)
\end{itemize}

\section{Vlastnosti tříd složitosti}
\subsection{Vícepáskové stroje}
Zavedení vícepáskového stroje nemělo vliv na vyčíslitelnost. 

\begin{veta}
Je-li dán jazyk $L$ přijímaný nějakým $k$-páskovým DTS $M_k$ v čase $t(n)$, pak je také přijímán nějakým jednopáskovým DTS $M_1$ v čase $O(t(n)^2)$
\end{veta}

\subsection{Determinismus a nedeterminismus}
Determinismus výrazně snižuje zejména časové nároky výpočtu.

\begin{veta}
Je-li jazyk $L$ přijímán nějakým NTS $M_n$ v čase $t(n)$, pak je také přijímán nějakým DTS $M_d$ v čase $2^{O(t)n))}$.
\end{veta}

\begin{veta}
(Savitchův teorém) $NSpace[s(n)] \subseteq DSpace[s^2(n)]$ pro každou prostorově konstruovatelnou funkci $s(n) \geq \lg{n}$.
\end{veta}
Důsledek: $PSPACE \equiv NPSPACE$, $k-EXSPACE \equiv k-NEXSPACE$

\subsection{Prostor kontra čas}
\begin{veta}
$NSpace[t(n)] \subseteq DTime[O(1)^{t(n)}]$ pro každou časově konstruovatelnou funkci $t(n) \geq \lg{n}$.
\end{veta}

\subsection{Uzavřenost vůči doplňku}

Prostorové třídy jsou většinou uzavřeny vůči doplňku:
\begin{veta}
Jestliže $s(n) \geq \lg{n}$, pak $NSpace(s(n)) = co-NSpace(s(n))$
\end{veta}

Časové třídy $P$ a $EXP$ jsou uzavřeny vůči doplňku. U jiných tříd zůstává otázka uzavřenosti vůči doplňku otevřená.

\begin{veta}
Třída $P$ je uzavřená vůči doplňku.
\end{veta}

\subsection{Ostrost hierarchie tříd}
\begin{itemize}
	\item LOGSPACE, NLOGSPACE $ \subset $ PSPACE
	\item P $ \subset $ EXP
	\item NP $ \subset $ NEXP
	\item PSPACE $ \subset $ NEXPSPACE
	\item EXP $ \subset $ k-EXP, \dots
\end{itemize}

\subsection{Některé další zajímavé výsledky}

\begin{veta}
(Blumův teorém) Pro každou totální vyčíslitelnou funkci $f: \mathbb{N} \to \mathbb{N}$ existuje problém, jehož každé řešení s nějakou složitostí $t(n)$ může bát zlepšeno tak, že nové řešení má složitost $f(t(n))$ pro skoro každé $n \in \mathbb{N}$.
\end{veta}

\begin{veta}
(Gap Theorem) Ka každé rekurzivní funkci $\phi(n) > n$ existuje rekurzivní funkce $f(n)$ taková, že $DTime[\phi(f(n))] = DTime[f(n)]$.
\end{veta}

\subsection{$\mathcal{R}$ redukce, jazyky $\mathcal{C}$-těžké a $\mathcal{C}$-úplné}

\begin{mydef}
Nechť $\mathcal{R}$ je třída funkcí. Jazyk $L_1 \subseteq \Sigma_1^*$ je $\mathcal{R}$ redukovatelný (přesněji $\mathcal{R}$ many-to-one recudible) na jazyk $L_2 \subseteq \Sigma_2^*$, což zapisujeme $L_1 \leq_\mathcal{R}^* L_2$, jestliže existuje funkce z $\mathcal{R}$ taková, že $w \in L_1 \Leftrightarrow f(w) \in L_2$.
\end{mydef}

\begin{mydef}
Nechť $\mathcal{R}$ je třída funkcí a $\mathcal{C}$ třída jazyků. Jazyk $L_0$ je $\mathcal{C}$-těžký ($\mathcal{C}$-hard) vzhledem k $\mathcal{R}$ redukovatelnosti, jestliže $\forall L \in \mathcal{C}: L \leq_\mathcal{R}^m L_0$.
\end{mydef}

\begin{mydef}
Nechť $\mathcal{R}$ je třída funkcí a $\mathcal{C}$ třída jazyků. Jazyk $L_0$ nazveme $\mathcal{C}$-úplný ($\mathcal{C}$-complete) vzhledem k $\mathcal{R}$ redukovatelnosti, jestliže $L_0 \in \mathcal{C}$ a $L_0$ je $\mathcal{C}$-těžký ($\mathcal{C}$-hard) vzhledem k $\mathcal{R}$ redukovatelnosti.
\end{mydef}

\subsection{Nejběžnější typy $\mathcal{R}$ redukovatelnosti a úplnosti}

\begin{itemize}
	\item MP, PSPACE, EXP -- úplnost je definována vůči \emph{polynomiální redukovatelnosti} (redukovatelnosti pomocí DTS pracujících v polynomiálním čase).
	\item P, NLOGSPACE -- úplnost definujeme vůči \emph{redukovatelnosti v deterministickém logaritmickém čase}.
	\item NEXP -- úplnost definujeme vůči \emph{exponenciální redukovatelnosti} (tj. redukovatelnosti pomocí DTS pracujících v exponenciálním čase).
\end{itemize}

Důležitá je polynomiální redukce, protože podobně jako třída P vymezuje prakticky řešitelné problémy, polynomiální redukovatelnost odpovídá realizovatelné převoditelnosti problémů.

\section{Příklady složitosti problémů}

LOGSPACE -- existence cesty mezi dvěma uzly v neorientovaném grafu

NLOGSPACE -- existence cesty mezi dvěma uzly v orientovaném grafu, 2-SAT (splnitelnost výrokových formulí tvaru konjunkce disjunkcí dvou literálů)

P -- splnitelnost Hornových klauzulí (predikátová logika), náležitost řetězce do jazyka BKG, následnost uzlů při průchodu grafem do hloubky.

NP -- 3-SAT, grafové problémy: existence kliky dané, Hamiltonovské kružnice v neorientovaném grafu, orientované Hamiltonovské kružnice v orientovaném grafu, barvitelnost, uzlové pokrytí neorientovaného gradu množinou uzlů o určité velikosti; problém obchodního cestujícího, knapsack

co-NP -- ekvivalence regulárních výrazů bez iterace

PSPACE -- ekvivalence regulárních výrazů, náležitost řetězce do kontextové gramatiky, model checking formulí temporální logiky (LTL -- výroková logika doplněná o operátory until, eventually, next-time s ohledem na velikost formule), nelepší tah ve hře Sokoban

EXP -- nejlepší tah v šachu, model checking procesů s neomezeným zásobníkem, inkluze pro tzv. visibly push-down jazyky.

EXPSPACE -- ekvivalence regulárních výrazů doplněných o operaci kvadrát $r^2$.

k-EXP / k-EXPSPACE -- rozhodování splnitelnost formulí Presburgerovy aritmetiky

mimo ELEMENTARY -- ekvivalence regulárních výrazů doplněných o negaci, rozhodování splnitelnost formulí logiky $WS1S$, verifikaci dosažitelnost v tzv. Lossy Channel Systems (procesy komunikující přes neomezenou, ale ztrátovou frontu).

\section{SAT problém}
Dokázaná NP-úplnost, lze použít pro důkaz NP-těžkosti.

\subsection{Polynomiální redukce}

\begin{mydef}
Polynomiální redukce jazyka $L_1$ nad abecedou $\Sigma_1$ na jazyk $L_2$ nad abecedou $\Sigma_2$ je funkce $f: \Sigma_1^* \to \Sigma_2^*$, pro kterou platí:
\begin{enumerate}
	\item $\forall w \in \Sigma_1^* : w \in L_1 \leftrightarrow f(w) \in L_2$
	\item $f$ je Turingovsky vyčíslitelná v polynomiálním čase
\end{enumerate}
Existuje-li polynomiální redukce jazyka $L_1$ na $L_2$, říkáme, že $L_1$ se redukuje na $L_2$ a píšeme $L_1 \leq _P^m L_2$.
\end{mydef}

\begin{veta}
Je-li $L_1 \leq_P^m L_2$ a $L_2$ je ve třídě $P$, pak $L_1$ je ve třídě P.
\end{veta}

\subsection{Problém splnitelnosti -- SAT problém}
Nechť $V = \{v_1, v_2, \dots, v_n\}$ je konečná množina Booleovských proměnných (prvotních formulí výrokového počtu). \emph{Literálem} nazveme každou proměnnou $v_i$ nebo její negaci $\overline{v_i}$. 
\emph{Klauzulí} nazveme výorokou formuli obsahující pouze literály spojené výrokovou spojkou $\lor$ (nebo).

\emph{SAT-problém} lze formulovat takto: Je dána množina proměnných V a množina klauzulí nad V. Je tato množina klauzulí splnitelná?

Každý konkrétní SAT problém můžeme zakódovat jediným řetězcem takto. Nechť $V = \{v_1, v_2, \dots, v_n\}$, každý literál $v_i$ zakódujeme řetězcem délky $m$, který obsahuje samé 0 s výjimkou $i$-té pozice, která obsahuje symbol $p$, jde-li o literál $v_i$, nebo $n$, jde-li o literál $\overline{v_i}$. Klauzuli reprezentujeme seznamem zakódovaných literálů oddělených symbolem $/$. SAT problém bude seznam klauzulí uzavřených v aritmetických závorkách.

Označme $L_{SAT}$ jazyk obsahující řetězce tohoto typu, které reprezentují splnitelné množiny klauzulí.

Přiřazení pravdivostních hodnot budeme reprezentovat řetězcem z $\{p, n\}^+$, kde $p$ v $i$-té pozici představuje přiřazení $v_i \approx $ true a $n$ v $i$-té pozici představuje přiřazení $v_i \approx $ false.

Pak test, zda určité hodnocení je modelem množiny klauzulí (množina klauzulí je pro toto ohodnocení splněna), je velmi jednoduchý. Můžeme jej přijímat pomocí 2-páskového TS, který:
\begin{itemize}
	\item začíná kontrolou, zda vstup reprezentuje množiny klauzulí
	\item na 2. pásku vygeneruje řetězec z $\{n,p\}^m$ nedeterministickým způsobem.
	\item posouvá hlavy na 1. pásce a testuje, zda pro dané ohodnocení (na 2 pásce) je množina klauzulí splnitelná.
\end{itemize}
Tento proces může být snadno implementován s polynomiální složitostí přijetí v závislosti na délce vstupního řetězce a tedy $L_{SAT} \in NP$.

\begin{veta}
Cookův teorém: Je-li $L$ libovolný jazyk z $NP$, pak $L \leq_P^m L_{SAT}$.
\end{veta}

\begin{veta}
SAT je $NP$-úplný vzhledem k polynomiální redukci.
\end{veta}

\subsection{NP-úplné jazyky}
\subsection{Význačné NP-úplné problémy}
\begin{description}
	\item[Satifiability] Je booleovský výraz splnitelný?
	\item[Clique] Obsahuje neorientovaný graf kliku velikosti $k$?
	\item[Vertex cover] Má neorientovaný graf dominantní množinu mohutnosti $k$?
	\item[Hamilton circuit] Má neorientovaný graf Hamiltonovskou kružnici?
	\item[Colorability] Má neorientovaný graf chromatické číslo $k$?
	\item[Direct Hamilton circuit] Má neorientovaný graf Hamiltonovkský cyklus?
	\item[Set cover]
	\item[Exact cover] %% TODO not importatnt ...
\end{description}

\subsection{Použití redukcí k důkazu úplnosti}

Dokažme, že problém 3SAT = $\{\psi | $ splnitelné formule $\psi$ v CNF obsahují v každé klauzuli nanejvýš 3 literály $\}$ je NP-úplný.
Musíme ukázat:
\begin{itemize}
	\item 3SAT $\in$ NP
	
	NTS si nedeterministicky zvolí přiřazení jednotlivým proměnným v 3SAT formuli a v polynomiálním čase ověří, zda je splňující přiřazení.
	
	\item SAT $\leq_p$ 3SAT
	
	Zkonstruujeme polynomiálně vyčíslitelnou funkci $f$, pro kterou platí
	$$A \in SAT \Leftrightarrow f(A) \in 3SAT$$
	Funkce $f$ pracuje následovně:
	
	Nechť $K = (a_1, a_2, \dots a_n)$ je klauzule v SAT, která má víc neč 3 literály. Klauzuli K nahradíme klauzulemi $K_1 = (a_1, a_2, b)$ a $K_2 = (\not b, a_3, \dots, a_n)$, kde literál b se nevyskytuje v původní formuli. Je zřejmé, že platí:
	$$K_1 \cup K_2 \text{ je splnitelná } \Leftrightarrow K \text{ je splnitelná}$$
	a navíc klauzule $K_2$ má o jeden literál méně, než původní klauzule $K$. Analogicky postupujeme, dokud formule obsahuje klauzule obsahující více než 3 literály. Je zřejmé, že funkce $f$ je polynomiálně vyčíslitelná a navíc pro ni platí výše uvedený vztah.
\end{itemize}





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Ukazatele a zákony paralelního zpracování. Funkce konst. účinnosti a škálovatelnost.} \label{cha:26}
1. semestr, TIN, \texttt{opora.pdf}, ?. kapitola

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Paralelizace programů: vzory programových a datových struktur, podpůrné struktury.} \label{cha:27}
\chapter{Paralelní zpracování v OpenMP, SPMD, smyčky, sekce a tasky. Synchronizační prostředky.} \label{cha:28}
\chapter{Architektury se sdílenou pamětí, UMA i NUMA, zajištění koherence pamětí cache.} \label{cha:29}
\chapter{Architektury distribuovaných systémů se zasílání zpráv.} \label{cha:30}
\chapter{Blokující a neblokující párové (point-to-point) komunikace v MPI.} \label{cha:31}
\chapter{Kolektivní komunikace v MPI, paralelní vstup a výstup.} \label{cha:32}
\chapter{Propojovací sítě: Topologie a směrovací algoritmu, přepínání a řízení toku.} \label{cha:33}
?. semestr, ??, \texttt{??}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Klasifikace metod komprese dat (ztrátové, bezeztrátové, intuitivní, algoritmické, četnost výskytu, pravděpodobnost výskytu), princip kódování délek sledů, kódování „přesuň na začátek.‘‘} \label{cha:34}
2. semestr, KKO, \texttt{KKO1-UVOD 2016.pdf}, \texttt{KKO2-ZAKLADNI TECHNIKY 2016.pdf}

\emph{Kódování} -- proces vzájemně jednoznačného přiřazení symbolů jedné množiny symbolům druhé množiny. Tato definice implicitně předpokládá blokový kód.

Existují také \emph{tokové (streaming) kódy}, které plynule kódují vstupní tok na výstupní tok (aritmetické kódování).

Kódování může \emph{zachovávat}, \emph{zmenšovat} (komprese) nebo \emph{zvětšovat} (překódování pro opravu chyb) redundanci kódu.

\emph{Redundance} -- číslo udávající objem dat, použitý při zakódování dané informace navíc, než je minimálně zapotřebí (informace = data).

\emph{Zdroj dat} bez paměti, nebo s pamětí (se vzájemnou závislostí symbolů).

\emph{Abecední redundance} -- v anglických textech se nejčastěji vyskytuje číslo E, proto se mu přiřadí nejkratší kód s proměnnou délkou kódového slova.

\emph{Kontextová redundance} -- za písmenem Q následuje v angličtině nejčastěji U. Výrazný u obrazových a zvukových záznamů.

Komprese náhodných souborů je prakticky nemožná, protože zde není prakticky žádná redundance. Komprese dvou různých souborů musí vést na dva různé soubory, jinak by nebyla možná zpětná dekomprese.

Obecná metoda komprese neexistuje. Algoritmus musí zkoumat data, vyhledávat redundanci a snažit se ji odstranit. Metody jsou datově závislé.

\section{Klasifikace metod komprese dat}
(ztrátové, bezeztrátové, intuitivní, algoritmické, četnost výskytu, pravděpodobnost výskytu)

\emph{Neadaptivní kompresní metoda} je fixní a nemění svůj výpočtový postup. Navržena pro určitý typ dat. Naopak \emph{adaptivní metoda} zkoumá vstupní data a základě jejich analýzy přizpůsobuje svoje operace.

\emph{Ztrátová/bezstrátová komprese} Některé kompresní metody jsou ztrátové. Dosahují vyššího kompresního poměru za cenu ztráty jisté informace (komprese obrazu, videa, zvuku). Člověk nemusí poznat rozdíl.

\emph{Kaskádová} kompresní metoda je tvořena řetězcem po sobě jdoucích kompresí, případně přípravných úprav vstupního datového toku.

\emph{Perceptivní komprese} -- ztrátový kompresor odstraňuje data, jejichž nepřítomnost člověk nepozná (znalosti o lidském vnímání obrazu a zvuku). Proměnná subjektivní kvalita umožňuje komprimovat náročné úseky měně a jednoduché více.

\emph{Symetrická komprese}, pokud kompresor a dekompresor používají prakticky stejného algoritmu v inverzním režimu. U \emph{asymetrické metody} kompresor nebo dekompresor pracuje výrazně déle (nevadí u archivace).

\emph{Algoritmický/deterministický} kodér se nazývá, pokud pracuje ve shodě, tj. generuje správný komprimovaný kód.

\emph{Univerzální} je kompresní metoda, která nevyužívá statistik vstupního toku. Univerzální metoda je \emph{optimální}, pokud má kompresní parametry asymptoticky se blížící entropii dlouhého vstupního toku.

\emph{Rozdílování souborů} určuje rozdíly dvou souborů a ty pak komprimuje.

\begin{itemize}
	\item \emph{Proudový režim} -- kodér bere postupně byte, nebo několik bytů nad kterými pracuje.
	\item \emph{Blokový režim} -- vstupní tok čtený po blocích.
\end{itemize}

\begin{itemize}
	\item Fyzické metody: Pracuje s bitovým tokem a nevyužívají členění na slova
	\item Logické metody: Pracují s datovými položkami vstupního toku a nahrazují je kratšími položkami (specializované na daný typ dat)
\end{itemize}

Kompresní výkonnost:
\begin{itemize}
	\item Kompresní poměr = $\frac{\text{velikost vstupního toku}}{\text{velikost výstupního toku}}$. Může být popsáno jako \emph{bpb} (bitů na bit), \emph{bpp} (bitů na pixel), \emph{bpc} (bitů na znak). Také bitrate (bitová rychlost).\\
	Bitová režie -- funkce jednotlivých bitů: Část nese informaci, zbývající část (režie) nese jisté tabulky).
	\item Kompresní faktor -- obrácení hodnota kompresního poměru: $\frac{\text{velikost výstupního toku}}{\text{velikost vstupního toku}}$
	\item Kompresní zisk = $100 \log_e \frac{\text{referenční velikost}}{\text{komprimovaná velikost}}$, kde referenční velikost je buď nekomprimovaný tok, nebo komprimovaný nějakou standardní kompresní metodou.
	\item Rychlost komprese -- počet cyklů na byt (cpb), důležité pro kompresi na speciálním HW.
	\item Relativní komprese -- 
\end{itemize}

\subsection{Korpusy}
\emph{Korpus Calgary} -- 18 standardně používaných souborů sestavený k testování kompresních programů (textové, obrazové, objektové soubory).

\emph{Korpus Canterbury} -- z 800 dokumentů 11 tříd vybrány \uv{průměrné} dokumenty a další 3 náhodné. Chybí velké soubory, chybí texty v jiných jazycích, nepřítomnost skupin, medicínské soubory.

\emph{Korpus Silesia} -- aktuální typy souborů od textu po spustitelné, PDF, office, multimedia.

\emph{Pravděpodobnostní model} -- použitý u statistické komprese dat. Před kompresí se vytvoří model dat (přečtení celého souboru a určení frekvence výskytů symbolů -- zdlouhavé. Častěji odhady).

\emph{Adaptivní komprese} -- nejdříve se přiřadí stejná pravděpodobnost všem symbolům a ta se přizpůsobuje během komprese.

\section{Princip kódování délek sledů}
Úroveň binární/číselní/znaková/slovní. Myšlenka: \uv{Pokud se datová položka d vyskytuje ve vstupním textu n-krát za sebou (sled délky n), nahradí se n výskytů d jedinou dvojicí (n,d)}. Run Length Encoding (RLE).

Pro jednoznačné dekódovaná je potřeba ještě vyhrazený symbol, který uvozuje dvojici počtu a symbolu. Proto kódujeme pouze sledy o délce 4 a více znaky.

Problémy: V anglickém textu je mnoho dvojic, ale trojice jsou vzácné. Speciální znak @ se může ve vstupním textu vyskytovat. Maximální omezení na 255 opakování.

MNP 5 (Microcom Network Protocol): Komprese u modemů (řeší výskyt znaku @ v RLE): Tři stejné znaky se zakódují jako XXX0 (0 opakování), sled 4 znaků se zakóduje 4 znaky a komprese probíhá až od délek 5 symbolů.

Kompresní poměr RLE: N vstupních znaků, M opakování s průměrnou délkou L. Každé z M opakování se nahradí 3 znaků: $\frac{N - M(L-3)}{N}$.

Variantou je kódování digramů (pokud vstup obsahuje pouze některé symboly a my můžeme často opakující se dvojice nahradit symbolem, který se ve vstupní sekvenci nevyskytuje.

Nebo také kódování opakujících se frází a substituce vzorků (komprese počítačových programů, kde se často vyskytují vyhrazená slova, proměnné).

RLE komprese obrazu -- bitová mapa (ideálně černobílá). Pokud máme jenom dvě barvy, stačí ukládat délky (střídají se). Pro stupně šedi opět pomocí dvojice (délka sledu, hodnota pixelu).

Rozlišení hodny barvy od bytu obsahujícího počet:
\begin{itemize}
	\item Pokud máme pouze 128 barev, použijeme jeden bit na značku pro rozlišení barvy a pčtu
	\item Pokud máme 256 barev, můžeme jednu barvu zanedbat a volný symbol použít jako značku před počtem
	\item Pro každých 8 bajtů výstupu je jeden bajt označující, zda bajt na dané pozici je počet nebo barva.
\end{itemize}

U barevných lze kódovat sledy barev zvlášť. Lze skenovat po řádcích, sloupcích, nebo uhlopříčce. Dobré ukládat konec řádku (pixely \uv{přes hranu} nemají nic spolčeného).

Nevýhoda u obrazu: Když se obraz změní, musí se RLE kompletně přepočítat.

\subsection{BinHex 4.0}
(konverze 8 bitových souborů na ASCII)

Záhlaví s CRC, jménem souboru, délkou, autorem, typem. RLE kovaání pomocí $90_{16}$. Rozděnelní na 6-bitové úseky a zakování do podmnožiny 64 znaků ASCII.

\subsection{Obrazové soubory BMP}
Barevná paleta a pixely v základním tvaru nebo komprimované pomocí RLE. RLE8 (8bitová barevná hloubka) ukládá dvojice počet a hodnota pixelu. Dva nulové bity jsou konec řádku.

\section{Kódování \uv{přesuň na začátek}}
Myšlenkou je udržovat abecedu symbolů jako seznam, ve kterém jsou často se vyskytující symboly umístěny na začátku (zakódovaná hodnota je kolik symbolů jej v seznamu předchází). Když použijeme symbol, přesuneme jej na začátek seznamu.

Metoda je lokálně adaptivní (podle frekvence symbolů v lokálních oblastech vstupu). Pro vstup \uv{koncentrační vlastnost}. Střední hodnota znaků je menší. To je výhodné pro Huffmanovo nebo aritmetické kódování (nebo můžeme provést již v rámci tohoto):
\begin{itemize}
	\item Přiřadit Huffmanovy kódy celým číslům v rozsahu $[0, n]$ takž, že menší čísla budou mít kratší kódy
	\item Přiřadit kódy celým číslům tak, že kód čísla $i \geq 1$ je jeho binární podoba, před kterou je $\lfloor \log_2 i \rfloor$ nul.
	\item Adaptivní Huffmanovo kódování
	\item Pro maximální kompresi použít 2 průchody -- první počítá frekvence a druhý provede vlastní kódování (Huffmanovy kódy podle podle frekvence).
\end{itemize}

Podobně lze použít na slova, pokud máme omezenou vstupní abecedu, ale seznam A může růst do ohromné velikosti.

Skalární kvantování je ztrátová metoda. Nepoužívá se pro kompresi obrazu (raději vektorové kvantování nebo Grayův kód).


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Kódy s proměnnou délkou - princip, zdůvodnění, Huffmanovy kódy - různé typy, kanonický Huffmanův kód, adaptivní Huffmanův kód, aritmetický kód.} \label{cha:35}
2. semestr, KKO, \texttt{KKO3-1-STATISTICKE METODY-TI-UNARNI2016.pdf}, \texttt{KKO3-8-HUFFMAN 2016.pdf}, \texttt{KKO3-14-ARITM KODOVANI.pdf}

Pokud mají znaky různou pravděpodobnost výskytu (a tím pádem data menší entropii). Použití kódů s proměnnou délkou zmenšuje redundanci.

Kód může být nejednoznačný (kde oddělit jednotlivé zakódované znaky). Aby byl jednoznačný, je potřeba , aby měl \emph{prefixovou vlastnost}:
\uv{Když se některé bitová kombinace přidělí některému symbolu jako jeho kód, žádný jiný kód nesmí touto kombinací začínat}.

\section{Prefixové kódy}
Prefixový kód splňuje prefixovou vlastnost. Binární reprezentace čísel tuto vlastnost nemá a stejně tak nemusí být známa velikost množiny.

\subsection{Unární kódy}
Unární kód nezáporného celého čísla $n$ je definován jako $n-1$ jedniček následovaných jednou 0 (binární z doby kamenné).

Obecné unární kódy (start-step-stop) závisí na trojici celočíselných parametrů (start, step, stop) a je definován takto:

K datovým symbolům se vytvoří kódová slova tak, že n-té kódové slovo se stává z n jedniček, následovaných jednou 0, následovanou všemi kombinacemi bitů, kde $a = \text{start} + n \cdot \text{step}$. Když $a = \text{stop}$, pak se osamocená 0 předcházející a bitů vypustí. Počet kódů pro zadanou trojici je konečný a závisí na volbě parametrů: 380 kódů pro (3, 2, 9) a 2044 kódů pro (2, 1, 10).

Trojice (n, 1, n) definuje standardní n-bitové kódy, což můžeme ověřit přímou konstrukcí. Kód $(0, 0, \infty)$ definuje kód $0, 10, 110, 1110, \dots$.

Shannon-Fanoovo kódování byla první metoda k nalezení dobrých kódů s proměnnou délkou. Konstruuje kódu shora dolů (od levého největšího bitu k nejnižšímu).

\section{Huffmanovy kódy}

\subsection{Huffmanovo kódování}
Podobně jako Shannon-Fanovo kódování (tvoří kódy zdola nahoru -- zleva doprava). Začíná od symbolů s nejnižsí pravděpodobností.
Pokud máme více možností pro spojení dvojic, vybíráme ty, které jsou ve stromu níže (nižší variance kódu -- výhodné pro vysílání komunikační linkou).

Huffmanova metoda se nedá aplikovat na abecedu se dvěma symboly (nelze přiřadit kód kratší než 2 symboly). Ale lze tyto data používat jako 4 nebo 8 bitů s novou abecedou.

\subsection{Huffmanovo dekódování}
Před kompresí je potřeba určit kód (na základě pravděpodobnosti výskytu symbolů). Tyto pravděpodobnosti (jako odstupňovaná celá čísla) se musí uvést v komprimovaném toku, aby jakýkoliv dekodér byl schopný tok dekomprimovat. Lze poslat také kódy, nebo celý strom, což je ještě složitější/delší.

Sestrojit Huffmanův strom, odvodit kódy stejně jako kompresor. Nebo číst přímo ze stromu: pokud přečte 0, jdeme vetví dolů (pravděpodobnější), pokud 1, jdeme větví nahoru.

V Huffmanově stromě (kde je každý uzel součtem svých potomků) se váhový součet listů, kde váhy jsou vzdálenosti listů od kořene rovná součtu vnitřních uzlů (nelistů, včetně kořene).

Celkový počet různých kódů pro n symbolů je $2^{n-1}$

\paragraph{Ternární Huffmanovy kódy}: Snadno aplikovat na kódy s jiným číselným základem. Hledají se vždy 3 symboly s nejmenší pravděpodobností.

\paragraph{Výška Huffmanova stromu}: Nejnižší strom se vytvoří, pokud mají symboly stejné pravděpodobnosti. Výška úplného stromu je $n-1$ a nazývá se balancující, nebo nesymetrický strom (Fibonacciho posloupnost pravděpodobností).

Pokud tato délka stromu není žádoucí, lze strom přetvarovat a zkrátit nejdelší kódy (změna pravděpodobností z Fibonacciho posloupnosti).

\subsection{Kanonické Huffmanovy kódy}
vybrán z mnoha možných, protože vlastnosti umožňují snadné a rychlé požití.

Užitečné v případě, že máme velkou abecedu a je rozhodující rychlé dekódování. Dekodér snadno identifikuje délku testováním jednoho bitů za druhým. Jakmile je délka známá, symbol nalezneme jedním krokem.

Příklad: Archivace a komprese pomocí \emph{slovně orientovaného} adaptivního Huffmanova kodéru.

Dekodér: Hirschberg-Sieminski -- Vypočítává délky kódů abecedy s $n$ symboly s použitím  jediného pole o velikosti $2n$. Polovina tohoto pole se používá jako hromada.

\emph{Hromada} je vyrovnaný binární strom, ve kterém každý list obsahuje datovou položku a položky jsou uspořádány tak, že všechny cesty z listů do kořenu prochází uzly, které jsou v pořadí uspořádání a to buď neklesajícím (max-heap), nebo nerostoucím (min-heap). Operace \emph{prosívání} hromady je odstranění kořene a znovu uspořádání uzlů, aby tvořily hromadu. Kořen se pak porovnává se svými potomky a aby bylo dosaženo uspořádání, mohou se vyměnit (maximálně však $\lceil \log_2 n \rceil$ výměn -- výška stromu).  Jednoduché uložení v poli bez ukazatelů.

\subsection{Adaptivní Huffmanovo kódování}
V praxi nejsou četnosti symbolů známé. \emph{Semiadaptivní} metoda je dvouprůchodová (první čte frekvence, druhý kóduje).

Začít s prázdným stromem a postupně jej upravovat. Modifikace musí být stejné na straně kompresoru i dekompresoru (jsou synchronní, pracují provázaně -- lockstep, nebo zrcadlení).

První symbol se zapíše na výstup v nekomprimované formě, přidá se do stromu a přiřadí se mu kód. Další nález použije již tento kód a inkrementuje jeho frekvenci. Pokud již není Huffmanův strom (nejlepší), musí se přeuspořádat.

Rozeznání (většinou) ASCII hodnoty symbolu a komprimovaného kódu? Před každý nekomprimovaný symbol se vloží speciální symbol (escape sekvence). Escape sekvence je také ve stromě s nulovou frekvencí (nejdelší kód).

\paragraph{Úpravy stromu}
Po každém vstupu symbolu ověření, zda v jednotlivých úrovních jsou frekvence uspořádány v neklesajícím pořadí zleva doprava a zdola nahoru (levý dolní uzel má nejnižší frekvenci -- vlastnost sourozenců).

Operace: Porovnej X s následníky ve stromu (zleva doprava, zdola nahoru). Je-li větší, vyměň je (nesmí se vyměnit s rodičem). Je-li X kořen, končíme, jinak cyklus opakujeme s rodičem.

\paragraph{Přeplnění čítače} se může stát pro dlouhé vstupy. Možnosti: Rescale (změna měřítka) všech čítačů (podělení 2) -- snižuje přesnost a nový strom nemusí být Huffmanův. Více reflektuje nedávné symboly, než ty v dávné minulosti.

\paragraph{Přeplnění kódu}
Když se do stromu přidá mnoho symbolů a ten je pak zbytečně vysoký -- potřeba omezení délky kódu pro kodér. Není problém pro dekodér

\paragraph{Varianta adaptivního Huffmanovy metody}
Jednodušší, ale méně efektivní. Přiřazení kódů náhodně (stejná pravděpodobnost) a strom upravovat podle opravdové pravděpodobnosti vyskytujících se symbolů -- nemusí měnit strom, pouze vyměňovat uzly.

Problém přeplnění počítadla symbolů -- opět vydělit všechna pole 2 po přečtení maxima symbolů.

\section{Aritmetický kód}
Huffmanova metoda produkuje nejlepší kódy pro jednotlivé symboly. Ale ideálné kódy vytváří pouze když symboly mají pravděpodobnost výskytu záporné mocny 2. Aritmetické kódování přiděluje jeden kód celému vstupnímu souboru.

Metoda začíná s určitým intervalem, čte vstupní soubor symbol za symbolem a používá pravděpodobnosti jednotlivých symbolů k zužování intervalu. To vyžaduje větší přesnost a tak číslo postupně roste. Symbol s vysokou pravděpodobností zmenší interval méně než symbol s nízkou pravděpodobností.

Interval je určen dolní a horní mezí, nebo jednou mezí a šířkou. Výstup lze interpretovat jako číslo z intervalu $[0, 1)$.

Nejdříve je potřeba spočítat nebo odhadnout frekvence výskytů jednotlivých symbolů.
\begin{enumerate}
	\item Začneme definování aktuálního intervalu jako $[0, 1)$\\
	Low = 0; High = 1;
	\item Opakujeme následující dva kroky pro každý symbol vstupního toku:
	\begin{enumerate}
		\item Rozdělím aktuální interval na podintervaly, jejichž velikosti jsou proporcionální pravděpodobnostem symbolů
		\item Vybereme podinterval pro s a prohlásíme ho za nový aktuální interval\\
		NewLow = OldLow + Range * LowRange(X)\\
		NewHigh = OldLow + Range * HighRange(X)
	\end{enumerate}
	\item Výstupem je nějaké číslo, které jednoznačně identifikuje aktuální interval (uvnitř aktuálního intervalu).
\end{enumerate}
Dekodér musí znát symboly a frekvence použití pro kódování -- potřeba také předat jako tabulku. Dekódování probíhá následovně:\\
Code = (Code - LowRange)/Range

Problém s intervaly v 0 -- potřeba definice konce souboru (eof s nízkou frekvencí), abychom mohli rozeznat symboly, které obsahují všechny stejné symboly (nebo na ně končí). Pokud je délka řetězce známa, můžeme pracovat bez EOF symbolu.

Implementační detaily: Čísla s neomezenou přesností jsou nepraktická. Implementace pomocí celočíselné aritmetiky (Low=0000, High=9999). Pokud jsou meze blízko sebe, provedeme shift doleva (vygenerujeme výstupní symbol) a zprava nasuneme 0 pro Low a 9 pro High.

Dekódování:
\begin{enumerate}
	\item Vypočítej index ((Code - Low + 1) x 10 - 1)/(High-Low) a odsekni k nejbližšímu celému číslu
	\item Použij index k nalezení následujícího symbolu pomocí porovnávání se sloupcem kumulovaných pravděpodobností
	\item Aktualizuj Low a High podle vztahu\\
	Low = Low + (High - Low + 1) LowCumFreq[X]/10\\
	High = Low + (high - Low + 1) HighCumFreq[X]/10 - 1
	\item Pokud jsou nejlevější číslice Low a High shodné, posuň Low, High a Code o jednu pozici doleva. Do Low vstoupí zleva 0, do High 9 a do Code příští vstupní číslice z komprimovaného toku.
\end{enumerate}

Podtečení: Pokud se Low a High přibližují, ale nemají stejné první číslice (4999, 5000). Ztrácí se významové číslice. Řešení: Detekovat a změnit měřítko (vytlačit druhou největší významovou číslici v Low a High). Dokud se neshodují, posouváme a poté zapíšeme 4 následovanou řadou 9, nebo 5 následovanou řadou 0, podle počtu posuvů.

Komprese je velmi blízká entropii (např. v binárním kódu)

\subsection{Adaptivní aritmetické kódování}
Ukládání kumulovaných frekvencí a jejich změny po každém kroku. Pořadí symbolů v tabulce je možné měnit, pokud to kodér i dekodér dělají stejným způsobem. Model musí být upraven až po zakódovány symbolu, aby dekodér mohl zrcadlit chování kodéru.

Struktura pro uložení: Nevyvážený binární strom usídlený v poli.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Slovníkové metody} \label{cha:36}
2. semestr, KKO, \texttt{KKO3-16-QM-PPM-CTW.pdf}, \texttt{KKO4-1-LZ77.pdf}

(LZ77, LZ78, práce se slovníkem, pohyblivé okno, prodlužování položek)
 
\emph{Komprese textu} -- slovníkový (nepoužívá statistický model) nebo statistický princip (modelovací + kódovací stupeň)

\paragraph{Statistické metody}:
Kontext -- minulý text, který znají jak kodér tak dekodér. Posledních N symbolů používaných k predikci (Markovský model řádu N), např. PPM (Prediction with Partial String Matching), nebo Burrows-Wheelerova transformace používají statistické metody. PPMZ (nedeterministické kontexty).

\paragraph{Slovníkové metody} vybírají řetězce symbolů a pomocí slovníku zakódují každý řetězec jako značku (token). Slovník může být statický nebo dynamický (adaptivní metody -- přidávání a mazání).

Slovníkové metody jsou entropické kodéry, jsou univerzální. Například slovník anglických slov (velikost $2^19$ a jeden bit je značka, pokud slovo ve slovníku není, pak je v obsahu délka a za ní následuje dané slovo v ASCII).

\emph{Adaptivní metody} začnou s prázdným slovníkem, nebo malým.

Komprese řetězců  může být účinnější než komprese jednotlivých symbolů (lze ukázat na pravděpodobnosti).

\subsection{Jednoduchá slovníková komprese}
dvouprůchodová
\begin{enumerate}
	\item První průchod sestaví seznam všech různých nalezených bytů a jejich četnost.
	\item Uspořádáme seznam v sestupném pořadí (max 256 položek)
	\item Seznam je slovník a zapíše se do komprimovaného souboru, kterému předchází jeho délka.
	\item Zdrojový soubor se znovu přečte a pro každý byt se vyhledá jeho index. Ten se zapíše do výstupního souboru s prefixem jeho délky (3b).
\end{enumerate}
Dekompresor přečte délku slovníku, slovník a poté každý byte dekóduje na základě 3-bitového kódu délky a hodnoty indexu.

Pro uniformní rozložení je komprese 0.9375 + 257 b pro slovník, ale pro běžné příklady je kolem 0.5.

\section{LZ77 (pohyblivé okno)}
(LZ1). Levá část okna je aktuální slovník a obsahuje symboly, které vstoupily v poslední době. Část vpravo je předvídací buffer (look-ahead buffer) s textem, který se teprve bude kódovat. V praxi levá část několik tisíc bajtů a předvídací buffer pouze několik desítek.

Kóder prohlíží vyhledávací buffer zprava doleva a vyhledává shodu s prvním symbolem v předvídacím bufferu. Pokud nalezne, hledá shodu v co nejvíce symbolech následujících za těmito výskyty, pokud mají stejnou velikost, tak vybere poslední a připraví značku (offset, délka, následující symbol).

Modifikace LZH vybírá první (nejbližší) výskyt, který vede k menším offsetům a teoreticky kratším kódům (huffmanovo kování).

Pokud se zpětným prohledáváním nenalezne shoda, zapíše se značka s nulovým offsetem i délkou.

Offset většinou 10-12 bitů (vyhledávací buffer), Délka několik bitů (předvídací buffer, protože může volně přecházet i z vyhledávacího), Symbol většinou 8 bitů. 

Dekodér jednodušší (asymetrické kompresní metoda). Udržuje buffer s velikostí rovnou oknu kodéru. Dekodér načte značku, najde ve svém bufferu shodu, zapíše shodu a třetí pole do výstupního toku, posune shodu + třetí pole do bufferu. Vhodné pro častou dekompresi.

Optimalizace vyhledávacího bufferu kruhovou frontou, nebo hashovací tabulkou.

\subsection{LZSS}
Udržování předvídacího bufferu v kruhové frontě, vyhledávací buffer (slovník) v binárním vyhledávacím stromu (levý podstrom menší hodnoty, pravý větší), vytváří značky pouze se dvěma poli.

Ve stromě jsou záznamy o délce předvídacího okna (vyhledávací okno - předvídací okno + 1). Vyhledání této shody trvá $\lceil \log_2 n \rceil$ kroků. Pokud se celý řetězec shoduje, kodér se pokusí nalézt další shodu.

Aktualizace stromu odstraněním řetězců \uv{ze začátku} a přidáním nových. Potřeba hlídat tvar (vyvážený x šikmý).

Pokud se nenajde žádná shoda, je poslána značka s příznakem znaku (např. pro následujících 8 značek).

Nedostatky: Omezený kontext (pokud se slovo vyskytovalo dříve, je zapomenuto). Omezená velikost předvídacího bufferu vede k omezení délky shody. Rozšíření je náročné (dlouhé značky, pomalá komprese).

\subsection{LZX}
Varianta LZ77, jiný způsob kódování offsetů shody, které mohou být velké. Použití v CAB souborů MS. Značky jsou buď neztotožněné znaky, nebo dvojice (offset, délka). Kódy s proměnnou délkou (kanonické Huffmanovy stromy).

Opakované offsety -- speciální kódy pro poslední 3 použité offsety (LRU fronta). Předzpracování pro x86 instrukce CALL (relativní na absolutní). Výstupní formát jsou bloky dat.

Diferencování souborů: VCDIFF -- LZ77 na původním souboru a poté na připojeném modifikovaném. Pro druhý soubor je komprese velmi efektivní -- původní soubor je již ve vyhledávácím bufferu. Je-li soubor příliš velký na vyhledávací buffer, je potřeba oba soubory segmentovat. Instrukce ADD (přidat nové znaky), RUN (opakování n stejných znaků), COPY (stejný jako původní soubor, kolik kopií)

\section{LZ78 (LZ2)}
Nepoužívá vyhledávací buffer, předvídací buffer, ani pohyblivé okno. Pouze slovník dříve nalezených řetězců. Značky mají dvě pole -- ukazatel do slovníku a kód symbolu.

Slovník má prázdný řetězec na pozici 0, na další pozice se ukládají přečtené slova. Když se řetězec nenajde, pošle se (0, x), když najde, zkusíme najít také následující znak y, pokud ten nenajdeme, pošleme (37, y) (kde 37 je ukazatel na slovo \uv{x} ve slovníku) a řetězec xy se přidá do slovníku.

Vhodnou strukturou je strom (Trie), kde řetězec je cesta od kořenu po list. Teoreticky každý list až 256 potomků (dynamická struktura).

Co dělat, pokud strom zaplní paměť není specifikováno metodou, ale jsou různé možnosti:
\begin{itemize}
	\item Zmrazení slovníku -- nepřidáváme žádné nové uzly -- statický slovník
	\item Odstranění stromu a začátek znovu -- rozdělení vstupu na bloky s vlastním slovníkem (předpoklad použití nových dat a ne starých).
	\item Odstranění nějakých dlouho nepoužívaných položek (jak dobře určit?)
\end{itemize}

Dekodér udržuje slovník stejným způsobem jako kodér a proto je složitější než u LZ77.

\subsection{LZFG}
Kodér generuje komprimovaný soubor se značkami a literály (ASCII) promíchaně. Značka \emph{literal} indikuje, že následuje řetězec literálů, značka \emph{copy} značí následující řetězec (délka), dříve v datech nalezený (offsef, vzdálenost).

Metoda A1 -- 8-bitová značka literal (0000nnnn -- udavájící počet ASCII bytů + 1) a 16-bitová značka copy (sssspp \dots p, kde s nenulové 4-bitové pole určuje délku řetězce + 1 a p označuje offset + 1).

Metoda A2 má delší vyhledávací buffer až 21 kB -- kódy s proměnnou délkou.

\paragraph{LZRW1}
Jednoduchá a rychlá varianta LZ77, navazuje na LZFG A1. Nalezení shody v jednom kroku pomocí hashovací tabulky.

\paragraph{LZRW4}
Kombinace slovníkových metod s predikcí.

\paragraph{LZW}
odstraňuje druhé pole ze značky. Patentována a licencována. Slovník je inicializován pro všech 256 osmibitových znaků.

\paragraph{Deflate} je založena na variantě LZ77 s Huffmanovým kódem (použití v Zip).

\paragraph{LZMA} je rozšíření LZ77. Formát 7-Zip podporuje různé kompresní algoritmy včetně Deflate, LZMA. LZMA používá intervalové kódování (celočíselná verze aritmetického kódování).


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Informace a entropie, Shannova věta o kódování.} \label{cha:37}
2. semestr, KKO, \texttt{KKO3-1-STATISTICKE METODY-TI-UNARNI2016.pdf}\\
2. semestr, PDS, \texttt{pds-01-teorie-16.pdf}

Data jsou řetězec s výskyty n symbolů $a_1$ až $a_n$. Taková množina je \emph{abeceda} s n symboly. Protože existuje n symbolů, můžeme každý pokládat za číslici se základem $n$, což je ekvivalentní $\log_2 n$ bitů.

$H = s \log_2 n$ označíme \emph{objem informace (entropie)}, měřený v bitech přenesený za jednotku času. Symbol $a_i$ se vyskytuje s pravděpodobností $P_i$ a součet pravděpodobností je 1. Tedy $1=\sum P_i = nP$, $P = 1/n$ a $H = -s \log_2 P$. Čím je rozdělení pravděpodobností méně pravidelné, tím je entropie nižší (a tedy obsah informace).

Entropie klávesnice je 7 bitů na znak (96 možností), anglického korpusu 4,5, zakódování v Huffmanově kódu 4,7. Pokud se zaměříme na osmice znaků (vlastnost sousedství), entropie vychází asi 19 bitů, tedy 1,3  bitů na znak (\emph{mez bezztrátové komprese angličtiny}).

Redundance dat $R$ je definována jako rozdíl mezi nejvyšší možnou entropií množiny symbolů a jeho skutečnou entropií, tedy
$$R = \left[ - \sum\limits_1^n P \log_2 P \right] - \left[ - \sum\limits_1^n P_i \log_2 P_i \right] = \log_2 n + \sum\limits_1^n P_i \log_2 p_i $$
Pro zcela komprimovaná data (bez redundance) je tedy $R=0$.

\textbf{Zpráva s $n$ symboly se může komprimovat na $nH$ bitů, ale ne více.}

\subsection{Obsah algoritmické informace}

Kolmogorov-Chaitinova složitost (KCC) definuje složitost binárního řetězce jako délku (v bitech) nejkratšího počítačového programu, který při spuštění vygeneruje S (algoritmický informační obsah).

Algoritmický informační obsah je míra obsahu informace ve zprávě.

Součet Shannonovy informace a KCC je konstantní.

\section{Teorie informace (PDS)}
Komunikace: Zakódování -- Přenesení zprávy -- Dekódování zprávy (znalost kódu)

Shannon: Zdroj -- Kodér -- Přenosový kanál -- Dekodér -- Cíl

Důležitá pravděpodobnost $P(x = a_n) = P(x) = P(a_n)$, že nastane jev $a_n$. Součet pravděpodobností všech možných jevů je 1.

\paragraph{Množství informace}: Méně pravděpodobná zpráva/symbol nese větší množství informace. Funkce $I(x)$ -- množství informace k pravděpodobnosti $P(x)$ výskytu zprávy $x$.

Méně pravděpodobná zpráva nese více informace: $P(x) > P(y) \Rightarrow I(x) < I(y)$, množství informace dvou nezávislých informací je jejich součet $I(xy) = I(x) + I(y)$.
$$I(x) = \log_2 \frac{1}{P(x)}$$
jednotkou je shannon [Sh].

\subsection{Entropie}
nepředvídatelnost, neurčitost náhodného jevu. K vyjádření očekávaného množství informace. Jevy s nízkou entropií můžeme jednodušeji předvídat. Pro úplný náhodný jev $X$:
$$H(X) = \sum_{x \in A_x} P(x) log_2 \frac{1}{P(x)}$$
Maximální entropie je při uniformní pravděpodobnosti (nepředvídatelné), nejmenší pokud má jedna z možností pravděpodobnost 100\%.

Klasický text má nízkou entropii, proto je dobré jej zkomprimovat, před šifrováním -- je těžší rozluštit.

\paragraph{Podmíněná entropie}
Pokud známe hodnotu náhodného jevu X, změní se entropie náhodného jevu Y?
$$H(Y|X) = \sum\limits_{i=1}^n P(x_i) H(Y|X = x_i)
= - \sum\limits_{i=1}^n P(x_i) \sum\limits_{j=1}^m P(y_j, x_i) log_2 P(y_j, x_i)
= - \sum\limits_{i=1}^n \sum\limits_{j=1}^m P(x_i, y_j) log_2 P(y_j, x_i)$$

Entropie má úzký vztah k reprezentaci informace. Kódování komprimuje informace do co nejmenšého počtu bitů, nebo pro opravu chyb při přenosu zprávy. Entropii lze použít k zjištění minimálního počtu bitů pro přenos informace, výpočtu redundance, účinnosti a propustnosti přenosového kanálu.

\paragraph{Kódování} přiřazuje zprávám jedné abecedy, zprávy druhé abecedy (matematicky zobrazení). \emph{Prefixový kód} lze jednoznačně dekódovat bez oddělovacích značek.

\paragraph{Huffmanův kód}: Symbolům s větší pravděpodobností přiřazujeme kratší zprávy.
Délka zprávy: $L = \sum_{i=1}^n P(x_i)l(x_i)$, účinnost kódu: $\mu = \frac{H(X)}{L}$, redundance $r = 1 - \mu$.

\paragraph{Přenosový kanál} -- informace jde od zdroje k cíli přes tento kanál. Může mít různou přenosovou rychlost, chybovost.
\begin{itemize}
	\item Kanál bez paměti: přiřazuje prvkům z abecedy X prvky z abecedy Y bez závislosti na předchozích výskytech: $P(y_i|x_i) = 1$ -- při přenosu symbolu x bude vždy dekódován odpovídající symbol y.
	\item Přenosový kanál s chybami -- Přidáme do schématu šum. Podmíněná pravděpodobnost chyby $P(y_1, x_2)$, $P(y_2, x_1)$. Může se stát, že bude přeneseno y.
	\item Obecný kanál bez paměti -- můžeme popsat pomocí matice pravděpodobností -- na diagonále přenos bez chyb, ostatní jsou chyby:
	$$K = 
	 \begin{pmatrix}
	  P(0|a) & P(0|b) \\
	  P(1|a) & P(1|b) \\
	 \end{pmatrix} =
	 \begin{pmatrix}
	  0.9 & 1-0.7 \\
	  1-0.9 & 0.7 \\
	 \end{pmatrix}$$
\end{itemize}

\paragraph{Kapacita přenosového kanálu}: zdroj zasílá r zpráv za sekundu. Entropie je H bitů za zprávu. Rychlost informace je $R = r \cdot H$. Kapacita kanálu je $C$. Pokud $R \leq C$ přenos může být uskutečněn bez chyby i pokud kanál obsahuje šum. Pokud $R > C$ nemůžeme se vyhnout chybě při přenosu.

\paragraph{Propustnost kanálu $c$} je největší množství informace za znak, které může kanál přenést. Kapacita kanálu $C$ je největší množství informace, které kanál ,§že přenést za jednu sekundu.


\section{Shannova věta o kódování}

Má-li diskrétní kanál kapacitu $C > 0$, pak použitím dostatečně dlouhých kódovaných úseků lze produkce informace $H'(X) < C$ libovolně přiblížit k $C$ a přitom učinit pravděpodobnost chyby libovolně malou. 

\begin{itemize}
    \item Rychlost produkce informace: $H'(X) = H(X) / T$
    \item $H(X)$ -- množství informace připadající v průměru na jeden symbol
    \item $T$ -- průměrný čas vysílání jednoho symbolu: $T = 1 / v_m$
    \item $v_m$ -- modulační rychlost
\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Bezpečnostní kódy: lineární, Hammingovy, cyklické, konvoluční. Detekce a oprava chyb.} \label{cha:38}

\section{Bitové chyby}
Děje se na L1, řešena v rámci L2. Korupce bitů. Nejčastější je bitová inverze. Většinou řešíme redundancí.

\paragraph{Důvody vzniku chyb}: šum a útlum.
Spolehlivost $BER = \frac{\text{počet chybných bitů}}{\text{celkový počet přenesených bitů}}$ (reálný parametr spolehlivosti linky),
$p_e = \approx BER$ je odhadovaný.

\section{Blokové bezpečnostní kódy}
Fixní množství bloků a zabezpečení bloků je na sobě nezávislé.

Blok $k$ (datových) bitů je zakódován pomocí $n$ bitů (kódové slovo). Kód obsahuje $n-k$ bitů redundance a označujeme je jako $(n, k)$ kódy.

\paragraph{Parita} je blokový kód $(k+1, k)$. Redundantní bit je přidán tak, aby celkový počet 1 v kódovém slovu byl sudý (sudá parita) nebo lichý (lichá parita). Při detekci nedokážeme opravit chybu.

\paragraph{Složená parita} datové bity seřadíme do pole a spočteme paritní bit pro každý sloupec a řádek. Lze detekovat dvě chyby na řádku/sloupci a dokážeme opravit jednu chybu.

\subsection{Hammingovy kódy}
Kódová slova musí být natolik odlišná, aby se zamezilo transformaci chybového kódového slova na správné. Tuto odlišnost nazýváme \emph{Hammingova vzdálenost} -- minimální počet bitů, který je třeba změnit, aby se jedno kódové slovo transformovalo na druhé. Budeme označovat $d_{min}$.

Počet špatně přenesených bitů menší než $d_{min}$ jsme schopni detekovat ($d_{min} - 1$). Pokud chceme \emph{detekovat} $E$ chyb, $d_{min} = E+1$, pokud chceme \emph{opravit} $E$ chyb, vzdálenost musí být $d_{min} = 2E + 1$.

\paragraph{Perfektní kódy} (perfect codes) -- obsahují nejmenší počet redundantních bitů, pokud chceme opravit 1 bitovou chybu. Obecně tedy $c \geq \log_2(n+1)$ redundantních bitů pro kódová slova délky $n$. Pro optimální kód je také $c$ minimální.

\paragraph{Základní Hammingův kód (7,4)} paritní bity jsou na pozicích mocniny 2 (tedy 1, 2, 4). Paritní bit na pozici $b_{2^l}$ kontroluje všechny $b_{p'}$, jejichž binárně zapsaná bitová pozice $p$ má na 1 na pozici $l$. Součet pozic chybných paritních bitů určuje pozici chyby.

\subsection{Polynomiální reprezentace}
Řetězec k+1 bitů lze chápat jako číslo, nebo jako polynom $a_kx^k + a_{k-1}x^{k-1} + \dots + a_1x + a_0$ či vektor $(a_k, a_{k-1}, \dots, a_1, a_0)$. Aritmetika modulo 2 (nedochází k přenosům a výpůjčkám) -- operace odpovídají XOR (sčítání, dělení).

\paragraph{Generátor} musí používat oba, odesílatel i příjemce stejný. Generující polynom $g(x)$ o stupni $n$ je polynomiálním zápisem generátoru.

\paragraph{Galoisovo těleso $GF(q) = (M, +, \cdot, 0, 1)$}: Prvočíslo $p$ a přirozené číslo $n \geq 1$ existuje (až na izomorfismus jednoznačné) těleso o $p^n$ prvcích. $GF(p^n) = GF(q)$, kde $q = p^n$ lze složit z více $GF(p)$ (nerozložitelný polynom).

Primitivní prvek $\alpha$ je generátor grupy $(F^*, \cdot, 1)$, kde $F^*$ jsou všechny nenulové prvky. $G(x)$ s koeficienty v $GF(q)$ má $q$ kořenů a $g(x)$ je nerozložitelný a aspoň jeden takový vždy existuje.

Je-li $\alpha$ kořenem $g(x)$ v $GF(q)$, pak platí, že $\alpha^0 = \alpha^q = 1, \alpha^2, \alpha^3, \dots, \alpha^{q-1}$ jsou také kořeny $g(x)$. Pro $g(x)$ lze kořeny zapsat i formou matice (vektoru): $H = [a^0, a^1, a^2, \dots, a^{q-1}]$. Označíme-li bitovou reprezentaci zabezpečené zprávy jako $z$, pak lze ověření úspěšného přenosu chápat jako řešení rovnice $z \cdot H^T = 0$.

Polynom je nerozložitelný, je pokud polynom nelze rozložit na součin jednodušších polynomů.

\subsection{Lineární kódy}
Kódové slovo uvažujeme jako vektor. Kódová slova lineárního kódu vytvářejí lineární prostor $L \subseteq GF^n(2)$. Pro kódová slova $x, y \in L$ a $\alpha \in GF(2)$ platí $x+y \in L$ a $\alpha \cdot x \in L$.

Každý lineární prostor lze popsat několika navzájem nezávislými vektory tohoto prostoru (\emph{báze lineárního prostoru} -- generující vektory). Ostatní vektory lze získat lineární kombinací těchto nezávislých vektorů.

Matice složenou z generujících vektorů nazýváme \emph{generující matice} G. Má $n$ sloupců (počet znaků kódového slova) a $k$ řádků ($2^k$ kódových slov). $n > k$. Lineární blokový kód zapisujeme $(n, k)$.

\paragraph{Symetrický kód} je generován pomocí matice tvaru $G = [I_k|P]$, kde $i_k$ je jednotková matice $k \times k$ a $P$ je obecná matice $k \times (n-k)$. Tento kód má rozdělená místa ve značce na $k$ informačních a $n-k$ zabezpečujících bitů.

\paragraph{Kontrolní matice} $H$ je generující matice prostoru $L'$, který je duální k prostoru $L$, generovanému maticí $G$. Tento prostor je tvořen vektory, které jsou ortogonální (kolmé) k vektorům prostoru $L$. Tedy: $G \times H^T = 0$, $x \times H^T = 0, x \in G$ a lze ji odvodit z G: $H = [P^T|I_{n-k}]$.

\subsection{Hammingovy kódy}
Pro základní Hammingův kód $(7, 4)$ použijeme těleso $GF(2^3)$, tedy $GF(8)$. Ireducibilní polynom použijeme $\alpha = x^3 + x + 1$. Prvky jsou potom $a^z$ pro $z = 0, \dots 6$.

\subsection{CRC}
Vhodně zvolený generující polynom ovlivňuje detekci chyb a to tak, že dokáže najít:
\begin{itemize}
	\item všechny 1 bitové chyby
	\item téměř všechny 2 bitové chyby
	\item všechny shluky až $m$ chyb, pokud $g(x)$ je stupně $m$.
\end{itemize}
Standardizováno několik polynomů (CRC-10, 12, 16, 32)

Řetězec datových bitů, které chceme zabezpečit chápeme jako číslo. Toto číslo vydělíme předem zvolenou konstantou a zbytek po dělení připojíme k datovým bitům jako jejich zabezpečující část.

(polynomiální reprezentace) $z(x)$ je zpráva, $g(x)$ je generující polynom, $r(x)$ je zbytek po dělení stupně $\leq n$, $t(x)$ je $(n+k)$-bitová zpráva zabezpečená CRC, \^{t}$(x)$ je zabezpečená zpráva jak ji přijme příjemce.
\begin{enumerate}
	\item Rozšíříme $z$ o $n$ bitů zprava (přidáme 0), získáme $n+k$ bitů ($z(x) \cdot x^n$)
	\item Spočítáme $x^n z(x): g(x)$, kde zbytek $r$ po dělení jsou CRC zabezpečující bity přenášené zprávy
	\item Odečteme zbytek po dělení od $x^n z(x)$ a výsledek $t(x) = x^n z(x) - r(x)$ odešleme
	\item Příjemce provede kontrolu přenosu tím, že \^{t}$(x):g(x)$ a pokud zbytek $r(x)$ odpovídá 0, byla zpráva přenesena bez bitových chyb.
\end{enumerate}

\section{Proudové bezpečnostní kódy}
Zabezpečený bit po bitu, kování následujícího bitu závisí na hodnotě určitého množství bitů předchozích.

\subsection{Konvoluční kódování}
Rekurentní i nerekurentní kódy. Pro linky s dostatečnou šířkou pásma (velká redundance) a s výskytem pouze Gaussovského šumu (satelitní spojení). Implementace pomocí posuvných registrů.

\begin{description}
	\item[Rekurentní konvoluční kodér] -- závislý na hodnotě předchozího výstupu
	\item[Nerekurentní konvoluční kodér] -- není závislý na hodnotě předchozího výstupu. Každý výstup lze popsat generujícím polynomem. Koeficient $a_0$ je aktuální vstup, $a_i, i > 0$ pak propojení na posuvný registr, kde $i$ vyjadřuje jeho pořadí (zpoždění).
\end{description}

Způsob reprezentace:
\begin{itemize}
	\item Konečný automat: Stavy odpovídají stavu posuvných registrů, přechody pak funkcí vstupu/výstupu
	\item Stromová struktura:
	\item Trellis diagram: Varianta KA rozvinutá v časové rovině (zobrazeny stavy pro čas $t$ a $t+1$), vrchní hrana odpovídá přechodu přes 0, spodní pak přes 1\\
	Dekódování: Viterbiho algoritmus:
	\begin{itemize}
		\item Pokud se dvě cesty střetnou v jednom stavu, tak si pamatujeme jenom tu s menší Hammingovou vzdáleností.
		\item Pokud mají stejnou vzdálenost a končí ve stejném stavu, jednu náhodně vyřadíme.
		\item Omezující délka: Počet posuvných registrů, jejichž obsah ovlivňuje aktuální výstup.
		\item Při dekódování se ze správnou považuje cesta s nejmenší kumulovanou Hammingovou vzdáleností dekódovaných bitůg.
	\end{itemize}
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Základní architektury přepínačů, algoritmy pro plánování, řešení blokování, vícestupňové přepínací sítě.} \label{cha:39}
2. semestr, PDS, \texttt{pds-05-switching-16.pdf}

Obecná architektura přepínače:
\begin{itemize}
	\item Line card
	\begin{itemize}
		\item Ingress Packet Processing -- vstup
		\item Fabric Input Interface -- rozděluje příchozí packety na buňky pevné délky pro přepínání
		\item Fabric Input Buffers -- ukládá data, pokud je není možné poslat do přepínací logiky
		\item Engress Packet Processing -- výstup
		\item Fabric Output Interface
		\item Fabric Output Buffers
	\end{itemize}
	\item Switch Fabric card
	\begin{itemize}
		\item Switch Fabric -- dynamicky propojuje síťová rozhraní a přenáší data mezi nimi, pomocí přepínacích obvodů nebo sběrnic.
		\item Scheduler -- plánuje přepínání dat ze vstupu na výstup.
	\end{itemize}
\end{itemize}

\paragraph{Požadavky}: maximální přenos dat přepínací logikou, paralelní přenosy mezi různými síťovými rozhraními, spravedlivé přidělení přenosového pásma a zachování pořadí paketů.

\paragraph{Problémy}: Vnitřní blokování, soutěžení o výstupní port, blokování fronty HOL (Head of Line) a přenos multicastu.

\paragraph{Metriky pro měření činnosti přepínače}:
\begin{itemize}
	\item Propustnost -- množství dat přenesených za jednotku času
	\item Latence -- doba přenosu paketu ze vstupního na výstupní rozhraní
	\item Počet dostupných cest -- v přepínací logice, které propojí každou dvojici vstupních a výstupních portů.
\end{itemize}

\section{Základní architektury přepínačů}
Klasifikace přepínačů: Propojovací deska:
\begin{itemize}
	\item Přepínače se sdílenou propojovací deskou (shared backplane)
	\begin{itemize}
		\item Přepínače se sběrnicí (shared bus)\\
		Sdílené přenosové médium, přenosy řízeny Bus protokolem. Potřebná propustnost $R \times N$ (šířka $w = \frac{R \times N}{r}$\\
		Pro zařízení s propustností do 1 Gb/s\\
		Nativní implementace broadcast, multicast, pouze jeden port může v jeden okamžik komunikovat.
	\end{itemize}
	\item Přepínače s přepínanou propojovací deskou (switched backplane)\\
	Paralelní přenos paketů, buňky pevné délky, potřeba plánovače (detekce buněk na vstupu, plánování přenosu, přenos buněk)\\
	Plánovač: Párování portů, Vnitřní blokování a virtuální fronty
	\begin{itemize}
		\item Jednostupňové přepínání (single stage fabric)
		\begin{itemize}
			\item Přepínače se sdílenou pamětí (shared memory)\\
			Centrální sdílená paměť, Fronty pro výstupní porty.\\
			Potřebná rychlost přístupu do paměti: $W = 2 \times N \times R$, doba zápisu/čtení buňky: $t = \frac{C}{BW}$\\
			přístupová doba SDRAM je 5 -- 10 ns (32 portů, 1 GB/s)
			\item Křížový přepínač (crossbar switch)
			$N^2$ propojení (on/off -- např. tranzistory, interně neblokující, nativní podpora multicastu, jednoduchá implementace, centrální plánovač propojení každé linky.\\
			Problém rozšířitelnosti, kolize (různé vstupy požadují stejný výstup, obtížné QoS, redundance
		\end{itemize}
		\item Vícestupňové přepínání (multi stage fabric)
		\begin{itemize}
			\item Přepínací síť Clos (Clos network)
			\item Přepínací síť Beneš (Beneš network)
		\end{itemize}
	\end{itemize}
\end{itemize}

\section{Plánovací algoritmy}
Algoritmy: Přidělení lístků, PIM, iSLIP

Problém párování v crossbar switch: Bipartitní graf $G=(X\cup Y, E)$. Uzly: Vstupní porty $X$, Výstupní porty $Y$, Hrany: propojení (požadavky na přenos) $E$. Hledáme párování $M \subseteq E$, kde žádné dvě hrany nemají společný vrchol.
\begin{description}
	\item[Největší] (maximum matching): párování, které má největší počet hran.\\
	Globální maximum s největší propustností, nebezpečí vyhladovění. Složitost $\mathcal{O}(N^\frac{5}{2})$ či $\mathcal{O}(N + E)$.
	\item[Maximální] (maximal matching): Párování, k němuž nelze přidat další hranu.\\
	Lokální maximum
\end{description}

\subsection{Algoritmus přidělení lístků}
Výstupní port obsahuje frontu požadavků na propojení. Požadavek na vstupu dostane od $Q$ číslo $T_{QX}$ na obsloužení portu $Q$ s pořadím $X$. Výstupní porty jsou přiděleny žádostem s nižším $T_{QX}$.
\begin{enumerate}
	\item Žádost o lístek
	\item Přidělení lístku
	\item Propojení vstupů a výstupů, přenos (Connect \& Transfer)
\end{enumerate}
Asynchronní zpracování, přenos rámců různé délky, blokování na začátku fronty. Nezávislé přidělování lístků je problém u multicastu.

Blokování začátku fronty -- řešení: Rozdělení vstupní fronty na více front podle cílových portů, virtuální fronty. ($N^2$ virtuálních front)

\subsection{Algoritmus PIM (Parallel Iterative Matching)}

Hledá párování pomocí náhodného výběru, virtuální fronty a soutěžení o porty (výstupní -- více žádostí na jeden výstup; vstupní -- více povolení pro data na jednom portu).
\begin{enumerate}
	\item Žádost o port -- vstupní port $p$ posílá žádosti ze všech front na všechny cílové porty
	\item Udělení portu -- výstupní port $Q$ přidělí právo přenosu. V případě více žádostí o port $Q$, vybere náhodně jednu žádost.
	\item Přijetí a přenos -- vstupní port zpracuje udělená povolení k přenosu. V případě udělení více povolení, náhodně vybere jedno a přenese data.
\end{enumerate}
Optimalizace pomocí více iterací. Problém generování náhodných čísel. Průměr $\mathcal{O}(\log_2 N)$. Obecně variabilní počet iterací, v praxi pevně dané.

\subsection{Algoritmus iSLIP}
Iterativní algoritmus pro hledání maximálního plánování. Při soupeření o port používá rotující ukazatele (vstupních $I_i$ a výstupních portů $O_j$), které se po každé iteraci inkrementují -- určují prioritu portů (po potvrzení žádosti)
\begin{enumerate}
	\item Žádost o port -- každý port pošle žádost na každý výstupní port
	\item Udělení portu -- výstupní port $Y$ vybere žádost, která má číslo portu větší nebo rovno ukazateli $O_j$. V případě více žádostí se vybere to s nejmenší hodnotu
	\item Přijetí -- Vstupní port $X$ vybere povolení od portu, které je větší nebo rovno ukazateli $I_j$. V případě více povolení se vybere to s nejmenší hodnotou.
\end{enumerate}
Více iterací. Deterministické plánování a velká propustnost.

\section{Vícestupňové přepínání}

\emph{Jednostupňové}: U křížového přepínače -- problémy s kvadratickým nárůstem portů. Problémy s vnitřním blokováním, HOL, algoritmy hledání maximálního párování.

\emph{Vícestupňové}: Sítě Clos a Beneš: Vstup $\rightarrow$ více přepínaných obvodů $\rightarrow$ výstup. Obvody bez vstupního blokování, hledání interního bezkonfliktního propojení.

\subsection{Síť Clos(m, n, r)}
\begin{itemize}
	\item První stupeň: Rozdělí $n$ vstupů na menší skupiny
	\item Prostřední stupeň: propojí každý vstupní a výstupní přepínač
	\item $m$ různých cest mezi daným vstupním a výstupním portem
\end{itemize}

(Closův teorém) Síť je neblokující: Pokud platí $m \geq 2n - 1$, pak lze přidat nové propojení vstupu a výstupu bez překládání sítě.

Přepínač s $N$ porty potřebuje síť $(m, n, \lceil N/n \rceil)$. Pokud $n = \sqrt{N/2}$, pak minimální počet propojení je $5.76 \times N \times \sqrt{N}$. Počet propojení je stále lepší než křížový přepínač $N^2$.

Neblokující přepínač o 256 portech vyžaduje síť $(31, 16, 16)$ (drahé), nebo využít $m \geq n$ -- redukce prostředních přepínačů -- levnější, ale blokující.
Nebo provést přeskládání -- musí být rychlejší než přenos dat. Barvení hran v bipartitním multigrafu.

Clos(16, 16, 16): Třístupňový přepínací modul o velikosti 256 portů (Juniper, T-series, Cisco AR 9000). Složený z 16 x 3 přepínačů 16 x 16.

\subsection{Přepínací síť Beneš $BN_n$}
Modifikovaná síť Clos(2, 2, 1) s překládáním. Hierarchicky-rekurzivní konstrukce: $N=2^n$ vstupů, blok $N/2$ vstupních přepínačů $2\times 2$, prostřední část rekurzivních bloků $BN_{n-1}$, blok $N/2$ výstupních přepínačů $2 \times 2$. $2 \log_2 N - 1$ stupňů (bloků).

$BN_3$: $N = 8$ vstupů, 5 stupňů, Cisco CSR-1

\subsection{Přepínací síť Torus}
Decentralizované přímé přepínání -- každý uzel slouží jako vstup, výstup i přepínací uzel (přímá síť). $n$-dimenzionální síť uzlů $k_i$ s adresou $(a_1, a_2, \dots, a_n)$, každý uzel $k_i$ připojen dvěma cestami v každé dimenzi (2D torus). Použitelné pro rychlé sítě (nad 1 Tb/s). Existuje více cest mezi každými uzly.

\paragraph{Směrování v síti Torus}:
\begin{itemize}
	\item Náhodné (využijeme náhodný uzel
	\item Deterministické podle dimenze: Dimension-Order Routing (DOR)
	\item Zdrojové směrování (source routing) -- cesta se předpočítá ve zdrojovém uzlu.
\end{itemize}

Avici Terabit Switch Router (TSR) -- 3D torus, max. $14 \times 8 \times 5 = 560$ uzlů, kanál 10 Gb/s. Distribuované přepínání v každém uzlu. Snadná, rozšiřitelnost (přídavné moduly).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Základní funkce směrovače, zpracování paketů ve směrovači, typy architektur.} \label{cha:40}
2. semestr, PDS, \texttt{pds-06-routing-16.pdf}

\section{Popis směrovače}
Základní operace ve směrovači: Směrování (routing), Přeposílání paketů (packet forwarding).

\paragraph{Směrovací tabulka} (routing table): IP adresa cílové sítě (prefix) x sousední uzel (next hop). Optimalizovaná pro výpočet dynamických změn v topologii.

\paragraph{Přepínací tabulka} (forwarding table): IP adresa (prefix) x výstupní rozhraní x L2 adresa výstupního rozhraní (MAC). Optimalizovaná pro vyhledávání cílové adresy.

Základní operace při přeposílání
\begin{itemize}
	\item Validace hlavičky (formát, verze, délka, checksum)
	\item Kontrola TTL
	\item Přepočítání kontrolního součtu (checksum -- jedničkový 16-bitový doplněk součtu všech polí v lavičce zapsaný v inverzním kódu)
	\item Zpracování rozšířených voleb IP protokolu (timestamp, record route, strict source route)
	\item Vyhledání cesty datagramu (lokální doručení, unicast, multicast)
	\item Fragmentace (pokud je MTU výstupního portu menší než MTU vstupního
\end{itemize}

Pokročilé operace při přeposílání
\begin{itemize}
	\item Klasifikace datagramů -- třídění data
	\item Překlad NAT -- přepis položek v hlavičce paketu, udržování tabulky spojení
	\item Prioritizace provozu -- kontrola dalších hlaviček paketu
	\item Směrování -- Implementace směrovacích protokolů, udržování sousedství, aktualizace směrovací a přepínací tabulky
	\item Správa zařízení -- nastavení systémové konfigurace, vzdálená správa
	\item Monitorování zařízení
\end{itemize}

Typu směrovačů:
\begin{itemize}
	\item Páteřní směrovač (Core Router)\\
	součástí páteřní sítě ISP, vysoce agregovaný provoz -- tisíce menších sítí, vysoká rychlost přepínání, spolehlivost, 800 Gb/s -- 12,8 Tb/s
	\item Hraniční směrovač (Edge Router)\\
	na straně ISP připojuje zákaznické sítě -- velké přenosové pásmo (agregace zákaznického provozu z různých technologií -- kabel, xDSL, Ethernet, optika), podpora přístupových technologií, velké množství portů pro různé L2 technologie, 2 - 200 Gb/s
	\item Podnikový směrovač (Enterprise Router)\\
	Také L3 páteřní a distribuční přepínače, propojuje koncové systémy v podnikových sítích, množství portů, modularita, QoS, multicast a broadcast, bezpečnost (VPN, VLAN, filtrování). 40 Gb/s -- 12 Tb/s
\end{itemize}

Schéma směrovače:
\begin{itemize}
	\item Line cards\\
	Přepínání, správa front a provozu, paměť, analýza IP hlavičky, vyhledání výstupního rozhraní, připojen k základní desce (backplane)
	\begin{itemize}
		\item Port Card\\
		Implementace síťového rozhraní (Port Card), operace nad L2, statistiky o příchozím a odchozím provozu
		\item Ingress Packet Processing\\
		Input Network Interface, Forwarding Engine, Forwarding table
		\item Egress Packet Processing\\
		Queue Manager, Traffic Managed, Output Netowrk Interface
		\item Buffer Memory
	\end{itemize}
	\item Switch Farbic Card -- Backplane\\
	Propojuje síťová rozhraní -- sdílené nebo přepínané propojení, rychlost odpovídá přenosovému pásmu všech rozhraní. Páteřní přepínače obsahují více modulů
	\item Router Processor Card (Procesor pro směrování)\\
	Routing Table, Route Control Processor, Memory (Obecný CPU, specializovaný OS, velká paměť)
	
	Implementace směrování na obecném CPU, zpracování směrovací informace (aktualizace, udržování sousedství), obsluha směrovací tabulky, přenáší data do přepínací tabulky, zpracovává pakety, které nelze zpracovat v FIB (forwarding information base), vytváří chybové zprávy ICMP.
\end{itemize}

Funkční části:

\emph{Síťové rozhraní} (Network Interface) -- více vstupních portů, odstraňuje zapouzdření L2, předává L3 hlavičku přepínacímu modulu, ukládá do paměti, zapouzdří odchozí pakety

\emph{Přepínací modul} (Forwarding Engine) -- Podle L3 hlavičky a FIB určí výstupní síťové rozhraní, klasifikace pro podporu QoS.

\emph{Správce Front} (Queue Manager) -- Ukládá pakety do fronty, pokud je výstupní port obsazen, různé typy front, při zaplnění zahazuje podle definované politiky.

\emph{Správce Provozu} (Traffic Manager) -- Prioritizace a regulace výstupního provozu (omezuje a ořezává -- shaping, policing)

\emph{Kontext paketu}: Datová struktura se vytvoří při vstupu do zařízení a doplňují se L2 a L3 informace. Předáván mezi moduly.

Input NI -- Forwarding engine (+ Buffer memory) (+ Forwarding Table + Route Control Processor + Routing Table) -- Backplane -- Queue manager (+ Buffer memory) -- Traffic manager -- Output NI
\begin{itemize}
	\item Paket přijde na síťové rozhraní -- Zpracování L2 rámce, vytvoření kontextu paketu a doplnění informací do něj.
	\item Zpracování v přepínacím modulu -- vyhledání cesty v přepínací tabulce: next hop + výstupní rozhraní; Doplnění informací do kontextu, uložení paketu do vyrovnávací paměti.
	\item Přeposlání paketu propojovací deskou -- paket i kontext přeneseny na výstupní rozhraní
	\item Zpracování správcem front -- podle priority uložen paket do příslušné fronty, obsluha fronty podle daného plánovacího algoritmu
	\item Předání kontextu správci procesů -- kontrola omezení rychlosti (Shaping) dle kontextu. Při překročení zahození nebo sponalení.
	\item Výstupní síťové rozhraní -- L3: aktualizace TTL, přepočítání kontrolního součtu; L2: přidání hlavičky, výpočet CRC; odeslání paketu
\end{itemize}

\paragraph{Rychlá cesta} (data plane) -- většina paketů, časově kritické operace, ASIC na síťovém modulu. Zpracování hlavičky, přeposlání paketu, klasifikace paketu, uložení do front, plánování

\paragraph{Pomalá cesta} (control plane) -- částeční zpracování v HW, většina v SW. Zpracování ARP, Fragmentace a defragmentace (sestavení drahé), zdrojové směrování, Pokročilé zpracování IP paketu: zaznamenávání cesty, generování ICMP; Správa a monitoring sítě (SNMP), zpracování směrovacích informací.

\section{Přeposílání paketů}
Zjištění, zda cíl cesty je dosažitelný, vyhledání nejbližšího následujícího uzlu (next hop) a příslušného výstupního rozhraní, vyhledání informací pro vytvoření L2 hlavičky.

\subsection{Softwarové přeposílání (Process Switching)}
Pomalé, pro každý paket hledáme cestu ve směrovací tabulce
\begin{enumerate}
	\item IO procesor: Detekce paketu na vstupním médiu, přenos do vstupního bufferu
	\item Přerušení procesoru, kopírování do centrální paměti
	\item Centrální plánovač zjistí paket ve frontě, naplánuje jeho další zpracování
	\item Proces zpracování vyhledá ve směrovací tabulce další uzel (next hop) a výstupní rozhraní
	\item Přepíše L2 hlavičku paketu, umístí paket do výstupní fronty na výstupním portu
	\item Výstupní fronta: prioritizace podle QoS, vložení do vysílací fronty na výstupním portu
	\item IO procesor detekuje paket ve vysílací frontě. Zapíše na síťové médium
\end{enumerate}
(využití cache při vyhledávání stejných informací; vyvažování zátěže po paketech)

\subsection{Přerušené přepínání kontextu (Interrupt Context Switching)}
Pakety se přepínají na vyžádání po příchodu. Nečeká se na cyklus plánovače
\begin{enumerate}
	\item Detekce paketu a přenos do paměti
	\item Vygenerování přerušení, CPU určí typ paketu a začne ho přeposílat
	\item Paket zkopírován na výstupní rozhraní
	\item Odeslání paketu
\end{enumerate}

\subsection{Rychlé přeposílání (Fast Switching)}

Pro první paket toku se využije softwarové přepínání, další pakety toku procházejí rychlou cestou (Fast Cache). Hashovací tabulka -- kolize.

Aktuálně pomocí 2-way radix tree (binární strom) -- neobsahuje masku -- problém překrývajících se prefixů různé délky -- pevná dílka prefixu pro každou destinaci -- hloubka až 32.

Neexistuje synchronizace mezi ARP cache a Fast Cache, nepodporuje rekurivní směrování z Fast Cache (vyhodnocení před vložením do tabulky). Při zaplnění nad určitou mez se začnou záznamy náhodně zahazovat.

Vyvažování zátěže podle cíle (destination based) na místo po paketech, jako v prvním případě. Vyvažování je nedeterministické!

\subsection{Expresní přeposílání CEF (Cisco Express Forwarding)}
Řeší problémy minulých mechanismů: Chybějící podpora překrývání záznamů, změny ARP zneplatňují Fast Cache, první paket je vždy zpracován v SW, nedostatečné vyvažování zátěže.

Nevadí u podnikových, ale je kritické pro páteřní směrovače -- extrémně velké směrovací tabulky (sta tisíce záznamů), časté změny ve směrovacích tabulkách, velká režie softwarového přepínání.

\paragraph{Tabulka CEF}: vytvoří se na základě směrovací tabulky, vyhledávání pomocí 256-ární struktury trie. Každý uzel má 256 potomků (IPv4), list obsahuje ukazatel do tabulky sousedů

\paragraph{Tabulka sousedů} (Adjacency table) -- data pro vytvoření hlaviček pro přímo připojené sousedy. Obsahuje přepočítané hlavičky, nekompletní L2 hlavičky vyžadující ARP dotaz, softwarové zpracování.

\begin{enumerate}
	\item Předpočítání tabulky CEF a tabulky sousedů
	\item V tabulce CEF se vyhledá cíl na ukazatel v tabulce sousedů
	\item V tabulce sousedů se vyhledá předkompilovaná hlavička L2
	\item Paket se předá na výstupní rozhraní
\end{enumerate}

Tabulky předpočítány před tím než přijde paket, oddělení směrovacích informací od L2 dat, změny ARP se okamžitě promítají v CEF a tabulce sousedů.

Zátěž lze vyvažovat podle paketu, nebo dvojice zdroj/cíl -- Záznam v CEF tabulce ukazuje na tabulku \emph{Load Share} -- ukazatele na paralelní cesty v tabulce sousedů.

\section{Architektury směrovačů}
\subsection{Architektura se sdíleným procesorem (Shared CPU)}
Softwarové přepínání, Cykly CPU rozděleny mezi přeposílání, směrování a další operace. Sdílená sběrnice a procesor. Pomalé a levné.

Varianta s pamětí na kartě -- synchronizace přepínacích tabulek, FE na kartě. Rychlé přepínání -- první paket vs. další pakety.

\subsection{Architektura s nezávislými moduly FE (Shared Forwarding Engine)}
Přepínací moduly implementovány na speciálních kartách. Paralelní zpracování paketů.

Varianta s přepínanou sběrnicí -- vyšší propustnost

\subsection{Distribuovaná architektura (Shared Nothing)}
Veškeré zpracování paketů přeneseno do síťového modulu, oddělení procesu směrování a přeposílání  -- přepínání CEF

\subsection{Modulární architektura (Clusterd Architecture)}
Nezávislé moduly připojené k centrálnímu přepínači: Více přepínacích modulů, směrovacích procesorů. Distribuované zpracování -- dCEF.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Sítě Peer-to-Peer (P2P), Milgramův problém malého světa, model sítě P2P, směrování v P2P sítích, strukturované a nestrukturované sítě.} \label{cha:41}
2. semestr, PDS, \texttt{pds-07-p2p-16.pdf}

\section{Milgramův problém malého světa}
Pokud náhodně vybereme dva lidi na světě, jaká je pravděpodobnost, že se znají?

Pokud se neznají osobně, přes kolik známých je možné je propojit? (jak dlouhý by byl řetězec X-a-b-\dots-y-Z pro propojení X a Z).

Existuje nějaká matematická struktura ve společnosti? Hledání cesty pouze na základě lokálních znalostí.

\subsection{Milgramův experiment}
Doručit dopis příteli v jiném městě, 160 vybraných lidí odesílatelé, pouze osobní předání, odesílatelé mají dostatek informací o adresátovi (jméno, adresa, povolání, kde studoval), předávající posílají potvrzující dopisy pro sledování cesty.

Ze 160 dopisů dorazilo 44. Nejkratší cesta přes 2 prostředníky, nejdelší přes 11. Zkracující se vzdálenost směrem k cíli, většina použila stejné poslední 3 články.

\section{model sítě P2P}

Rozdíly od klasických sítí: Odlišná role uzlů, adresování obsahem, směrování: lokální rozhodování. Decentralizované.

Podobnosti: Postavené nad IP infrastrukturou, musí řešit adresování, směrování a zabezpečení.

Základem je \emph{logická síť (overlay)}. Postavená nad existující síťovou architekturou, definuje způsob propojení uzlů, komunikaci, vyhledávání, atd.

Příklady: Komunikace elektronických zařízení (Universal Plug-and-Play, Bluetooth), sdílení objektů (Napster, Gnutella, BitTorrent), komunikace mezi uživateli (Skype, IM), sdílení výpočetního prostředí (seti@home, PlanetLab)

\begin{mydef}
P2P síť: Dynamický soubor nezávislých uzlů (peers), které jsou propojeny a jejichž zdroje (objekty) jsou k dispozici ostatním uzlům v této síti.
\end{mydef}
Zdroje: Výpočetní výkon, síťová kapacita, disková kapacita, síťová zařízení. Uzly tyto zdroje nabízejí a používají. Také prostředky pro připojení uzlu k síti, s ostatními uzly, vyhledávání, vykonávání služby.

\begin{itemize}
	\item Pravé P2P (Pure) -- Odebrání libovolného uzlu ze sítě nemá vliv na ztrátu schopnosti sítě poskytovat služby
	\item Hybridní sítě -- Potřeba centrálního uzlu pro autentizaci, indexování, inicializační data, apod.
\end{itemize}

Samo-organizující se síť: decentralizovaná, spolupráce na vytvoření a udržování sítě, každý uzel má zodpovědnost za svůj lokální stav a část informace, pouze částečný pohled na topologii sítě (směrování pouze na nejbližší sousedy).

Autonomní chování uzlů: Uzly se chovají podle svého nejlepšího rozhodování (mohou se chovat zlomyslně), rozhodování má vliv na topologii, směrování, rozmístění objektů.

Spolehlivost: Roste s redundancí uzlů a informací -- kopie informace umístěna na více nespolehlivých uzlech.

Životnost uzlu: krátká a neodhadnutelná -- problém s garancí služby. Závisí na lokálním rozhodování, vliv na směrování a vyhledávání

\begin{tabular}{l|c|c|c|}
					& \textbf{Klient-server}& \textbf{Peer-to-peer}& \textbf{Výhody/nevýhody P2P} \\ \hline
	Směr provozu	& Asymetrický			& Symetrický		& vs xDSL, kabelový modem \\ \hline
	Topologie sítě	& Stabilní				& Dynamická			& Problém spolehlivosti \\ \hline
	Robustnost		& Centrální bod			& Distribuce zdrojů	& Kritický počet účastníků \\ \hline
	Rozšiřitelnost	& Náročné				& Součást návrhu	& Neomezený růst sítě \\ \hline
	Bezpečnost		& Velký důraz			& Problematické		& Chybí odpovědná autorita \\ \hline
	Správa a řízení	& Centralizovaná model	& Každý uživatel	& Samo-organizovaná síť \\ \hline
	Poskytované zdroje & Omezené možnosti	& Dynamicky rostoucí & Sdílení výpočetního prostoru \\ \hline
	Kvalita služeb	& Garantovaná			& Nelze zajistit	& Dynamicky se měnící \\ \hline
\end{tabular}

\subsection{Referenční model sítě P2P}
\begin{itemize}
	\item Jmenný prostor $\mathcal{I}$ (identifiers) \\
	Obsahuje metriku blízkosti (closeness): $d: \mathcal{I} \times \mathcal{I} \mapsto R$, prostor $(\mathcal{I}, d)$ se nazývá metrický. Pokud neplatí symetrie a trojúhelníková nerovnost, pak je pseudo-metrický.\\
	
	Metrika slouží k lokalizaci a směrování požadavků, také sdružování do klastrů podle blízkosti.
	\item množina uzlů $P$ (peers),
	\item množina zdrojů $R$ (resources),
	\item mapování zdrojů na identifikátory: $F_R: R \mapsto \mathcal{I}$\\
	Identifikace zdrojů, kritický pro úspěšné vyhledání zdrojů -- sémantická blízkost zdrojů: společně využívané zdroje mají blízké identifikátory, rozložení má vliv na vytížení zdrojů; Hashovací funkce
	\item mapování uzlů na identifikátory: $F_P: P \mapsto \mathcal{I}$\\
	Identifikátor, zodpovědnost za část jmenného prostoru, např. odvozený z IP
	\item struktura logické sítě.
\end{itemize}

Správa jmenného prostoru $\mathcal{I}$: Decentralizovaná správa $\mathcal{M}$: Funkce $\mathcal{M}: \mathcal{I} \mapsto 2^P$ definuje zodpovědnost uzlů za konkrétní identifikátory. Každému identifikátoru zdroje $i = F_R(r( \in \mathcal{I}$ je přidělena množina uzlů spravujících $r$. Každý uzel je zodpovědný za identifikátory $\mathcal{M}^{-1}(p)$.

Lokalizace zdroje (vyhledávání uzlu, který jej spravuje: $\mathcal{M}(F_R(r)$.

Správa $\mathcal{M}$ je úplná (parciální nemusí mít dočasně spojení mezi identifikátory a uzly), Kardinalita = stupeň replikace, Blízkost -- identifikátory jsou spojeny s nejbližšími uzly. Dynamicky se mění, jak se mění uzly.

Geometrie (struktura) -- orientovaný graf $G=(P, E)$. Dynamické chování reprezentování posloupností grafů $G_i(P_i, E_i), G_{i+1}(P_{i+1}, E_{i+1}), \dots$. Operace join (připojení uzlu) a leave (odpojení uzlu).

\section{směrování v P2P sítích}

Směrovací tabulka: Lokální v každém uzlu $R_P(V_P, E_P) \subseteq G$, která je součástí globální konfigurace sítě popsané grafem $G$. Tabulka obsahuje množinu sousedních uzlů a hran k nim.

Relace sousedství: $\mathcal{N}: P \mapsto 2^P$. Výsledkem množina sousedů $\mathcal{N}(p)$.

Topologie:
\begin{tabular}{l|c|c|}
Topologie		& Stupeň uzlu		& Poloměr \\ \hline
de Bruijin		& $k$				& $\log_k N$ \\ \hline
Trie			& $k+1$				& $2 \log_k N$ \\ \hline
Chord			& $\log_2 N$		& $2 \log_2 N$ \\ \hline
CAN				& $2d$				& $\frac{1}{2} d N \frac{1}{d}$ \\ \hline
Pastry			& $(b-1) \log_b N$	& $\log_b N$ \\ \hline
Classic buterfly& $k$				& $2 \log_k N(1-o(1))$ \\ \hline
\end{tabular}

Směrovací strategie: předávání zprávy $m$ do uzlu $p$, který spravuje objekt $i$. Směrovací funkce $R: P \times I \mapsto 2^P$. V každém uzlu vybere z množiny sousedů $\mathcal{N}(p)$ takový uzel $q$, které je nejblíže uzlu obsahující objekt $i$. Mohou vznikat lokální nekonzistence.

Vzdálenost v P2P nemusí odpovídat vzdálenosti fyzické, efektivnější P2P síť využívá údaje o fyzické blízkosti.

\section{Strukturované a nestrukturované sítě}
\subsection{Nestrukturované sítě P2P}
Využívají poznatků ze sociálních sítí a malého světa -- vyhledávání kontaktuje okolí, které ví, kde informace je, nebo zná někoho kdo tuto informaci zná. Ukládání objektů závisí na propojení uzlů -- každý uzel má sousedy -- využití tranzitivity (Napster, Gnutella, FastTrack).

\textbf{Neexistuje struktura uložení informace} (v náhodně vybraném uzlu). Uzel si vyměňuje zprávy se sousedy (vyhledávání konkrétního objektu, podle klíčového slova, názvu souboru).

Principy vyhledání:
\begin{enumerate}
	\item Záplava (Flooding) -- uzel pošle dotaz všem svým sousedům.\\
	Pokud uzel obsahuje objekt, pošle zpět odpověď, jinak pošle zprávy svým sousedům (tranzitivita). Obrana před zacyklením -- TTL zprávy, identifikátor zprávy (Gnutella)
	
	Jednoduchá implementace, minimální výpočetní nároky, neefektivní a špatně rozšířitelná
	\item Rozšiřující se kruh -- podobně jako záplava, jen s malým TTL\\
	Pokud objekt najdu, hledání skončí, jinak pošlu zprávu s větším TTL (redukce zpráv v síti)
	\item Náhodný průchod -- zpráva poslána náhodným sousedům. Neposílat dotaz zpět
	
	Hledání bez znalosti umístění objektu, může trvat dlouho
	\item Hledání lokálního minima (Local Minimum Sarch, LMS) -- mnužina uzlů identifikovaných hodnotou x, množina objektů s identifikátorem w (hash jména). Jméno uzlu by mělo být co nejblíže jménu ukládaného objektu w.\\
	V nestrukturovaných sítích nelze najít globální minimum, tak hledáme lokální. Používáme metriku vzdálenosti uzlu x od objektu w: $d(x, w)$.\\
	Uložení objektu $w$: Pokud je uzel $v$ lokálním minimem, uložíme, jinak hledáme nejlepšího souseda $v'$ dle metriky $d(w, v')$\\
	Vyhledání objektu: Dotazujeme se náhodně vyhledaných lokálních minim, jestli neobsahují objekt -- čím více kopií, tím jednodušší.
	
	Směrování podle jména objektu, metrika, vyžaduje režii při hledání lokálních minim.
\end{enumerate}

\subsection{Strukturované sítě P2P}

Kombinují geometrické struktury a směrování, využití distribuovaných směrovacích algoritmů. Metriky: shoda prefixu, eukleidovská či lineární vzdálenost, XOR; Velikost směrovací tabulky je ovlivněna stupněm uzlu.

\paragraph{Pastry}: Decentralizovaná, rozšiřitelná, samo-organizující se síť, sdílení souborů (PAST, klíčem hash souboru), komunikace (SCRIBE, klíčem jméno tématu), složitost vyhledání $\mathcal{O}(\log N)$, kde $N$ je počet uzlů sítě.
Jmenný prostor tvoří identifikátory uzlů (NodeId) a identifikátory objektů (Key).

Uzel sítě obsahuje náhodný identifikátor NodeId, tabulku listů $L$ (numericky nejbližších) pro směrování, tabulku sousedů $M$ (vzdálenostně nejbližší sousedy) pro lokalizaci, směrovací tabulku $R$ pro hledání cesty.

Směrování zprávy s klíčem $D$ v uzlu $A$:
\begin{enumerate}
	\item Pokud je klíč $D = NodeID$, uzel A je cílový
	\item Pokud je klíč $D$ v rozmezí NodeId v seznamu listů, pošli zprávu do uzlu $L_i$, kde vzdálenost $|D-L_i|$ je nejmenší.
	\item Jinak najdi ve směrovací tabulce řádek s nejdelším společným prefixem. Pokud je hodnota ve sloupci neprázdná, pošli tam zprávu
	\item Jinak vyber takový uzel $T \in (L \cup R \cup M)$, který má nejdelší společný prefix s $D$ a lepší numerickou vzdálenost než k $A$, tj. $|T-D| < |A-D|$.
\end{enumerate}
Připojení nového uzlu $X$:
\begin{itemize}
	\item Uzel se dozví o nejbližším uzlu $A$ (multicast, rozšiřující se kruh). Pošle mu zprávu join(X)
	\item $A$ ji přepošle k $Z$, který je numericky nejblíže
	\item Uzly po cestě pošlou své tabulky k inicializaci směrovací tabulku $X$
	\item $X$ si inicializuje tabulky takto: $L_X = L_Z, M_X = M_A$
	\item Po dokončení pošle své tabulky okolním uzlům
\end{itemize}
Odpojení uzlu $X$:
\begin{itemize}
	\item Tabulky Listů $L$: Uzel $Y$ kontaktuje list s numericky největším NodeId, požádá o tabulku listů, ze kterých si vybere náhrady za $X$.
	\item Směrovací tabulka $R$: Uzel $Y$ vyhledá další záznam na řádku, kde byl $X$. Požádá daný uzel o záznam ze své tabulky ve sloupci $d$
	\item Tabulka sousedů $M$: Uzel Y požádá ostatní své sousedy o zaslání tabulek sousedů a z nich vybere náhradu podle vzdálenosti.
\end{itemize}
Průměrný počet kroků hledání: $log(N)$, $N$ počet uzlů, průměrná délka cesty blízká k optimální. Výpadky mají vliv na počet směrovacích kroků. S opravou směrovacích tabulek zanedbatelné.

Geometrie sítě, Potřeba implementovat připojení, odpojení, vyhledávání, směrovací algoritmus konverguje k cíli, nutné sledovat stav sousedů a aktualizovat tabulky (BitTorrent, Skype).


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Základní principy softwarově definovaných sítí SDN, architektura, technologie OpenFlow.} \label{cha:42}
2. semestr, PDS, \texttt{pds-08-sdn-16.pdf}

V síťových zařízeních je SW a HW pevně svázáno a uzavřeno inovacím. Složitý upgrade, miliony řádků OS. Závislost na standardizovaných protokolech. Potřeba vylepšení programovatelnosti sítě, rozšíření technologie.

HW v síti: Požadavky na funkcionalitu a na rychlost.

Hardwarová platforma: Rychlá, směrování, přepínání; Programovatelné prostředí (API): podpora síťových protokolů, řízení směrování, inovace, nové strategie; Jednoduchá tvorba aplikací.

Aktivní sítě (Active networks): Uživatelé vkládají kód, který vykonávají aktivní prvky po cestě. Pakety -- Kapsule (data + kód).

Řízení toků: Separace Data plane a control plane.

\section{Software Defined Networks}
Řídící vrstva (control plane) -- Kontroler SDN + Aplikace SDN\\
Datová vrstva (data plane) -- síťová zařízení (rychlé přeposílání dat). Obecně Přepínač SDN (abstrakce od specifické činnosti (směrovač, přepínač, firewall). Řízeno kontrolérem.

\paragraph{Kontrolér SDN}: Správa síťových uzlů (počítače, topologie), Správa toků, Statistiky, Směrování (algoritmy pro výpočet cesty).

Vrchní rozhraní (northbound) -- REST, Plug-in, Proprietární
Spodní rozhraní (southbound) -- OpenFlow, oneP, CLI/SNMP

\section{OpenFlow}
Binární protokol, Pravidla pro Prioritu, Porovníní, Akce a Statistiky. Dokáže emulovat různé síťové prvky (Firewall, Směrování, Přepínání, Multicast uvnitř VLAN.

Chování OF přepínače:
\begin{itemize}
	\item reaktivní -- první paket je přeposlán do kontroléru, který vytvoří požadovaná pravidla. Režie komunikace (mikrotoky, získání detailnější informace o dění na síti)
	\item proaktivní -- pravidla předinstalována kontrolerem, známé očekávané toky (agregace).
\end{itemize}

Tabulky OF -- hledání pravidla s nejvyšší prioritou, přiřazení akcí/metadat; volitelná aplikace akcí; volitelné pokračování do další tabulky.

OpenFlow 1.1: Více tabulek, skupiny portů (multicast, multipath), Podpora MPLS a VLAN, Virtuální porty (Tunely), změna chování po přerušení spojení.

OpenFlow 1.2: Rozšířené možnosti polí pravidel, přepisu polí, metadat, chybové zprávy, IPv6, odstranění specifikace parsování paketů.

OpenFlow 1.3: Změna specifikace inzerování možností (capabilities), flexibilnější kontrola při nenalezení pravidla, rozšiřující hlavičky IPv6, vlastní čítače pro každý tok.

OpenFlow 1.4: Podpora pro optické porty, podpora více kontrolérů, vylepšení ošetření přeplněných tabulek, kvaziatomické operace, změna portu na 6653

OpenFlow 1.5: Tabulky pro výstupní porty, ne-Ethernoetové rámce (IP, PPP), rozšířená práce se statistikami toků, hledání pravidel podle příznaků TCP.

Nástroj umožňující inovaci počítačových sítí, proaktivní/reaktivní přístup. Oddělení control plane od data plane.

\section{Vrchní rozhraní (northbound}
Aplikace nad SDN -- není standardizováno, aplikace nepřenositelné mezi kontroléry. Plug-in, REST (ODL).

Distribuce aplikací: HP SDN App Store, Komunitní portály, součásti kontrolerů.

\section{Využití SDN}
Alternativní přístup ke správě sítě, programovatelnost aktivních prvků, snadnost inovací.

Současně: Nasazení v data centrech (zkušenosti HP -- hybridní sítě, hybridní přepínače), Nejednotnost výrobců (hybridní režim u Cisco), podpora specifických zařízení.

\subsection{Network Virtualization}
Správa virtuálních strojů a virtální sítě mezi nimi.

Programovatelná \uv{data plane} -- platformě a protokolově nezávislé programování síťových procesorů: CPU, GPU, síťový procesor, FPGA.

Sovisející: Open Network Install Envorinmoent (ONIE), Open Network Linux, OpenStack

Problémy: Zpoždění při vkládání nových toků (reaktivní režim), velikost tabulek, stabilita.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Formální metody v počítačových sítích.} \label{cha:43}
2. semestr, PDS, \texttt{pds-12-formalmethods-16.pdf}

Formal methods:
\begin{itemize}
	\item Logical Raasoning (Datalog) -- for configuration verificatio
	\item Constaint solving (SAT/SMT) -- for policy verification
	\item Explicit Model Checking (SPIN, TLA, UPPAAL) -- for protocol verification
\end{itemize}

Logic structure:
\begin{itemize}
	\item Logic has Syntax, semantics, axioms and rules of inference.
	\item Syntax -- well-formed formulas (wffs)
	\item Model checking: Is the wff true in a given interpretation?
	\item Model finding: Find interpretation in which a wff is true
	\item Constrain solving: find a model that satisfies the given constrains
	\item Proof: sequence of wffs starting with axioms, obtained by application of rues of inference
\end{itemize}

\section{Security Protocol Verification}

\subsection{ProVerif}
Automatic analysis of security protocols. Analysis of secrecy and authentication properties, privacy, traceability, and verifiability. Capable of attack reconstruction.

Verify the program which interact using public communication channel. Assume that cryptography is perfect, attacker can read, modify, delete or inject any messages and decrypt, if have necessary keys.

\paragraph{ProVerif input language}: Declarations (behavior of cryptographic primitives), process macros to define subprocess, protocol itself.

Processes use finite set of types, free names and constructors. Private ones are not accessible by the attacker. Constructors create primitives (cryptographic hash functions, encryptions, digital signatures). Relationships between cryptographic primitives are captured by destructors (decryption, verify) used to manipulate terms formed by constructors.

\paragraph{Processes} describe the behavior of a protocol, parallel composition, infinite composition, standard conditions and communications

\paragraph{Reachability and secrecy}: basic capability, which terms are available to the attacker and the secrecy of the private ones.

\paragraph{Correspondence assertions} -- possibility to make sure that for all occurrences of events M, there is a previous occurrence of event from N. \emph{Injective correspondence} is assertion that for every event from M, there is a distinct earlier occurrence of the event from N. Useful to ensure that the handshake was finished before running authentication from client.

Possibility to describe events.

\paragraph{Results}: True means there is no attach, False means there is an attack. It can also say that the query can not be proved. ProVerif didn't find an attack nor proved the query. Example: \texttt{query attacher(M)} returns \texttt{RESULT not attacker(M) is true} means that the secrecy of the \texttt{M} is preserved by the protocol.

\paragraph{Attack derivation} is explanation of the actions that the attacker has to make to break the security property. The trace is then the semantics in $\pi$-calculus.

\section{Theory of configuration}

Configuration of complex enterprise network is difficult and error prone task (usually human errors).
How to validate a multi-level enterprise collaboration network configuration?

\subsection{Requirements}
\begin{itemize}
	\item Connectivity: Each site has a gateway router connected to the WAN, there is a full-mesh of GRE tunnels between gateway routers. Each gateway router is connected to an internal router at the same site.
	\item Security: There is a full-mesh network of IPSec tunnels between all gateway routers, packet through every GRE tunnel are encrypted with an IPSec tunnel, no gateway router in a COI has a static route to a destination in a different COI, not cross-COI physical, GRE, BGP connectivity or reachability is permitted
	\item Reliability: BGP is run on the GRE tunnel network to discover routes to destinations in different sites, OSPF is run within a site to discover routes to internal destinations, OSPF and BGP route redistribution is set up
	\item Performance: MTU on all the interfaces are set to less than the expected packet size after taking into the account GRE and IPSec encapsulation. Alternatively, access control lists at eeach gateway router permit ICMP packets carrying MTU messages.
\end{itemize}

Need definition of IP addresses and masks of physical and GRE interfaces, IP addresses of the local and remote BGP session end points and the autonomous system number of the end point, names of GRE  interface and IP address of associated local and remote physical tunnel end points.

Possible problems: Missing GRE configuration on both sides, Asymmetric configuration of GRE tunnel, no full-mesh of BGP sessions within COI, BGP session between routers in two distinct COIs

\paragraph{Configuration today}: 12 files describing interfaces of routers.
\paragraph{New practice}: Fault tolerant VPN: Definition of the whole network in single file: Host side router interfaces (subnet), GRE tunnels, OSPF domains, static routing. Web-based configuration service.

\emph{Requirement library} captures design patterns and best practices. Administrator is using \emph{Specification language} with end-to-end requirements, close to natural language. The requirements are evaluated against the configuration by \emph{Requirement Evaluation system} and guide to repair possible problems.

How to get configuration from a network devices? \emph{Configuration acquisition} can get the information from a file in device or in the repository, using SNMP (only partial) or using NETCONF protocol. Presented in vendor neutral form.

\paragraph{Requirement library} is a collection of declarative rules and constraints that specify various class of standard requirements -- integrity, connectivity, reliability, security, performance, regulatory.

\paragraph{Integrity requirements} specify different logical structures to be properly set: IP subnets, GRE tunnels, IP-Sec, MPLS, BGP peering, OSPF areas, HSRP clusters. For examples: Transform sets, peer addresses, and ACL must be set consistently on both sides.

\paragraph{Connectivity Requirements} (also reachability): Fundamental requirement, existence of a path between two nodes in the network -- reachability in the presence of access control policies, connectivity for IP, VLAN, GRE, \dots. Methods are enumerating paths in a topology graph.

\paragraph{Reliability Requirements}: ability to maintain connectivity in the presence of failures of nodes or links. Using backup resources, identification of such single-point failure. Also redundant resources at one layer (MPLS) must be mapped to redundant resources at lower layers (IP).

\paragraph{Security Requirements}: Data confidentiality, data integrity, authentication (IPSec) and access control (ACL). Verification of access-control requirements.

\paragraph{Performance Requirements}: DifServ: Policies for partitioning packets into different classes and specifying different performance treat. Requirement having all the policies identical on all the routers and being used (assigned with an interface), ICMP packets are not blocked

\subsection{Configuration Synthesis}
Logic-based techniques -- Prolog and Datalog, Arithmetic quantifier free forms, Constraint solver for first-order logic, the minimum SAT solver for Boolean logic, Ordered Binary Decision Diagrams.

Integrity requirements: Configuration database is queried for existence (or non-existence) of integrity patterns.

Model checking can simply validate configuration, but we can also create configuration based on the rules using model generation/finding (Prolog). But Prolog can not explain why the validation failed. We need a tool that provides proof of unsolvability (constraints solvers (Alloy, Formula) using SAT/SMT solver provide such proof.

\subsection{Proof of unsolvability}
If \texttt{(good, not(bad))} fails and we would like to know why and how to correct the configuration.
We can compute Requirement Constraints, find what part of RC causes the validation fail and inject constraints variables to the configuration database that we suspect as possible incorrect.

\subsection{Overview of other work}
Focus on validating configuration against requirements expressed in terms of network policy, analyzing firewalls (validation, searching for conflicts, repair), Validation of routing configuration of BGP, extending to SDN (OpenFlow) and verification of SDN programs.

Usually logic based methods.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Konflikty a závislosti při řetězovém zpracování instrukcí a jejich HW/SW ošetření.} \label{cha:44}
2. semestr, PDS, \texttt{??}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Architektura superskalárních procesorů a algoritmy OOO zpracování instrukcí.} \label{cha:45}
\chapter{Procesory VLIW a používané optimalizační techniky s HW podporou.} \label{cha:46}
\chapter{Multivláknové procesory, hrubý, jemný a simultánní MT.} \label{cha:47}
\chapter{Datový paralelismus SIMD a SIMT, HW implementace a SW podpora.} \label{cha:48}
\chapter{Architektura grafických procesorů, odlišnosti od superskalárních procesorů.} \label{cha:49}
\chapter{Programovací jazyk CUDA, model vláken a paměťový model.} \label{cha:50}
\chapter{Základní rysy nízkopříkonových procesorů (požadavky, architektura, výkonnost).} \label{cha:51}
\chapter{Jazyky pro popis obvodů} \label{cha:52}
3. semestr, PCS, \texttt{01-uvod.pdf}

(VHDL, syntetizovatelné konstrukce)

Popis obvodu -- VHDL -- syntéza -- Netlist -- generování konfigurace -- cílová technologie FPGA

Popis číslicových obvodů: Původně grafická reprezentace pomocí logického schématu. Zvyšující se složitost vedla ke vzniku HDL (Hardware Description Language) jazyků.

HDL jazyky: Zařízení je možné modelovat a simulovat. Proces syntézy (analogie ke kompilaci) umožňuje transformovat HDL popis do prvků cílové technologie. V praxi se použív VHDL a Verilog.

Extrémní nárůst hradel vede k zavádění abstraktních jazyků: SystemC, HandelC, ImpulseC, CatapultC, které přináší výrazné urychlení vývoje nových zařízení.

\section{Jazyk VHDL}
VHSIC (Very High Speed Integrated Circuit) Hardware Description Language. Původně pro vojenské účely, později se stalo IEEE standardem. Není svázaný s žádnou cílovou technologií.

Umožňuje tři úrovně popisu: Behaviorální, Strukturní a Data Flow.

VHDL popisuje číslicová zařízení pomocí komponent:
\begin{itemize}
	\item \emph{Entita} definuje rozhraní komponenty k okolí.
	
	Rozhraní se skládá ze signálů (směr IN, OUT, INOUT) rozhraní a generických parametrů.
	\item \emph{Architektura} popisuje funkci a chování. Vždy svázána s konkrétní entitou (které definuje interakce s okolím).
	
	Popis na úrovni struktury (strukturní popis -- z čeho je složena) nebo chování (behaviorální popis -- co komponenta dělá). Lze kombinovat.
	
	Obsahuje jméno entity, deklarační část (signály, konstanty, typy uvnitř architektury) a sekci paralelních příkazů (instance komponent, procesy -- strukturní nebo behaviorální popis)
\end{itemize}
Jedna entita může mít více architektur.

\subsection{Behaviorální popis}
Architektura je složena z jednoho nebo více procesů, jak se mění vstupy v závislosti na změnách vstupů (nemusí být zřejmá hardwarová realizace).

\paragraph{Proces ve VHDL} obsahuje
\begin{itemize}
	\item Seznam citlivých proměnných (sensitivity list): proces spouštěn po změně signálu ze seznamu (simulace)
	\item Deklarační část procesu
	\item Sekvenční příkazy: Program popisující chování dané komponenty nebo její části. Na základě vstupních signálů a vnitřních proměnných program vypočítá hodnoty výstupních signálů.
\end{itemize}

\subsection{Dataflow popis}
Modelování datových závislostí. Zkrácený zápis chování pomocí paralelních příkazů uvnitř architektury (přiřazovací, podmíněný a výběrový příkaz).

\paragraph{Signály ve VHDL} slouží ke komunikaci, mohou být implementovány pomocí vodiče nebo sběrnice (více vodičů). Datové typy bit/vector. U sběrnice určen rozsah a význam bitů (LSB, MSB)

\subsection{Strukturní popis}
Umístění knihovny, přiřazení signálů pořadím/jménem

Testbench -- testování VHDL komponent v prostředí VHDL -- instance vyvíjené komponenty (UUT -- Unit Under Test), Generátor testovacích vektorů, monitorování a ověřování reakcí UUT.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Logická syntéza obvodů} \label{cha:53}
3. semestr, PCS, \texttt{01-uvod.pdf}

(návrh pro technologie FPGA a ASIC, fáze syntézy, optimalizace, mapování, techniky zřetězení a vyvážení)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Moderní přístupy k syntéze číslicových obvodů} \label{cha:54}
3. semestr, PCS, \texttt{01-uvod.pdf}

(reprezentace obvodu pomocí AIG, techniky odstraňování funkční redundance v AIG, tradiční mapování AIG do LUT)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Aplikace omezujících podmínek.} \label{cha:55}
3. semestr, PCS, \texttt{01-uvod.pdf}

(časová a fyzická omezení)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Verifikace číslicových obvodů} \label{cha:56}
3. semestr, PCS, \texttt{01-uvod.pdf}

(metodologie OVM)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Technologie programovatelného hardware (architektura FPGA, struktura konfigurovatelných bloků a vestavěných bloků, propojovací sít, způsoby konfigurace, srovnání s technologií ASIC).} \label{cha:57}
\chapter{Vestavěný počítačový systém} \label{cha:58}
4. semestr, NAV, \texttt{NVS1.pdf} - \texttt{NVS6.pdf}

(shody a odlišnosti s běžným univerzálním počítačovým systémem)

\section{Rozdíly vestavěného a univerzálního počítače}
\paragraph{Vestavěný systém} je počítačový systém vestavný do aplikace. Obsahuje jeden program po celý život, uživatel by neměl tušit, že pracuje s počítačem, hlavní interakce nemusí být s člověkem (čidla pro snímání prostředí, ovládání akčních členů), startuje bez lidského zásahu.

\paragraph{Univerzální systém}: Uživatel spouští různé programy, periferie hlavně pro komunikaci s uživatelem, nutnost OS, souborů, ukládání dat.

\paragraph{Společné pro oba} jsou procesor (ALU, řadič, registry), paměť (program, data), vstupy, výstupy a periferie.

Enbedded engineer -- částečně programátor, návrhář číslicové elektroniky, vyzná se v analogových obvodech.

\section{Návrh vestavěných systémů}
\subsection{Specifikace požadavků}
Zásadní, dostatek RAM pro běžící aplikaci, výpočetní výkon, IO porty, Normy, spolehlivost, rychlost reakce, rozhraní člověk/stroj, napájení/spotřeba, ošetření chyb, hmotnost/rozměry, bezpečnost

Požadavky na produkt: čím produkt bude (vstupy, uživatelské rozhraní); Požadavky na funkci: co musí produkt dělat\\

Mikrokontrolér -- DSP -- ASIC (roste cena a výkon)?

Existuje integrovaný obvod k řešení daného problému (konvertor rozhraní USB/RS232)? Složité rozhraní člověk/stroj (vestavět univerzální počítač)? Bude potřeba produkt dále vyvíjet a přizpůsobovat?

\subsection{Výběr vhodné platformy}
\begin{itemize}
	\item Počet IO portů (piny mohou být sdílené)
	\item rozhraní (RS-232, CAN, Ethernet)
	\item velikost paměti (program, konstanty, tabulky, buffery zásobník, adresování)
	\item přerušení (počet, obsluha)
	\item reálný čas? (pokud nestihneme v SW, je potřeba speciální HW -- PWM, DMA)
	\item rychlost MCU (instrukční sada, dělení hodinového signálu)
	\item ROM (levnější pro velké série)
	\item architektura paměti (von Neumann x Harwardská)
	\item napájení (baterie a spotřeba)
	\item typ prostředí (teplota, vlhkost)
	\item životní cyklus (levný MCU + SW pro velké série bez upgrade, pro malé série s aktualizacemi důležité vybrat perspektivní MCU)
	\item Schopnosti operátora (použité rozhraní člověk/stroj -- pro laika složitější rozhraní), \uv{skutečné požadavky}
\end{itemize}

\subsection{rozdělení SW/HW}
software zvyšuje náklady na vývoj, hardware zvýší cenu na výrobek. Čím složitější systém, tím náročnější rozhodování.

\subsection{Návrh HW}
Signle chip (komponenty zapojeny výrobcem), nebo pouze MCU s externí pamětí (potřeba propojit součásti).

\emph{Reset} po připojení napájení nebo obvod power-on-reset již vestavěný. RC článek, kombinace s reset tlačítkem. Pro vysokou spolehlivost \uv{processor supervisory chips}, které hlídají napájení a v přápadě problémů spolehlivě resetují.

\emph{Oscilátor} -- krystal pro stabilní rezonanční kmitočet, ve zpětné vazbě zesilovače, kondenzátory pro snadný rozběh. Pro levější (10 horší přesnost) lze použít keramické. Pro větší přesnost lze připojit externí oscilátor.

\emph{Číslicové vstupy} -- logická 1 je napětí blízko napájecímu a proud teče směrem z výstupu. Pro logickou 0 je napětí blízko zemi a proud teče do výstupu. Tolerance logické úrovně závisí na technologii (CMOS, TTL). Pokud výstup TTL je použít pro CMOS, můžeme se dostat do \uv{neurčitého stavu} a vzniknout těžko laditelné chyby.

Viz kapitola \ref{cha:60}.

\subsection{Návrh SW}
Viz kapitola \ref{cha:61}.

\subsection{Verifikace, testování}
Můžeme přidat speciální HW nebo SW pro ladící účely (ne všechny MCU mají takovou podporu automaticky).

Používat malé funkce, každý krok ověřit, otestovat. Pečlivost při použití ukazatelů (neinicializovaný ukazatel může  napáchat škody v paměti), dobře komentujte, vyvarujte se magických čísel.

Ladící kódy pro vstup do přerušovací rutiny, návrat z přerušovací rutiny, provedení hlavní funkce, vyslání zprávy či příkazu k periferiím. Lze posílat přes vyhrazený port, zapisovat do paměti/logu a později prohlédnout.

Lze použít simulátor v PC (používá model $\mu$C -- levné, jednoduché ladění, nehrozí poškození systému. Neběží v reálném čase, potřeba simulovat periferie, nemusí být zcela věrné.

\emph{Simulace periferií} je možná (běžných -- diody, segmentové displeje, klávesnice).

\emph{Obvodový simulátor} -- hardware, který se chová jako $\mu$C, připojuje se k vestavěnému systému. Provádí kromě funkcí $\mu$C také breakpointy, debuger, změny stavu a další podpůrné funkce.\\
(+)Přesná emulace v reálném čase, komfortní ladění přímo cílové aplikace. (-) Drahé, vazba na pracoviště, specifický pro typ MCU, vyplatí se pro vývoj více systémů.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Implementace funkcí vestavěného systému SW a HW prostředky} \label{cha:59}
4. semestr, NAV, \texttt{NVS3.pdf}

(výhody a nevýhody - dopady SW a HW implementace konkrétní funkce na vlastnosti systému, příklad)

\paragraph{Realizace funkce: zobrazení na sedmisegmentovém display}
\begin{itemize}
	\item Hardwarová realizace
	\begin{itemize}
		\item triviální a rychlá obsluha
		\item stačí 4 bity výstupního portu
		\item nelze zobrazovat co dekodér neumí (většinou pouze čísla)
		\item edná se o další spotřebič
		\item Zpravidla větší výkon (HW pracuje "paralelně)
		\item menší riziko vzniku chyby
		\item výhodnější pro kusově vyráběný HW
		\item Pokud nastane chyba, obtížněji se opravuje.
	\end{itemize}
	\item Softwarová realizace
	\begin{itemize}
		\item Není potřeba externí součástky (levnější), pokud není potřeba posílit výstupy
		\item Tabulka zabírá paměť a SW dekódování trvá nějakou dobu.
		\item Levnější ve velkých sériích (náklady na vývoj jednorázové)
		\item vhodné pro minimalistické a jednoduché konstrukce
		\item Větší možnost upgrade
		\item větší nároky na výkon CPU a paměť
		\item větší riziko vzniku chyby.
	\end{itemize}
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Číslicové vstupy a výstupy vestavěných systémů} \label{cha:60}
4. semestr, NAV, \texttt{NVS4.pdf}, \texttt{NAV1.pdf}

(problémy a jejich řešení, přizpůsobení napěťových úrovní, snímání stavu mechanického kontaktu, ovládání zátěže, posílení výstupu, H-můstek)

\subsection{Vstup a výstup MCU (NMOS)}
Většinou je na jednom pinu vstup a výstup. Pro výstup v log. 1 je zdrojem proudu rezistor, v log. 0 tranzistor svádí proud na zem.

Vstup: koncový tranzistor uzavřen, stav čten přes vstupní zesilovač.

\emph{Výhoda} Tlačítko lze připojit jednoduše, že se jeden konec uzemní a druhý se připojí k pinu. Rozepnuté je čteno jako log. 1 a sepnuté jako log. 0. Není třeba žádný vnější pull-up registr.

\subsection{IO porty HC(S)08 (CMOS)}
Místo jednoho tranzistoru a pull-up rezistoru je zde budič, který se odpojuje, pokud je port vstupní (speciální registr). Pull-up rezistor se připojuje v případě potřeby speciálním registrem.

Nastavení drive-strength a slew-rate (méně strmá hrana, méně rušení).

\uv{Gangaed outputs} slučuje několik pinů pro posílení vstupu (nelze u všech portů, protože změna stavu nemusí být atomická na několika portech).

\subsection{Prostý číslicový výstup}
\begin{itemize}
	\item LED svítí pro log. 1: LED připojena k zemi (ve směru od MCU)
	\item LED svítí pro log. 0: LED připojena k napětí (ve směru k MCU)
	\item kombinace: Obě jsou zhasnuté, pokud nastavíme port jako vstupní.
\end{itemize}

\subsection{Posílený číslicový výstup}
Jednoduchým obvodem s tranzistory (či integrovaným budičem).\\
NPN tranzistor spíná zátěž připojenou proti + pólu zdroje. Zdroj může být jiný, ale musí mít společnou zem.\\
PNP tranzistor spíná zátěž proti zemi. Rezistor v bázi omezuje proud, které může být větší než v případě NPN -- stačí nižší zesílení pro dosažení stejného proudu do zátěže.

\emph{Relé} výhodou je možnost použití vyššího napětí než MCU. Ochranná dioda chrání tranzistor před zápornými špičkami od cívky relé.

\paragraph{Posílení výstupu s IO} Otevřený kolektor (budí zátěž proti napětí) x Otevřený emitor (budí zátěž proti zemi)

\paragraph{Integrované budiče} -- Darlingtonová páry, push-pull. Potřeba pro ovládání motorů -- směr je určen polaritou.

Dva budiče pro ovládání směru. Řízeno jedním výstupem MCU (možno řídit otáčku pomocí PWM).

\subsection{H-můstek}
Slouží k ovládání SS motoru. Vstup enable, forward a reverse.

\subsection{Jednoduchý vstup -- kontakt}
Spíná buď (+) nebo zem (častější), definice klidové polohy pomocí pull-up/push-down rezistoru.

Problémy mechanického kontaktu: Zákmity -- z pohledu MCU několikeré rychlé sepnutí a rozepnutí. Řešení:
\begin{itemize}
	\item Softwarové: Při první detekci změny stavu kontaktu se chvíli stav kontaktu ignoruje, dokud se neustálí
	\item Kontakt se řeší jako přepínací a klopným obvodem se zachytí a podrží úroveň nebo použití RC filtru a hysterze (než se kapacita nabije)
\end{itemize}

\subsection{Výstup signálu s vyšším napětím}
Napěťový dělič (dva odpory, jeden mezi MCU a vstupem, druhý mezi MCU a zemí) vypočtený pro konkrétní vstupní napětí. Nebo ochranné diody uvnitř MCU (ne všechny MCU mají).

Ochrana pinu Varistorem nebo transistorem, popřípadě optočlenem, ale ten by měl být také chráněn odporem.

\subsection{Maticové uspořádání kláves}
Sloupce a řádky, v průsečících kontakty. Sepnutý kontakt je jednoznačně určen souřadnicí řádek-sloupec.

Postupně se budí řádek po řádku (např. log. 0) a čtou se sloupcové vodiče. pokud je na některém sloupcovém vodiči detekována log. 0, pak právě na tomto řádku je sepnut příslušný kontakt.

Potřeba pouze 8 pinů pro 16 kláves. Obtížně se detekuje současné sepnutí více kontaktů. Použitím kodérů a dekodérů můžeme snížit počet pinů na 4.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Architektura SW pro vestavěné systémy} \label{cha:61}
4. semestr, NAV, \texttt{NVS6.pdf}

(hlavní smyčka, implementace stavového automatu, obsluha přerušení)

Odlišnosti SW pro MCU od SW pro PC: Běží v reálném čas -- často je důležité jak dlouho něco trvá. Vždy pracuje na konkrétním HW a musí si s ním vystačit. Programátor většinou nemá podporu OS a musí umět procesor vždy zaměstnat.

\section{Hlavní smyčka}
idle-loop, background-loop, super-loop, polling loop. Minimální je skok na sebe sama (čekání na přerušení). Obecně zpracovává věci, co nevyžadují okamžitou pozornost.

Nejčastější typy architektur:
\begin{itemize}
	\item Vše v jedné hlavní smyčce -- testují se vstupy od přerušení a v nich se volají podprogramy implementující veškeré funkce. Vhodné, pokud mají být všechny funkce dostupné stále.
	\item Stavový automat -- v daném stavu jsou aktivní pouze některé funkce a sledovány pouze některé vstupy, které jsou pro daný stav podstatné. Nevýhodou je redundance.
	\begin{itemize}
		\item Více stavových automatů -- každý proces či funkce má svoje unikátní stavy. Hlavní smyčka vstupuje do jednotlivých procesů a v nich se větví podle lokálních stavů
		\item Inkrementální stavový automat -- každý proces provede několik instrukcí toho stavu, který je zrovna aktivní a pak předá řízení dalšímu procesu. Každý proces udržuje také informace o tom, kde zrovna je jeho vykonávání. Zdá se, že běží všechny současně, ale pomaleji, Obtížné pro ladění.
		\item RTOS
	\end{itemize}
\end{itemize}

Obsluha asynchronních událostí
\begin{itemize}
	\item Polling -- ve smyčce se neustále testuje, zda došlo k událost (bitový příznak). Pokud je výsledek kladný, provede se obsluha události
	\item Přerušení -- reakce v reálném čase. S přerušením je spojena obslužná rutina (software, který popisuje reakci na událost). Provede uložení kontextu (IP, a další) na zásobník. Lze zakázat, nebo také vnořovat (přerušení obslužné rutiny).
\end{itemize}

Vektor přerušení: Nese informaci o tom, kde se nachází obslužná rutina právě vzniklého přerušení. Odkaz do tabulky adres, nebo adresa na první instrukci přerušovací rutiny. Často přiřazená priorita, někdy ji lze nastavit.

\begin{itemize}
	\item Přerušení citlivé na úroveň signálu (level-sensitive): Když je na vstupu aktivní úroveň. Potřeba potvrzení o zpracování (přečtení, zápis, signalizace periferii). Může se stát, že úroveň zmizí, dříve než je přerušení zpracováno (probíhá obsluha přerušení s vyšší prioritou).\\
	Pokud úroveň \uv{visí} i po vyřízení přerušení, v hlavní smyčce se nastaví příznak, který přerušení nuluje a před spouštěním testuje. Pokud je příznak není nastaven, hlavní smyčka neproběhla a přerušení se přeskočí. Alternativně je možné použít čítač.
	\item Přerušení citlivé na hranu (edge-sensitive): Když se objeví hrana signálu. Periferie potřebuje vyvolat přerušení, aniž by čekala na potvrzení.\\
	Problém je se sdílením přerušovací linky, pokud dvě periferie požádají brzy po sobě, je pravděpodobné, že to druhé nebude obslouženo.
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Konstrukce adaptéru systémové sběrnice: návrh adresového dekodérů, obsluha čtecí a zápisové transakce.} \label{cha:62}
4. semestr, NAV, \texttt{nav\_principy-komunikace.pdf}

Návrh adaptérů -- komoditní hardware nemá potřebné vlastnosti (výko, latence, propustnost), potřeba speciálního rozhraní a funkcí.

Pro speciální akcelerační adaptéry (síťová zařízení, měřící přístroje, urychlení vědeckých výpočtů), řízení výrobních procesů (reálný čas), vytváření standardních nebo proprietárních rozhraní (USB, síťové karty).

Požadavky (propustnost, výkon, paměť, spotřeba, reakce v reálném čase) $\Rightarrow$ Existuje takový adaptér? Návrh nového adaptéru.

Součásti adaptéru:
\begin{itemize}
	\item Bus Interface Unit -- Komunikace se sběrnicí
	\item Address Decoder -- Dekodér adresy pro ovládání paměti a registrů
	\item Paměťový prostor karty -- sdílené informace mezi procesorem a jinými zařízeními na sběrnici; čtení a zápis ze strany adaptéru a zařízení na sběrnici.
	\item Adapter Logic
\end{itemize}

Komunikace s adaptérem -- sběrnice je jediný prostředek komunikace (sdílení komunikačních linek mezi adaptéry, různé topologie propojení adaptérů, procesoru a paměti.

Způsoby komunikace na sběrnici:
\begin{itemize}
	\item SW řízení -- přenos inicializovaný instrukcemi procesoru (zátěž na procesor, malý blok dat v transakci). Nejčastěji mapování paměti adaptéru do adresového prostoru procesoru. Velká režie, vhodné pro čtení/zápis jednotlivých registrů.\\
	Čekání na změnu stavu na adaptéru -- aktivní čekání (polling) -- zatížení procesoru, blokování sběrnice
	\item Přerušení -- signalizace události ze strany adaptéru -- lepší využití přenosového pásma systémové sběrnice. Obslužná rutina spotřebuje čas procesoru, s větším počtem se snižuje výkon procesoru běžícím aplikacím\\
	Interrupt storm -- zahlcení přerušením -- obsluha přerušení spotřebovává většinu výpočetního času. Pokud  je spotřebován všechen, dochází k tzv. Live-lock. Lze hardwarově omezit počet přerušení za sekundu.\\
	Ideálně při velkém počtu přerušení přepnout na polling.
	\item Blokové přenosy (DMA) -- blok dat v jedné transakci (adaptér -- paměť, adaptér -- adaptér, paměť -- adaptér). Bus master inicializuje přenos a po dobu transakce přebírá kontrolu nad sběrnicí.\\
	Používají DMA deskriptory -- zdrojová adresa, cílová adresa, délka. Stránky nesmí být odsunuty na disk (swap).\\
	Dlouhé přenosy: Snižuje režii komunikace, ale blokuje sběrnici pro ostatní zařízení. Procesor není zatížen přenosem, Bus Master na adaptéru je optimalizován pro tento úkol.
\end{itemize}

Adaptér PCI, PCI-X a PCI-Express sběrnice -- komplexní norma, časová a elektronická omezení. Nutné konfigurační oblasti paměti, rozdíl časové domény adaptéru a PCI.

PLX čip -- zjednodušuje komunikaci přes PCI sběrnici -- čtecí a zápisové FIFO, PCI konfigurační registry.

Combo-PTM -- PCI 32/33 MHz adaptér, PLX čip pro komunikaci přes PCI, FPGA Spartan 3. Bridge převádí PCI sběrnici na lokální sběrnici dostupnou z FPGA.

\subsection{Adresový dekodér}
Rozhraní adresového dekodéru:
\begin{itemize}
	\item \texttt{DO[31:0]} -- data z adresového dekodéru
	\item \texttt{DI[31:0]} -- data do adresového dekodéru
	\item \texttt{ADDR[31:0]} -- adresa registru nebo paměti
	\item \texttt{RD} -- Signalizace čtecí transakce
	\item \texttt{WR} -- Signalizace zápisové transakce
	\item \texttt{DRDY} -- Signalizace připravenosti dat
\end{itemize}

\paragraph{Zápisová transakce}: Na ADDR vystavena adresa kam se mají zapsat data, DI obsahuje data, WR=1 signalizuje zápisovou transakci. Při náběžné hraně CLK se provede zápis do registru/paměti na kartě.

\paragraph{Čtecí transakce}: Na ADDR vystavena adresa odkud se mají číst data, RD=1 signalizuje čtecí transakci. Po náběžné hraně CLK musí uživatelská komponenta vystavit na sběrnici DO data z registru/paměti a potvrdit platnost signálem DRDY.

\paragraph{Blokové transakce}
Při přenosu bloku je automaticky inkrementována adresa a v každém blokovém cykly je proveden jedna operace čtení nebo zápisu

Pro správné dekódování adresy a řízení zápisu/čtení do/z paměti nebo registru je potřeba tzv. adresový dekodér. Jednou operací musí být vždy adresován právě jeden registr nebo paměť.
\begin{itemize}
	\item Zápisová operace: Podle adresy a WR potřeba přivést WE signál k příslušnému registru, nebo paměti (Chip select)
	\item Čtecí operace: Z paměti opět signál RD.\\
	Pro připojení výstupních dat se používá výstupní datový multiplexor nebo třístavová sběrnice (povolovací signály \_rd). Data musí být vystavena až v dalším hodinovém cyklu!\\
	Multiplexor: 
	\begin{itemize}
		\item Asynchronní paměť -- čtení nečeká na hranu hodin (zpožovací registr)
		\item Synchronní paměť -- čtení proběhne až s nástupní hranou hodin, data k dispozici v dalším cyklu.
	\end{itemize}
\end{itemize}

Pokud není komponenta schopná vydat požadovaná data ihned v následujícím taktu, vkládají se čekací takty. Zde řešíme odložení DRDY signálu.

Aliasing paměťového prostoru: Pokud adresový dekodér reaguje jenom na spodní bity adresy a některé vyšší zůstanou neošetřeny -- mohou nabývat libovolné hodnoty. Adresy jsou tak namapovány do více míst v adresovém prostoru!



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Architektura sběrnice PCI-Express a USB: typy transakcí, způsob komunikace a směrování transakcí, detekce chyb a způsob zotavení.} \label{cha:63}
4. semestr, NAV, \texttt{nav - pci\_pcix\_pcie.pdf}, \texttt{nav\_usb20.pdf}, \texttt{nav\_usb30.pdf}

\section{Vývoj sběrnic typu PCI}

(paralelní sběrnice) PCI -- PCI-X -- PCI Express (plně duplexní sériové linky, paketová komunikace)

\section{PCI-X}
Komunikační protokol: Mezi vystavení adresy a dat, je ještě jedná fáze ATTRIB (vložneí atributu), kde se obvykle posílá velikost dat. Cílové zařízení zná velikost -- lepší správa bufferů v PCI zařízeni. 

Nepodporuje čekací stavy, pokud se již začaly přenášet data, minimální velikost bloku je 128 bajtů -- efektivita využití sběrnice až 85\%.

\paragraph{Model rozložené transakce}: nelze vkládat čekací stavy a tak je potřeba rozpojit transakci, dokud nejsou data připravena:
\begin{enumerate}
	\item Requester inicializuje čtecí operaci
	\item Completer detekuje svou adres a potvrzuje transakci. Zjistí ale, že není schopný poskytnout data okamžitě a tak rozpojí transakci.
	\item Completer připraví požadovaná data do vnitřního bufferu (zná velikost)
	\item Completer zahájí jednu nebo více zápisových operací, ve kterých pošel požadovaná data Requesteru
\end{enumerate}
Nedochází o opakovanému vyzývání ze strany Requesteru, pro načtení dat je potřeba max. dvě operace na PCI-X.

\paragraph{Obsluha přerušení}: PCI-X zařízení musí podporovat MIS (Message Signaled Interrupt). Přerušení je generováno pomocí běžné zápisové operace do prostoru MSI kontroléru (místo INTx signálu).
\dots



\section{PCI-Express}
Rychlé, plně duplexní sériové linky s kapacitou 2,5 Gb/s, 5 Gb/s nebo 8 Gb/s. Pro jeden kanál lze takto propojit až 32  těchto linek s přenosovou kapacitou až 16 GB/s (se zahrnutím kódování 8/10 -- 20\% režie pro PCI-e v1).

Transakce probíhají přes paketovou komunikaci. Data jsou rozdělována rovnoměrně do jednotlivých linek. Při propojení linek se obě komunikující strany musí dohodnout na komunikační rychlosti a počtu linek.

\paragraph{Přerušení} jsou odesílána podobně jako u PCI-X pomocí MSI. Součástí je informace o zařízení, které přerušení vyvolalo.

\paragraph{Řízení spotřeby}: lze individuálně řídit skrze SW pomocí zasílání zpráv, popřípadě linky se mohou samy uspávat, v době snížené aktivity. Stavy pro zařízení D0, D1, D2, D3-Hot, D3-Cold, pro linku L0, L1, L2, L3.

\paragraph{Správa chyb} každý paket je zabezpečen pomocí CRC. Vzniklé chyby se zapisují do logu a ošetřují na různých úrovních.

\paragraph{Hot Plug}: v průběhu činnosti systému lze připojovat/odpojovat nové PCI zařízení. Na desce speciální tlačítko a dvojice LED pro signalizaci stavu napájení. Důležité pro senzory a zařízení s nepřetržitým provozem.

\paragraph{Konektory}: Základní verze je pro PCI-e x1, pro další se konektor rozšiřuje. Pouze jedna pevná zarážka oddělující společné signály od datových vodičů. Do většího konektoru lze zapojit zařízení s menším konektorem. Dále Mini PCI Express.

\subsection{Topologie PCI Express}
Stromová topologie.
\begin{itemize}
	\item Root Complex -- centrální bridge mezi CPU, pamětí a PCIe sběrnící (Bus 0)
	\item Endpoints -- koncová zařízeni
	\item Switch -- přepínač mezi více linkami
\end{itemize}
Každé zařízení je jednoznačně identifikováno pomocí Bus Number, Device Number, Funciton Number.

Linky jsou číslovány od 0 (Root, virtuální), ostatní do hloubky. Uvnitř přepínače je také číslovaná pomyslná sběrnice propojující jednotlivé porty (3). Na každé lince jsou pouze dvě zařízení, číslovaná 0 a 1 (0 je ve směru dolů). Každé zařízení může mít až 8 funkcí.

\paragraph{Transakce} reprezentuje tok dat složený z jednoho nebo více paketů (max 4 kB). V každé transakci vystupuje Requester (inicializace transakce) a Completer (cílové zařízení dokončující transakci). Komunikace může probíhat mezi kořenem a koncovým zařízením, nebo mezi zařízeními navzájem.

Typy transakcí:
\begin{itemize}
	\item Posted (bez odpovědi) -- pokud Completer nemůže data přijmout, Requester se o tom nedozví.
	\begin{itemize}
		\item Memory Write
		\item Message -- pro přerušení, hlášení chyb, řízení spotřeby -- omezení mnoha řídicích signálů na sběrnici.
	\end{itemize}
	\item Non-Posted (s odpovědí) -- Completer vždy odpovídá (s daty nebo bez dat)
	\begin{itemize}
		\item Memory Read
		\item IO Read/Write
		\item Configuration Read/Write
	\end{itemize}
\end{itemize}

\subsection{Vrstvový model}
\begin{description}
	\item[Transakční vrstva] přenos paketů mezi libovolnými uzly, řeší i směrování přes přepínače.\\
	Sestavuje hlavičku paketu, připojuje data a vypočítá volitelné CRC. Obsahuje buffery pro příchozí a odchozí pakety, rozhoduje o prioritě zpracování (QoS), výměnu informací o velikosti volného místa (Flow Control), zahrnuje řízení spotřeby bez účasti SW nebo PCI kořene -- ACPI/PCI, řeší konfiguraci PCI zařízení.
	\item[Linková vrstva] přenos paketů mezi sousedními uzly, integrita dat přenesených jednou linkou.\\
	Ke hlavičce přidává sekvenční číslo a je vypočítán CRC kód pro zabezpečení dat. Paket je odeslán na fyzickou vrstvu a uložen do Reply bufferu. Přijímající strana paket přijme, zkontroluje CRC a sekvenční číslo (musí dorazit v pořadí) a odešle potvrzení ACK. Pokud je identifikována chyba, odpověď je NACK a paket je přeposlán z Reply Bufferu (max. 4, potom je propagována chybová zpráva a do log. registru je uložena informace o chybě). DLLP
	\item[Fyzická vrstva] přenos dat na nejnižší úrovni (digitální i analogové).\\
	Ke každému paketu jsou připojeny řídicí značky Start a End, paket rozdělen po 8 bitech na jednotlivé linky, provede se kódování 8/10 (aby byl zachován vhodný počet přechodů 0/1 pro obnovení hodinového signálu na přijímající straně), serializace a odeslání diferenciálním spojem. Přijímající strana obnoví hodinový signál, deserializuje data, vyrovnáno zpoždění, dekódována 8/10.\\
	Součástí inicializace a trénování linky: Detekce počtu linek, detekce přenosové rychlosti a detekce polarity diferenciálního spoje (automaticky bez účasti SW)
\end{description}

\paragraph{Formát paketu}: Hlavička: Typ (Memory/IO/Config Read/Write), TC (Traffic Class), Fmt (délka hlavičky 3/4DW), Length (délka paketu v DWORD), BE (zarovnání prvního a posledního DWORD)

\paragraph{Quality of Services (QoS)} Traffic class (TC0 - TC7 -- největší) určuje prioritu (videokamera x SCSI disk).
Přenos poté probíhá přes Virtual Channels (VC) -- v rámci jedné fyzické linky může být až 8 virtuálních s různou prioritou. Více TC může být namapováno do jednoho VC, ale ne naopak. Zařízení musí implementovat alespoň jeden VC.

Switch vyhodnocuje prioritu na základě portů (pro pakety se stejným VC) a čísla VC. Vyhodnocení priority může být nastaveno skrze konfigurační registr (statická, Round-Robin, váhovaný Round-Robin, časovaný Round-Robin).

\paragraph{Flow control} slouží k výměně informací o volném místě v přijímacích bufferech mezi zařízeními. Vysílací zařízení nesmí odeslat paket, pokud přijímající zařízení nemá dostatek místa, nebo neví kolik volného místa má. Informace se předávají pomocí paketu DLLP v datové vrstvě, plně automaticky bez účasti SW nebo jádra PCI.

\paragraph{LDDP (Data Link Layer Packet)} používaný pro potvrzení ACK/NACK, Flow Control a Power Management (uvádí linku do různých režimů spotřeby). Pakety platí pouze v rámci linky, generovány automaticky bez účasti SW nebo jádra PCI.

\subsection{Konfigurace PCI zařízení}
\paragraph{Struktura paměťového prostoru}: 3 typy paměti: Paměť (prefetchable -- lze přednačítat do cache, non-prefetchable), IO prostor, Konfigurační prostor (struktury o velikosti 256 B -- typ 0 pro koncové uzly, typ 1 -- pro switch nebo bridge). Kompatibilní s PCI, PCI-X, ale rozšiřuje strukturu až na 4 kB.
\begin{itemize}
	\item Konfigurace typu 0 (Endpoint): \emph{Vendor ID} (přiřazeno výrobci), \emph{Device ID} (určuje výrobce), \emph{Revision ID}, \emph{Class Code} (obecný typ zařízení -- multimediální, wifi, síťové), \emph{Subsystem Vendor ID}, \emph{Subsystem ID} (podsystémy v rámci zařízení), \emph{Base Address (BAR)} -- až 6 bloků paměti (3 pro 64bitový prostor), alokace paměťového prostoru pro PCI zařízeni.
	\item Konfigurace typu 1 (Switch/Bridge): Struktura pro každý port switche. Opět 2 položky \emph{Base address (BAR)}, \emph{Prefetchable Memory Base/Limit} -- bázová adresa a velikost cachovatelné paměti pro všechna zařízení připojená k danému portu, \emph{Non-Prefetchable Memory Base/Limit} -- pro ne-cachovatelnou paměť, \emph{I/O Base/Limit} -- pro IO prostor (horních 16 bitů)\\
	\emph{Primary Bus} -- číslo usptream sběrnice (k Root), \emph{Secondary Bus} -- číslo downstream sběrnice (ke koncovým zařízením), \emph{Subordinate Bus} -- nejvyšší číslo směrnice na sekundární sběrnici.
\end{itemize}
Pří příchodu paketu do zařízení/směrovače je jednoduché ověřit, zda adresa a cílové zařízení je v rozsahu Base a Limit registrů.

\emph{Proces enumerace PCI zařízení} -- na začátku není známá topologie. Objevování probíhá v těchto krocích:
\begin{enumerate}
	\item Systémový software se pokusí přečíst Vendor ID ze všech 32 možných zařízení na sběrnici O (Config Read operace)
	\item Pokud se odpověď nevrátí, zařízení neexistuje. Jinak provede zápis Primary, Secondary a Subordinate Bus.
	\item SW u všech připojených zařízení přečte jejich typ (0 = endpoint, 1 = switch)
	\item Pokud se jedná o switch, byla nalezena nová sběrnice, Bus 1 a SW aktualizuje položky Primary, SEconday a Subordinary Bus Number u existujícíh zařízení.
	\item Postup se opakuje rekurzivně, doku nejsou objeveny všechna Endpoint zařízení
\end{enumerate}

\subsection{Způsoby směrování}
tři způsoby směrování
\begin{itemize}
	\item Směrování na základě adresy -- zadána adresa do paměti\\
	Adresa v hlavičce je 32 nebo 64 bitů (paměť, IO prostor, konfigurační paměť.
	\begin{itemize}
		\item Koncové zařízení: zkontroluje adresu se všemi svými BAR adresami a velikostmi bloků. Pokud adresa vyhovuje, je paket přijat a zpracován. Jinak je odstraněn.
		\item Přepínač: Nejdříve zkontroluje, jestli je adresa určena pro něj (obě bázové adresy) a paket zpracuje.\\
		Jinak porovná prefetch/non-prefetch/IO paměti na svých sekundárních a přesměruje paket na příslušný port.\\
		Pokud paket přichází z primárního portu a nespadá do žádného z paměťových prostorů na sekundárních portech, je obsloužen jako nepodporovaný požadavek.\\
		Pokud přichází se sekundárního rozhraní a adresa nespadá do žádného z ostatních sekundáních portů, potom je směrován na primární port.
	\end{itemize}
	\item Směrování na základě identifikace -- zadána identifikace Bus ID, Device ID, Function ID\\
	\begin{itemize}
		\item Koncové zařízení: zkontroluje zda identifikace paketu odpovídá jeho číslo. Pokud ano, paket zpracuje, jinak paket odstraní
		\item Přepínač: Nejdříve zkontroluje, jestli je paket určen pro něj (porovná se svým ID a pokud souhlasí, zpracuje paket.\\
		Zkontroluje, jestli ID spadá do rozsahu některého z jeho sekundárních portů (Secundary Bus ID, Subordinary Bus ID) a přepošle paket na příslušný port.\\
		Pokud přichází z primárního portu a nevyhovuje žádnému ID, obsloužen jako neplatný požadavek\\
		Pokud přichází ze sekundárního portu a neodpovídá žádnému z rozsahů pro ostatní sekundání portu, je odeslán na primární port.
	\end{itemize}
	\item Implicitní směrování -- speciální značka -- pro Root Complex, sousední zařízení, nebo broadcast. Pouze pro zprávy.
	Místo adresy nebo ID značka určující Root, zařízení připojené na druhé straně linky, nebo všesměrovou zprávu broadcast. Zařízení nemusí znát přesnou topologii systému a přesné ID zařízení, se kterým komunikuje.\\
	\begin{itemize}
		\item Koncové zařízení: může zpracovat pouze zprávy broadcast, nebo zprávy cílené pro přijímací uzel.
		\item Přepínač: Zpracovává broadcast zprávy z primárního portu a forwarduje je na všechny sekundární porty. Nezpracovává broadcast zprávy ze sekundárních portů. Se zprávami pro root to probíhá opačně.
	\end{itemize}
\end{itemize}

Směrování na základě adresy a identifikace je kompatibilní s PCI, PCI-X. Implicitní vzniklo pro účely zpráv. Memory/IO -- Adresa, Configuration/Completion -- Identifikace, Message -- všechny tři možnosti. Každý paket obsahuje položky \emph{Type} a \emph{Format}, které určují typ transakce a formát hlavičky s ohledem na typ směrování.

Současná verze 3.O používá scrambling a kódování 128/130 -- dvojnásobná propustnost oproti v2.0 i když propustnost linky není dvojnásobná. Efektivita přenosu výrazně lepší (20\%).

Sériová, snadná škálovatelnost, místo hromady vodičů pakety (nové funkce). PCIe před v3.0 mělo velkou režii přenosu. Nevýhodou je latence (cache paměti)

\section{USB}
Dříve hromada různých konektorů a kabelů, bez podporu hot-attachment, vysoká cena.

USB standard: Jediný typ konektoru pro libovolné periferie, více periferií k jednomu konektoru, automatická detekce a konfigurace periferního zařízení.

\paragraph{Komunikace s periferií}
Nevyužívá IO prostor, IRQ, DMA kanály.

každé zařízení má unikátní adresu v rámci USB systému -- až 127 různých adres. Zařízení obsahuje registry a porty, ke kterým je možné přistupovat. Registry a porty se značí jako endpoints. \emph{Endpoint Zero} je obsažen v každém periferním zařízení. Komunikace -- transakce do všech zařízení (kromě low-speed), paketová komunikace.

Low-speed -- 1.5 Mb/s (USB 1.x)\\
High-speed -- 12 Mb/s (USB 1.x)\\
High-speed -- 480 MB/s (USB 2.0)

USB Host Controller (UHC) řídí přenosy ze strany hostitelského počítače. Více USB portů. Součástí IO Controller Hub, nebo připojený na PCI sběrnici.

Hvězdicovité uspořádání, přípojným místem USB hub, transakce se šíří od Host Controlleru všem zařízením (kromě LS), odpoví pouze to, které je adresováno. Transakce jsou uloženy v paměti v podobě deskriptorů (adresa USB zařízení, typ trasakce (R/W), velikost přenosu, rychlost přenosu, umístění datového bufferu v paměti.

Přenosové deskriptory jsou nahrávány a vykonávány v intervalech zvaných Frame (USB1: 1ms, USB2: 125us). Transakce popsány pomocí Transfer Deskriptorů -- nové transakce plánovány do dalších frame. Přenosové pásmo sběrnice je rozděleno mezi jednotlivá zařízení.

Základní typy transakcí:
\begin{itemize}
	\item Isochnonous: synchronní spojení, pro real-time aplikace (audio, modem)
	\item Interrupt: Zjištění, zda má zařízení k dispozici data (polling ze strany UHC). Plánováno periodicky podle požadavků zařízení.
	\item Control: Konfigurace a řízení zařízení. Každé zařízení má konfigurační bod (endpoint zero)
	\item Bulk: Nevyžadují minimální přenosovou rychlost (tiskárna, scanner)
\end{itemize}
Periodické transakce (isochronous, interrupt) mohou zabírat maximálně 90\% celkové propustnosti, řídící maximálně 10\%, bulk je alokován až pro nevyužité pásmo.

Napájení může být buď ze sběrnice, nebo vlastní (max 5V a 500mA, garance 4.4 V a 100mA). Během počáteční konfigurace musí zařízení odebírat méně než 100 mA. Pokud potřebujeme více, specifikováno v konfiguračních deskriptorech. Toto zařízení musí být vypínatelné (řízené SW pomocí řídicích paketů).

Sběrnice je uspána ze strany UHC, pokud je nečinná (IDLE) déle než 3ms, probuzení může přijít i ze strany zařízení.
\subsection{Komunikace a význam signálů}
Diferenciální datové vodiče -- redukce šumu přijímajícího a vysílajícího zesilovače, half-duplex komunikace.

Detekce připojení nového zařízení: Přivedení napájení na daný port (spouštěno periodicky ze strany SW). Zařízení nastaví napětí na D+, aplikace Reset zařízení a detekce USB 2.0 zařízení.

FS a LS zařízení rozlišeno zakončovacím odporem připojenými na D+ (FS) a D- (LS) (opačná polarita D+ a D-), HS nejdříve detekováno jako FS, ve stavu RESET detekce HS zařízení. Informace o zařízení uložena ve stavovém registru rozbočovače.

Kódování přenášených dat: NRZI (nulový bit neguje předchozí hodnotu). Hodinový signál odvozen z datových vodičů. Bit stuffing -- po šesti jedničkách za sebou je vždy vložena nula. Synchronizace pomocí SOP (Start-of-Packet) sekvence 0000 0001. Konec paketu pomocí SO0 (single-ended-zero).

\subsection{Model komunikace}
\begin{itemize}
	\item Isochnonous: Aplikace běžící v reálném čase vyžadující určitou propustnost. Na základě konfigurace garantována určitá propustnost. Není prováděna detekce ani zotavování z chyb, nejsou podporovány u LS zařízení.\\
	Je možné zajistit synchronní přenos mezi dvojicí zařízení (musí řídit SW aplikace (CD -- Speaker)
	\item Interrupt: Přenosy plánovány periodicky každý k-tý rámec (rychlé mohou být každý, pomalé min. každý 255). Podle konfigurace garantována určit šířka přenosového pásma. Podpora pro detekci a zotavení z chyb (porušený paket odvysílán v bezprostředně následujícím Frame). (Myš, klávesnice)
	\item Bulk: Nepotřebují garantovat rychlost, ale bezchybné doručení dat. Obsazují nevyužité pásmo. Použity všechny prostředky pro detekci a zotavení z chyb.
	\item Control: Garance 10\% přenosového pásma pro konfiguraci zařízení a rozbočovačů. Použity pro detekci a zotavení z chyb.
\end{itemize}
Při LS přenosech je potřeba hub předem upozornit, aby přeposlal transakci také na porty s LS zařízeními. Komunikace mezi HS a FS/LS je realizována pomocí rozdělených transakcí.

\subsection{Struktura transakcí a formát paketů}
Každá transakce se skládá z více paketů
\begin{itemize}
	\item Token Packet -- začátek přenosu. Typ přenosu (IN, OUT, SETUP, SOF), adresa cílového zařízení a číslo koncového body a směr přenosu
	\item Data Packet -- přenos dat. Max. délka dána typem transakce.
	\item Handshake Packet -- zjištění stavu dokončení transakce (ACK, NACK, STALL). Zaslán zpět do zařízení vysílající data.
\end{itemize}

Formát paketu:
\begin{itemize}
	\item Synchronizační sekvence -- (0000 0001) 8 bitů pro odvození hodin
	\item Packet Identifier (PID) -- 8bitů pro rozlišení typu paketu -- 4 bity typ, další 4 zabezpečení
	\item Cyclic Redundancy Checking (CRC) -- zabezpečení dat. Datové 16bit CRC, ostatní 5bit CRC
	\item End Of Packet (EOP) -- detekce konce paketu -- sběrnice ve stavu SE0 po dobu alespoň dva bity.
\end{itemize}

\subsection{Detekce chyb a zotavení}
Detekce na základě chybné hodnoty Paket ID, špatné CRC zabezpečující datovou část, nebo pokud v přijatém paketu nejsou vloženy nulové bity (Stuff bity).

Pokud je detekována chyba, je ignorován. Pokud vysílající zařízení neobdrží potvrzení (Bus Timeout), je rozpoznána chyba.

Pokud selže ukončení transakce, zařízení stále vysílá není odvysílán EOP, Hub problematické zařízení odpojí.

\subsection{SW model komunikace}
\begin{itemize}
	\item USB Iterface Layer -- nejnižší vrstva -- USB Host controller, rozbočovače a rozhraní na USB
	\item USB Device Layer -- Rozhraní a služby pro uživatelský software, alokuje potřebnou šířku pásma pro zařízení a zároveň ovládá UHC.
	\item Function Layer -- Vazba mezi uživatelským programem a logickou funkcí zařízení. Pro ovládání zařízení využívá rozhraní, které poskytuje ovladač daného USB zařízení.
\end{itemize}

Komunikační model: komunikační kanály --  pipes. Streaming pipes: USB nespecifikuje formát přenášených dat (Isochronous, Interrupt, Bulk), Jednostranné; Message pipes: Struktura definovaná USB standardem, hlavně řídicí přenosy, oboustranné.

\section{USB 3.0}
Zpětná kompatibilita, zachovat současné výhody USB (hoplug, easy-to-use), zvýšit přenosové pásmo (externí disky, HDTV kamery), zlepšit řízení napájení a redukovat spotřebu sběrnice).

Pro každý směr vyhrazen samostatný diferenciální pár (2 nové jednosměrné páry), stínění. Dual-bus architektura -- práce souběžně s USB 2.0. SuperSpeed rozbočovače pracují na principu store-and-forward. Asynchronní notifikace.

Směrování paketů -- transakce nejsou šířeny do všech zařízení na sběrnici, mohou probíhat současně vstupní a výstupní transakce. Interrupt transakce vysílány přímo ze zařízení (odstranění pollingu), rozdělené Bulk transakce. Možnost více různých streamů v rámci jedné fronty.

Použití kování 8/10 jako v PCIe a síťových rozhraní Ethernet, hodinový signál odvozen od datových vodičů, pakety zabezpečeny pomocí CRC-16, položka RouteString zajišťuje směrování v rozbočovačích.

Úsporný režim pro funkce, nebo celého zařízení. Hostitelský počítač zasílá zprávy o plánovaných přenosech, pokud nejsou, možnost přepnout do stavu s redukovaným napájením.

\emph{Rozbočovače} umožňují propagovat stav sběrnice, směrovat podle RouteString, programovatelný časovač pro detekci neaktivního stavu na downstream portech.

Propustnost až 5Gb/s

\end{document}

